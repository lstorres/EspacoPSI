wac_4Q.prototype.eJa=wac_b(457,function(){if(!this.Af){var a=this;wac_0Q(this.qo).CWo(function(){wac_0Q(a.qo).Nb().eJa()},11)}});wac_lL.prototype.JG=wac_b(337,function(){return this.$L});wac_2F.prototype.z8b=wac_b(223,function(){});wac_WQ.prototype.z8b=wac_b(222,function(a){this.ua.fd("OR",a)});wac_2F.prototype.j6b=wac_b(221,function(){});wac_WQ.prototype.j6b=wac_b(220,function(a){this.ua.fb("OR",a)});wac_Ry.prototype.WHb=wac_b(195,function(){return!1});
wac_QR.prototype.WHb=wac_b(194,function(a,b,c){var d;return d=wac_8tb(a,c,{val:void 0}),d});wac_Zy.prototype.DMb=wac_b(189,function(){});
wac_uR.prototype.DMb=wac_b(188,function(a){var b=wac_D(this.xa,"PresenceRenderIpSlowDurationMilliseconds",3E3);if(!this.a5b.gb(a)){this.a5b.W(a,!1);var c=this;this.$a.xc(new wac_th(3,1,b,function(){var d,e;e=c.a5b.mc(a,d={val:d});d=d.val;e;d||(wac_Ai().recordQosError("PresenceRenderFailed",["PresenceExperienceDegraded"],!0,!0,!0,!1,null),wac_(51683551,302,15,"Presence didn't render for the selected person from people well. Veto Set At:{0}",b));c.a5b.xb(a)},0,null,!1))}});
function wac_JAb(a,b,c){if(!b)return null;if(!a.e2)return wac_(50870151,304,10,"Tried to acquire a lock for wet change before the coauthManager is ready. This will fail."),null;var d=b.oa(Number,wac_8r,0),e=null;b=b.oa(Number,wac_cv,0);var f=a.yBa.gb(d)?a.yBa.B(d):0;b&&(e=wac_UA(a,b));!e&&f&&(e=wac_UA(a,f));if(e)return a.yBa.W(d,e.LockId),e;e=new wac_2La;e.LockId=wac_gvb(a);e.ParagraphIds=[d];e.Type=4;if(!c)return wac_(17866973,304,10,"An attempt to acquire a Lock was made  with an empty clientId. The lockOwner cannot be empty."),
null;f=wac_5p(a.e2.UA,c);f||(f=new wac_fc,f.Id=c,f.Name=CommonUIStrings.l_AnonymousUserName,a.zJa.gb(c)||a.zJa.U(c,new (wac_h.$$(Number))(null)),a.zJa.B(c).U(e.LockId));if(!f)return wac_(7440404,304,10,"Unable to get a wetchange lock on node {0} as client {1} is not in editorstable",b,c),null;e.LockOwner=f;wac_hvb(a,e,e.LockId);a.yBa.W(d,e.LockId);return e}
function wac_KAb(a,b){if(wac_jR.isInstanceOfType(b)){var c=b.Ha(Number,wac_8r);if(a.yBa.gb(c)){var d=a.yBa.B(c);if(d){var e=wac_UA(a,d);e&&4!==e.Type||(delete a.hX[d.toString()],a.yBa.xb(c),b.la(wac_cv,0),a.ua.Xa("WLR",new wac_dvb(d),a))}}}else wac_(18227549,304,10,"An attempt to remove a Wet Change lock on a node that is not a paragraph node was made.")}function wac_LAb(a){return a.cI?a.h0a:a.oa(Number,wac_tt,0)}
function wac_MAb(a,b,c,d,e){var f=wac_6Xa(a,b,c,0);if(f&&d){var g=b.aa;d=wac_yE(g.ra,b.ta);d||(wac__G(a,wac_eB(g,b.ta+1)),wac__G(a,wac_eB(g,b.ta)),d=wac_yE(g.ra,b.ta));d.eb||wac_VG(d,new wac_2G(d,wac_x(),null));1===c.length?((c=wac_yE(g.ra,b.ta+1))?c.eb||wac_VG(c,new wac_2G(c,wac_x(),null)):wac__G(a,wac_eB(g,b.ta+1)),c=new wac_VI(d,null,22,"",!1),wac_1G(d,c)):2===c.length&&""!==e&&a.Y9a.x1(d.eb,e)}f&&wac_7Xa(a,b.aa,!1)}
function wac_kT(a){if(!a.mi.ja()){a.gLd||(wac_fa(42316242,302,50,"No users available at PeopleInfoProvider.GetAllUsers call"),a.gLd=!0);if(a.Wk){var b=a.Wk.zja();wac_uya(a,b)}if(a.vY)for(var b=wac_4p(a.vY),c=b.length,d=0;d<c;++d){var e=b[d];e.Id&&(e=wac_vya(a,e.Id),wac_wya(a,new wac_3p(0),e))}}b=[];for(a=a.mi.GetEnumerator();a.$$mn();)c=a.$$cu(),Array.add(b,c.pa());return b}function wac_NAb(a,b){var c;a=a.mi.mc(b,c={val:c});c=c.val;a;return c}var wac_OAb=null,wac_PAb=null,wac_QAb=null,wac_RAb=null;
function wac_SAb(a){var b,c,d;a=(d=wac_FAb(a,c={val:b}),b=c.val,d);if(!a)return!1;switch(b){case 0:case 1:return"number"!==typeof a.CP||null!=a.FB&&"number"!==typeof a.FB||null!=a.FE&&"number"!==typeof a.FE||null!=a.HB&&"number"!==typeof a.HB||null!=a.HE&&"number"!==typeof a.HE||null!=a.CB&&"number"!==typeof a.CB||null!=a.CE&&"number"!==typeof a.CE||null!=a.R&&"number"!==typeof a.R||null!=a.E&&"number"!==typeof a.E||null!=a.TW&&"number"!==typeof a.TW||null!=a.PB&&"number"!==typeof a.PB||null!=a.SYM&&
"number"!==typeof a.SYM||null!=a.IE&&"number"!==typeof a.IE||null!=a.OO&&"number"!==typeof a.OO||null!=a.AX&&"number"!==typeof a.AX||null!=a.CCI&&"number"!==typeof a.CCI||null!=a.DD&&"number"!==typeof a.DD?!1:!0;default:return!1}}
function wac_TAb(a){if("number"!==typeof a.RK||"number"!==typeof a.DK)return!1;var b,c=!1,d=!1,e=!1;switch(a.RK){case 0:d=b=!0;break;case 1:e=c=d=b=!0;break;case 2:if(null!=a.PE&&"number"!==typeof a.PE)return!1;b=!0;break;case 4:b=!0;break;case 3:d=b=!0;break;case 5:c=b=!0;break;default:return!1}return b&&("number"!==typeof a.PS||"number"!==typeof a.TS)||d&&("object"!==typeof a.OS||!a.OS||!wac_SAb(a.OS))||c&&("number"!==typeof a.PE||"number"!==typeof a.TE)||e&&("object"!==typeof a.OE||!a.OE||!wac_SAb(a.OE))?
!1:!0}function wac_UAb(a){return wac_LAb(a)}function wac_VAb(a){return a&&a.style?wac_dm(a,"transform")?a.style.transform:wac_dm(a,"msTransform")?a.style.msTransform:wac_dm(a,"MozTransform")?a.style.MozTransform:wac_dm(a,"webkitTransform")?a.style.webkitTransform:null:null}
function wac_WAb(a){for(var b=new (wac_e.$$(Number)),c=a.$$lge();c.$$mn();)if(a=c.$$cu())a=window.parseFloat(a),!window.isNaN(a)&&window.isFinite(a)&&b.U(a);c={};c.C=b.ja();if(0<b.ja()){for(var d=0,e=b.$$lge();e.$$mn();)a=e.$$cu(),d+=a;d/=b.ja();c.M=d.toFixed(2);for(var e=0,f=b.$$lge();f.$$mn();)a=f.$$cu(),e+=(a-d)*(a-d);e/=b.ja();b=Math.sqrt(e);c.SD=b.toFixed(2)}return wac_Ti(c)}
function wac_XAb(a){var b=0;for(a=a.$$lge();a.$$mn();){var c=a.$$cu();c&&(c=window.parseInt(c),!window.isNaN(c)&&window.isFinite(c)&&(b+=c))}return wac_Ti(b)}Type.registerNamespace("Common.App.CoauthTelemetry");wac_g=window.Common||{};wac_g.wa=wac_g.wa||{};wac_g.wa.Dcb=wac_g.wa.Dcb||{};function wac_YAb(a){this.D0d=Function.createDelegate(this,this.NAe);this.gha=Function.createDelegate(this,this.Jva);this.uUb={};this.u1b={};this.JNa=a}
wac_YAb.prototype={ND:null,JNa:null,lqb:null,IKb:function(a){var b=new (wac_$a.$$(Number)),c=this;this.kb().CW(function(){a in c.uUb?wac_ab(b,c.uUb[a]):c.u1b[a]=b});return b.yc},kb:function(){if(this.lqb)return this.lqb.yc;this.lqb=new (wac_$a.$$(Object));var a=this;this.JNa.CW(function(){a.ND=a.JNa.Nb();a.ND.ua.fb("UU",a.gha);wac_ZAb(a);a.lqb.Me(null)});return this.lqb.yc},Jva:function(){wac_ZAb(this)},NAe:function(a,b){return a.x5>b.x5?1:a.x5<b.x5?-1:0}};
function wac_ZAb(a){var b=wac_kT(a.ND);b.sort(a.D0d);a.uUb={};for(var c=0;c<b.length&&b[c]&&b[c].x5;c++){var d=a,e=b[c].Lf(),f=c;a.uUb[e]=f;e in d.u1b&&(wac_ab(d.u1b[e],f),delete d.u1b[e])}}
function wac__Ab(a,b,c,d,e,f,g,h,k){this.p$b=Function.createDelegate(this,this.rsc);this.o5c=Function.createDelegate(this,this.r_e);this.rB=a;this.y5a=new (wac_$a.$$(wac_g.zIb));this.xa=c;this.xUb=b;this.kw=d;this.Lh=e;this.v1b=f;this.JNa=g;this.Kvd=h;this.NIc=this.MIc=!1;this.vxb=0;this.ADc=1;this.vda=k;this.t6a=wac_s(this.xa,"PeoplesWellExtraButtonInfoIsEnabled")}
wac__Ab.prototype={rB:null,y5a:null,xUb:null,xa:null,kw:null,Lh:null,v1b:null,JNa:null,Kvd:null,t6a:!1,ND:null,Nxd:null,rNd:null,ADc:0,NIc:!1,MIc:!1,vxb:0,vda:null,kb:function(){var a=this;wac_Wa.WAA.call(null,this.JNa,this.xUb,this.v1b).CW(function(){a.ND=a.JNa.Nb();a.Nxd=a.xUb.Nb();a.rNd=a.v1b.Nb();wac_Wa.WAA.call(null,a.xUb.Nb().OOa.yc,a.v1b.Nb().J4b.yc).CW(function(){a.ADc=a.Nxd.OOa.yc.Nb();a.vxb=a.rNd.J4b.yc.Nb();a.ND.ua.fb("UU",a.o5c);wac_kT(a.ND).length&&a.Jva()})})},r_e:function(){this.Jva()},
Jva:function(){this.Kvd(wac_kT(this.ND))?(this.ND.ua.fd("UU",this.o5c),wac_0Ab(this,this.MIc)):wac_ab(this.y5a,1);this.MIc=!0},rsc:function(){var a=wac_zl(this.Lh,"AppInitStatus_"+wac_g.wa.Hta.toString(4));wac_c(42259235,325,!!this.vxb,null);var b=this.vxb-a,c={};c.InteractiveTime=a;c.ReactRenderComplete=this.vxb;c.HadTabSwitch=this.vda();c.IsModernGallery=this.t6a;wac_(594883104,325,50,wac_rn(c));this.t6a?(wac_(42062997,325,15,b.toString()),a=this.y5a,c=wac_D(this.xa,"CoauthorGalleryTimeToRenderDurationMs",
1E4),c=b>c,this.vda()?(wac_(50455714,325,50,c.toString()),b=!1):(c&&(wac_(42062998,325,15,b.toString()),wac_Ai().recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null)),b=c),wac_ab(a,b?3:2)):wac_(594883103,325,15,b.toString())}};function wac_1Ab(a,b){b?a.kw.hn(4,a.p$b,3):wac_ab(a.y5a,1)}
function wac_0Ab(a,b){a.NIc?a.y5a.yc.CW(function(){wac_(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",wac_g.zIb.toString(a.y5a.yc.Nb()))}):(a.NIc=!0,wac_1Ab(a,!a.ADc&&!b))}function wac_2Ab(a,b){this.gha=Function.createDelegate(this,this.Jva);this.iQc=a;this.BNd=b}function wac_3Ab(a){for(var b,c=null,d=a.length,e=0;e<d;++e)if(b=a[e])if(b=b.Nq||!b.sn?b.Lf():b.sn.toUpperCase(),!c)c=b;else if(c!==b)return!0;return!1}
wac_2Ab.prototype={xZ:null,BNd:null,iQc:null,kb:function(){var a=this;this.iQc.CW(function(){a.xZ=a.iQc.Nb();a.xZ.ua.fb("UU",a.gha)})},Jva:function(){wac_3Ab(wac_kT(this.xZ))&&(this.xZ.ua.fd("UU",this.gha),this.BNd.IsRealCoauthSession=!0)},Ojf:function(){return this.xZ?wac_3Ab(wac_kT(this.xZ)):!1}};function wac_4Ab(){}
wac_4Ab.prototype={Rb:function(){return"Common.App.CoauthTelemetry"},Sb:function(a){wac_n(wac_o(wac_p(a.ma(wac_2Ab),wac_no)),function(){return new wac_2Ab(wac_Eb(wac_tc,wac_m(a,wac_tc)),wac_q.hm)});wac_n(wac_o(wac_p(a.ma(wac__Ab),wac_bca)),function(){return new wac__Ab(wac_y(),wac_Eb(wac_8b,wac_m(a,wac_8b)),wac_q.Z,window.Common.App.AppLifecycleManager.get_instance(),wac_Ud(),wac_Eb(wac_uc,wac_m(a,wac_uc)),wac_Eb(wac_tc,wac_m(a,wac_tc)),wac_3Ab,function(){return wac_5Ab()})});wac_n(wac_o(wac_p(a.ma(wac_6Ab),
wac_oo)),function(){return new wac_6Ab(wac_Eb(wac_8b,wac_m(a,wac_8b)),window.Common.App.AppLifecycleManager.get_instance(),a.K(wac_mo),wac_Ud(),function(){return wac_5Ab()},wac_q.Z,null,wac_Ai())});wac_n(wac_o(wac_p(a.ma(wac_YAb),wac_mo)),function(){return new wac_YAb(wac_Eb(wac_tc,wac_m(a,wac_tc)))})},kb:function(){wac_ni(wac_q.Z,function(){wac_k().K(wac_2Ab).kb();wac_s(wac_q.Z,"CoauthorGalleryTelemetryIsEnabled")&&wac_k().K(wac_bca).kb();wac_s(wac_q.Z,"CashTelemetryIsEnabled")&&(wac_k().K(wac_oo),
wac_k().K(wac_mo))})},ka:function(){}};function wac_5Ab(){return wac_Wd()&&wac_rpa(wac_Ud(),"UserActions")?0<wac_zl(wac_Ud(),"UserActions").VisiToggled:!1}function wac_6Ab(a,b,c,d,e,f,g,h){this.gOd={};this.B6a=new (wac_d.$$(Number))(function(){return wac_Kh(f,"PresenceBootLatencyThreshold",1E4)});this.O_a=new (wac_d.$$(Number))(function(){return wac_Kh(f,"PresenceBootLatencyCutoffThreshold",6E4)});this.kw=b;this.DNd=c;this.BDc=a;this.Lh=d;this.Qsb=g;this.vda=e;this.Ud=h;this.kb()}
wac_6Ab.prototype={BDc:null,Qsb:null,mqb:null,kw:null,DNd:null,Slb:null,Lh:null,vSd:0,wSd:0,B6a:null,O_a:null,vda:null,Ud:null,Kdb:function(a,b,c,d){c&&(wac_c(42274970,302,!this.Qsb||this.Qsb===c,"_myClientId is already set and you are trying to update it to something different"),this.Qsb=c);var e=new (wac_$a.$$(Boolean)),f=this;this.kb().CW(function(){var c=b?b.getTime():(new Date).getTime();if(a in f.gOd)e.KX();else{var h;new (wac_$a.$$(Number));h=1===f.vSd?wac__a(Number,f.wSd):wac_7Ab(f);c=new wac_8Ab(a,
h,c,f.IKb(f.Qsb||"{"+wac_q.Sf+"}"),f.IKb(a),f.B6a,f.O_a,d,f.vda);f.gOd[a]=c;wac_9Ab(c,e)}});return e.yc},kb:function(){if(this.mqb)return this.mqb.yc;this.mqb=new (wac_$a.$$(Object));this.vda()&&wac_(50951700,302,15,"TabSwitched Session");var a=this;this.BDc.CW(function(){var b=a.BDc.Nb(),c=b.OOa.yc,d=b.xSd.yc;d.CW(function(){c.CW(function(){a.Ud&&a.Ud.addQosPillar(window.Common.QosPillarName.toString(6));a.uyc(c.Nb(),d.Nb());a.mqb.Me(null)})})});return this.mqb.yc},uyc:function(a,b){this.vSd=a;this.wSd=
b?b:(new Date).getTime()},IKb:function(a){return this.DNd.IKb(a)}};function wac_7Ab(a){if(a.Slb)return a.Slb.yc;a.Slb=new (wac_$a.$$(Number));a.kw.hn(4,function(){var b=wac_zl(a.Lh,"AppInitStatus_"+wac_g.wa.Hta.toString(4));wac_ab(a.Slb,b)},3);return a.Slb.yc}function wac_8Ab(a,b,c,d,e,f,g,h,k){this._id=a;this.$Tc=b;this.wr=c;this.c0b=d;this.E4b=e;this.B6a=f;this.O_a=g;this.wmb=h;this.vda=k}wac_8Ab.prototype={Fh:0,$Tc:null,B6a:null,O_a:null,XQd:!1,wr:0,c0b:null,E4b:null,wmb:0,_id:null,vda:null};
function wac_$Ab(a){switch(a){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}
function wac_9Ab(a,b){wac_Wa.WAA(a.$Tc,a.c0b,a.E4b).CW(function(){if(a.c0b.Nb()<=a.E4b.Nb())wac_ab(b,!1);else{a.Fh=a.$Tc.Nb();var c=a.wr-a.Fh,d=new window.Common.App.CoauthTelemetry.PL;d.id=a._id;d.et=a.wr;d.st=a.Fh;d.d=a.wr-a.Fh;d.mp=a.c0b.Nb();d.tp=a.E4b.Nb();d.ct=wac_$Ab(a.wmb);d.vc=a.vda();var e=wac_Ti(d);wac_(42078597,302,15,e);if(c>a.B6a.pa()&&!a.XQd&&!d.vc&&c<a.O_a.pa()){a.XQd=!0;wac_ab(b,!0);var f,d=(f=new wac_Jn,f.extendedProperties=new window.Map,f);d.extendedProperties.set("data",e);wac_Ai().recordQosError("PresenceRenderDurationIsTooLong",
["PresenceExperienceDegraded"],!1,!0,!1,!1,d);wac_(42078598,302,15,"{d:"+c+",vt:"+a.B6a.pa()+",ct:"+a.O_a.pa()+"}")}b.yc.Xo()||wac_ab(b,!1)}})}window.Common.App.CoauthTelemetry.PL=wac_g.wa.Dcb.d0e=function(){};wac_g.wa.Dcb.d0e.prototype={id:null,et:0,st:0,mp:0,tp:0,d:0,ct:null,vc:!1};wac_YAb.registerClass("Common.App.CoauthTelemetry.CoauthorPositionFinder",null,wac_mo);wac__Ab.registerClass("Common.App.CoauthTelemetry.CoauthorGalleryTelemetry",null,wac_bca);
wac_2Ab.registerClass("Common.App.CoauthTelemetry.CoauthTelemetry",null,wac_no);wac_4Ab.registerClass("Common.App.CoauthTelemetry.CoauthTelemetryPackage",null,wac_I,wac_j);wac_6Ab.registerClass("Common.App.CoauthTelemetry.PresenceBootTelemetry",null,wac_oo);wac_8Ab.registerClass("Common.App.CoauthTelemetry.PresenceLatencyActivityLogger");window.Common.App.CoauthTelemetry.PL.registerClass("Common.App.CoauthTelemetry.PL");wac_J(wac_C(),new wac_4Ab,0,!1);Type.registerNamespace("Common.App.CollabControls");
wac_g=window.Common||{};wac_g.wa=wac_g.wa||{};wac_g.wa.aua=wac_g.wa.aua||{};function wac_aBb(){}wac_aBb.registerInterface("Common.App.CollabControls.IPresenceTooltipControl");function wac_bBb(){}wac_bBb.registerInterface("Common.App.CollabControls.IPresenceTooltipFactory");wac_g.wa.aua.NXa=function(){};
wac_g.wa.aua.NXa.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14,useIdleTooltip:15,viewportBoundsCallback:16,flipHorizontalDirection:17,fixRemoveFadeOutElementCrash:18};wac_g.wa.aua.NXa.registerEnum("Common.App.CollabControls.PresenceTooltipSettingKeys",!1);
function wac_lT(a){this.eS=Function.createDelegate(this,this.e$e);this.dispose=this.ka;wac_lT.initializeBase(this);this._element=a}
wac_lT.prototype={_element:null,Mm:function(){return"visible"===this._element.style.visibility},rn:function(a){this._element.style.visibility=a?"visible":"hidden";return a},ka:function(){this._element&&this._element.parentNode&&this._element.parentNode.removeChild(this._element);this._element=null;wac_df.prototype.ka.call(this)},$j:function(a){return this._element.ownerDocument.createElement(a)},e$e:function(){return!0}};function wac_mT(a,b){a._element.style.zIndex=b}
function wac_cBb(a,b){a._element.dir=b?"rtl":"ltr"}function wac_nT(a,b){wac_nT.initializeBase(this);this.fc=a;this.Gcc=b}wac_nT.prototype={fc:0,Gcc:null};
function wac_oT(a,b,c){this.CCa=Function.createDelegate(this,this.qXa);this.sRa=Function.createDelegate(this,this.VVe);this.mi=[];this.dispose=this.ka;wac_oT.initializeBase(this,[a]);this.t1a={};this.Rc=c;this.Mg=c.mk(Boolean,8);this.ZIc=c.mk(Boolean,15);this.maa=c.mk(Number,12);this.qha=c.mk(Number,6);this.q5a=b;this.CWc=c.mk(Function,16);this.$ob=c.mk(Boolean,17);this.Krb=0;this.ENd=new wac_dBb(this.Mg,this.$ob);this.kZa=this.Mg?3:4;this.dAa=!1;this.pJa=[];this.w1a=[];this._element.id=String.format("{0}-{1}",
"presencetooltip",wac_eBb++);this._element.className="prControl"+(this.Mg?"Rtl":"");this.maa&&wac_mT(this,this.maa);wac_cBb(this,this.Mg);this.rxc(b);this.nI=this.$j("div");this.nI.className="prFlyoutContainer";this._element.appendChild(this.nI);this.Su=[];this.Nna=new wac_fBb(this.Su,this._element,this.qha,4,6,32,this.Mg);this.Vi=c.mk(wac_6c,9);this.Vi.Na("msospPointerDown",this.Nna.$c,this.sRa);this.Vi.Na("msospPointerOver",this.Nna.$c,this.sRa);this.Vi.Na("msospPointerOut",this.Nna.$c,this.sRa)}
wac_oT.prototype={Mg:!1,Aya:!1,FEd:!1,Rea:!1,q5a:0,Krb:0,D4a:!1,ZIc:!1,$ob:!1,dAa:!1,t1a:null,nI:null,Nna:null,pJa:null,w1a:null,ENd:null,kZa:0,Vi:null,Rc:null,CWc:null,p7b:function(){return wac_Be(this.mi)},Su:null,maa:0,qha:0,sb:function(){return this._element},ka:function(){if(3!==wac_pT(this)||this.Aya){if(this.Su)for(var a=this.Su,b=a.length,c=0;c<b;++c){var d=a[c];d.x8b(this.CCa);wac_Zb(d)}this.Su=null;this.Vi.yb("msospPointerDown",this.Nna.$c,this.sRa);this.Vi.yb("msospPointerOver",this.Nna.$c,
this.sRa);this.Vi.yb("msospPointerOut",this.Nna.$c,this.sRa);wac_lT.prototype.ka.call(this)}else this.dAa=!0},HIa:function(){wac_qT(this,!1);this.rn(!0)},iRb:function(){this.rn(!0);wac_gBb(this);this.Aya=!0},Xd:function(){wac_hBb(this,5);this.cka();this.Nna.Gt(wac_pT(this),this.D4a)},$S:function(a){var b=wac_pT(this),c=this.Aya;a.lk||(a.lk=(wac_eBb++).toString());var d;if(a.lk in this.t1a&&(d=this.MFa(a.lk),0<=d)){d=this.mi[d];if(d.xs===a.xs&&d.gp===a.gp)return;this.dla(a.lk)}this.Xd();d=new wac_iBb(this.$j("div"),
this.Rc);d.Cyb(this.CCa);this.nI.insertBefore(d._element,this.nI.firstChild);this.t1a[a.lk]=d;Array.add(this.mi,a);Array.add(this.Su,d);wac_jBb(this,b,c);this.rn(!0)},dla:function(a){if(3!==wac_pT(this)||this.Aya){var b=wac_pT(this),c=this.Aya;this.Xd();this.Bib(a);wac_jBb(this,b,c)}else Array.add(this.w1a,a)},Ykc:function(a){a=a.Za.rawEvent.relatedTarget;if(this.nI!==a&&wac_td(this.nI,a))return!0;for(var b=this.Su,c=b.length,d=0;d<c;++d)if(wac_td(b[d]._element,a))return!0;return!1},cka:function(){var a=
0,b=0;this.D4a&&(a=this.kZa,b=-6);for(var c=0;c<this.Su.length;c++)this.Su[c].Xd(this.mi[c],b,a);wac_mT(this,this.maa);this.Aya=!1;this.rn(!1);this.dAa&&this.ka()},qXa:function(a,b){a=wac_pT(this);if(2===b.fc||4===b.fc&&3!==a)this.Rea&&(this.Rea=!1),3!==a&&(wac_gBb(this),3===b.Gcc.Ne&&wac_kBb(this,2E3));else if(4===b.fc&&3===a)this.Rea&&(this.Rea=!1),wac_kBb(this,0);else if(3===b.fc&&3===a&&!this.Aya)if(1<this.Su.length){this.Rea=!0;var c=this;wac_Ya(250).CW(function(){wac_qT(c,!0);c.Rea=!1})}else wac_kBb(this,
0);this.Xa("InteractivityChanged",b,null)},VVe:function(a){3===a.Ne?this.qXa(this,new wac_nT(4,a)):"msospPointerOver"===a.xn?this.qXa(this,new wac_nT(2,a)):"msospPointerOut"===a.xn&&this.qXa(this,new wac_nT(3,a));return!1},rxc:function(a){this._element.style.width=a+"px";this._element.style.height=this.qha+"px"},Bib:function(a){if(-1===this.MFa(a))wac_(41706452,302,50,"Cannot remove active editor because client id is invalid");else if(Array.contains(this.pJa,a)){Array.remove(this.pJa,a);if(this.mi[0].lk===
a&&0<this.pJa.length){var b=this.pJa[this.pJa.length-1];if(b in this.t1a){var c=this.MFa(b);if(c){var d=this.mi[c],b=this.t1a[b];Array.removeAt(this.mi,c);Array.insert(this.mi,0,d);Array.removeAt(this.Su,c);Array.insert(this.Su,0,b);this.nI.removeChild(b._element);this.nI.appendChild(b._element);wac_qT(this,!1)}}}this.mi[0].lk===a&&1===wac_pT(this)&&wac_qT(this,!1)}a=this.MFa(a);0>a||(c=this.mi[a],Array.removeAt(this.mi,a),delete this.t1a[c.lk],c=this.Su[a],this.nI.removeChild(c._element),this.Rc.mk(Boolean,
18)&&c.x8b(this.CCa),Array.removeAt(this.Su,a),c.ka())},MFa:function(a){for(var b=0;b<this.mi.length;b++)if(this.mi[b].lk===a)return b;return-1},Gwc:function(a){for(var b=0;b<this.Su.length;b++)this.Su[b].Gwc(a)}};function wac_lBb(a,b){b?Sys.UI.DomElement.addCssClass(a.nI,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(a.nI,"prBackgroundSelection")}
function wac_hBb(a,b){if(a.w1a.length){a.Mm()&&a.cka();for(var c=0;c<a.w1a.length;c++)a.Bib(a.w1a[c]);Array.clear(a.w1a);0>=a.mi.length||5===b?a.Xd():b||a.HIa()}}function wac_kBb(a,b){b?(a.Rea=!0,wac_Ya(b).CW(function(){a.ZIc?a.Rea&&a.Xd():wac_qT(a,!0);a.Rea=!1})):a.ZIc?a.Xd():wac_qT(a,!1)}
function wac_gBb(a){a.FEd&&wac_lBb(a,!1);wac_mT(a,a.maa+1);var b,c,d,e=c={val:c},f=b={val:b},g=d={val:d};e.val=0;f.val=0;g.val=a.kZa;if(a.CWc){var h=a.CWc(a);if(h){var k=4===wac_pT(a),l;l=a.ENd;var m=a.Su.length,n=k?6:a.qha,p=a.qha,q=a._element,r=h.y,t=h.height,u=wac_0k(q).y,v=u+n,w=m*p+2*(m-1),p=null;1===m||u+w<=r+t?m=new wac_rT(0,0,2,4):(m=l.ylc(v,w,r,t),m.iXa-=u);l.$ob?p=new wac_rT(0,0,2,l.Mg?4:3):(l.Mg?(u=h.width,q=wac_0k(q),q=u-(q.x+q.width)):q=wac_0k(q).x,u=Math.max(0,h.x),h=h.width,n=q+n,q+
150<=u+h?p=new wac_rT(0,0,2,l.Mg?3:4):150<=n-u&&(p=new wac_rT(0,0,2,l.Mg?4:3)),p||(h-n>=q-u?l=4:(n=q,l=3),p=new wac_rT(0,n,2,l)));l=new wac_rT(m.iXa,p.Xmd,m.iAc,p.Qnc);f.val=l.iXa;1===l.iAc?f=a.Su.length-1:(f=Math.abs(l.iXa),f=0<f?f/(a.qha+2):0);a.Krb=f;g.val=l.Qnc;g.val!==a.kZa&&(a.Gwc(g.val),a._element.dir=3===g.val?"rtl":"ltr",a.kZa=g.val);g.val!==(a.Mg?3:4)?(e.val=k?-6:-a.qha,a.D4a=!0):a.D4a=!1}}c=c.val;b=b.val;d=d.val;for(e=0;e<a.Su.length;e++)a.Su[e].Ch(a.mi[e],c,b+(a.qha+2)*e+20,3,e!==a.Krb,
d)}function wac_qT(a,b){if(!b||a.Rea){a.FEd&&wac_lBb(a,!0);var c=Math.min(3,a.Su.length)-1;b=0;var d=1,e=0;a.D4a&&(b=a.kZa,d=-1,e=-a.qha);for(var f=a.Su.length-1;f>c;f--)a.Su[f].Ch(a.mi[f],-4*c*d+e,20,2,!0,b);for(f=c;0<=f;f--)c=Array.contains(a.pJa,a.mi[f].lk),a.Su[f].Ch(a.mi[f],-4*f*d+e,20,0<f?2:c?1:0,f!==a.Krb,b);a.Krb=0;a.Nna.Gt(0,a.D4a);wac_mT(a,a.maa);a.Aya=!1;wac_hBb(a,0);a.dAa&&a.ka()}}function wac_jBb(a,b,c){0>=a.mi.length?a.Xd():3===b&&c?a.iRb():a.HIa()}
function wac_pT(a){return a.Su&&0<a.Su.length?a.Su[0].Zj:5}function wac_mBb(a){var b=wac_nBb/a,c=2*b,d=wac_oBb/2;a=(a-12-8)*b/2;var e=document.createElementNS(wac_pBb,"g");e.setAttribute("class",wac_qBb);for(var f=1;3>=f;f++)e.appendChild(wac_rBb(f,c,a+(6*f-2)*b,d));return e}
function wac_rBb(a,b,c,d){var e=document.createElementNS(wac_pBb,"circle");e.setAttribute("class",String.format("{0}-{1}",wac_sBb,a));e.setAttribute("cx",String.format("{0}",c));e.setAttribute("cy",String.format("{0}",d));e.setAttribute("r",String.format("{0}",b));return e}function wac_tBb(a){this.Rc=a;wac_sT(this.Rc,10,wac_Fg());wac_sT(this.Rc,9,wac_Hg());wac_sT(this.Rc,6,20);wac_sT(this.Rc,13,wac_Sg());wac_sT(this.Rc,17,!1)}
wac_tBb.prototype={Rc:null,ejc:function(a,b){wac_sT(this.Rc,15,b);return new wac_oT(a,20,this.Rc)}};
function wac_iBb(a,b){this.eaa=Function.createDelegate(this,this.EHa);this.PG=Function.createDelegate(this,this.w7);this.OG=Function.createDelegate(this,this.IJ);this.vk=Function.createDelegate(this,this.Np);wac_iBb.initializeBase(this,[a]);this.HZ=b.mk(Boolean,8);this.bea=b.mk(Number,6);this.UUd=b.mk(Boolean,15);this.Rc=b;this.RGc=0;this._element=a;this._element.className=wac_uBb;this.WK=document.createElement("span");this._element.appendChild(this.WK);a=b.mk(Number,6);var c=document.createElementNS(wac_pBb,
"svg");c.setAttribute("viewBox",String.format(wac_vBb,wac_nBb,wac_oBb));c.appendChild(wac_mBb(a));this.zAd=c;this.rF(b);this.Zj=5}
wac_iBb.prototype={Jc:null,Vi:null,Yw:null,Rc:null,WK:null,Xna:null,zAd:null,bea:0,HZ:!1,UUd:!1,pDc:null,RGc:0,rya:null,Cyb:function(a){this.fb("InteractivityChanged",a)},x8b:function(a){this.fd("InteractivityChanged",a)},Te:null,Zj:0,ka:function(){this._element&&(this.Jc.yb("click",this._element,this.vk),this.Jc.yb("dblclick",this._element,this.eS),this.Vi.yb("msospPointerDown",this._element,this.OG),this.Vi.yb("msospPointerOut",this._element,this.PG),this.Vi.yb("msospPointerOver",this._element,
this.eaa),this.Yw.yb(this._element,this.eS));wac_lT.prototype.ka.call(this)},rF:function(a){this.Jc=a.mk(wac_4c,10);this.Jc.Na("click",this._element,this.vk);this.Jc.Na("dblclick",this._element,this.eS);this.Vi=a.mk(wac_6c,9);this.Vi.Na("msospPointerOver",this._element,this.eaa);this.Vi.Na("msospPointerOut",this._element,this.PG);this.Vi.Na("msospPointerDown",this._element,this.OG);this.Yw=a.mk(wac_qk,13);this.Yw.Na(this._element,this.eS)},Xd:function(a,b,c){this.UUd&&a?this.Ch(a,b,15,4,!1,c):(3===
this.Zj&&wac_wBb(this),this.rn(!1),this.Zj=5)},Ch:function(a,b,c,d,e,f){var g;if((g=a)&&!(g=d!==this.Zj)){g=wac_fm(this._element.style.left);var h=wac_fm(this._element.style.top);g=!(g===b&&h===c)}if(g){if(!wac_xBb(this.Zj)||!wac_xBb(d))switch(Sys.UI.DomElement.removeCssClass(this._element,this.pDc),this.Zj){case 4:3===d?this.Nia(wac_yBb,wac_zBb):wac_xBb(d)&&this.Nia(wac_ABb,wac_zBb);break;case 3:4===d?this.Nia(wac_BBb,wac_CBb):wac_xBb(d)&&(e&&wac_wBb(this),this.Nia(wac_ABb,wac_CBb,e?wac_DBb:""));
break;case 0:case 1:case 2:4===d?this.Nia(wac_BBb,wac_EBb):3===d&&(e&&wac_FBb(this),this.Nia(wac_yBb,wac_EBb,e?wac_GBb:"",3===f?wac_HBb:wac_IBb));break;default:4===d?this.Nia(wac_BBb):3===d?this.Nia(wac_yBb):wac_xBb(d)&&this.Nia(wac_ABb)}this.$S(a,d,f);this.Zj=d;4===f||!f&&!this.HZ?this._element.style.left=b+"px":this._element.style.right=b+"px";this._element.style.top=c+"px";this.rn(!0)}},$S:function(a,b,c){this.Te=a;wac_sd(this.WK);this.WK.removeAttribute("style");this.WK.id="fly_"+a.lk;this.WK.style.backgroundColor=
a.xs;4!==b?(this.WK.style.height=this.bea+"px",this.WK.style.lineHeight=this.bea+"px",wac_cm(this.WK,"border-radius",this.bea+"px")):4===c||!c&&!this.HZ?this.WK.style.left="0px":this.WK.style.right="0px";if(2!==b)if(4===b)wac_ud(this.WK,"");else if(1===b)this.WK.appendChild(this.zAd);else{var d=a.gp;d?(c=d.replace(wac_PAb||(wac_PAb=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g),""),c=c.replace(wac_OAb||(wac_OAb=/\s+/g)," "),d=c.trim(),(wac_QAb||(wac_QAb=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/)).test(d)||
(wac_RAb||(wac_RAb=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i)).test(d)?c="":(c="",d=d.split(" "),2===d.length?(c+=d[0].charAt(0),c+=d[1].charAt(0)):3===d.length?(c+=d[0].charAt(0),c+=d[2].charAt(0)):0<d.length&&(c+=d[0].charAt(0)),c=c.toUpperCase())):c="";!a.Nq&&c||b?(a=a.gp,b||(a=c,wac_cm(this.WK,"text-align","center")),wac_ud(this.WK,a),this.WK.setAttribute("dir","auto")):(this.Xna||(b=document.createElement("img"),b.setAttribute("src",wac_3e("doughperson_white_glyph.svg")),b.setAttribute("Unselectable",
"on"),b.setAttribute("role","presentation"),this.Xna=wac_cka(this.bea,this.bea,null,null,wac_JBb,"",!1,"",this._element.ownerDocument,b)),this.WK.appendChild(this.Xna))}},Np:function(a){if(!this.Zj)return this.Xa("InteractivityChanged",new wac_nT(1,a),null),!0;3===this.Zj&&wac_(50436114,302,50,"User clicked on presence pill.");return!1},w7:function(a){3===this.Zj&&this.Xa("InteractivityChanged",new wac_nT(3,a),null);return!1},EHa:function(a){3!==a.Ne&&this.Xa("InteractivityChanged",new wac_nT(2,a),
null);return!1},IJ:function(a){if(3!==a.Ne)return!0;this.Xa("InteractivityChanged",new wac_nT(4,a),null);return!1},Nia:function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];this.pDc=a.join(" ");Sys.UI.DomElement.addCssClass(this._element,this.pDc)},Gwc:function(a){3===a&&wac_dm(this._element,"left")?(a=wac_fm(this._element.style.left),wac_cm(this._element,"left",""),this._element.style.right=-1*a+"px"):4===a&&wac_dm(this._element,"right")&&(a=wac_fm(this._element.style.right),wac_cm(this._element,
"right",""),this._element.style.left=-1*a+"px")}};function wac_xBb(a){return!a||1===a||2===a}function wac_wBb(a){window.clearTimeout(a.RGc);a.rya&&(Sys.UI.DomElement.removeCssClass(a.rya,wac_EBb+" "+wac_GBb),Sys.UI.DomElement.addCssClass(a.rya,wac_KBb),wac_Ya(300).CW(function(){a._element.parentNode===a.rya.parentNode&&a._element.parentNode.removeChild(a.rya)}),wac_cm(a._element,"z-index",""))}
function wac_FBb(a){a.RGc=window.setTimeout(function(){a._element&&(a.rya=a._element.cloneNode(!0),a._element.parentNode.appendChild(a.rya),a._element.style.zIndex=2,a.rya.style.zIndex=1)},300)}function wac_dBb(a,b){this.Mg=a;this.$ob=b}wac_dBb.prototype={Mg:!1,$ob:!1,ylc:function(a,b,c,d){var e=1,f=Math.max(c,a-b);b>a-c&&(e=2,f=b<d?d-b:c);return new wac_rT(f,0,e,4)}};function wac_rT(a,b,c,d){this.iXa=a;this.Xmd=b;this.iAc=c;this.Qnc=d}wac_rT.prototype={iXa:0,Xmd:0,iAc:0,Qnc:0};
function wac_fBb(a,b,c,d,e,f,g){this.FY=a;this._parent=b;this.CDc=c;this.Qxd=d;this.sEd=e;this.aPa=f;this.HZ=g;this.$c=document.createElement("div");this.$c.className="prTouchTarget"}
wac_fBb.prototype={FY:null,_parent:null,HZ:!1,CDc:0,Qxd:0,sEd:0,aPa:0,$c:null,Gt:function(a,b){if(3!==a)if(5!==a&&this.FY&&this.FY.length){var c,d;if(4===a)c=this.sEd,d=(this.aPa-c)/2,this.$c.style.height=this.aPa+"px",this.$c.style.width=this.aPa+"px",a=wac_fm(this.FY[0]._element.style.top),b=wac_fm(this.HZ?this.FY[0]._element.style.right:this.FY[0]._element.style.left);else{c=this.CDc;d=(this.aPa-c)/2;this.$c.style.height=this.aPa+"px";this.$c.style.width=(this.FY&&this.FY.length?this.CDc+Math.min(this.FY.length-
1,2)*this.Qxd:0)+2*d+"px";a=wac_fm(this.FY[this.FY.length-1]._element.style.top);var e=this.FY[this.FY.length-1]._element,f=c;b=this.HZ&&!b?wac_fm(e.style.right):this.HZ||b?this.HZ&&b?-wac_fm(e.style.left)-f:-wac_fm(e.style.right)-f:wac_fm(e.style.left)}wac_cm(this.$c,"border-radius",this.aPa+"px");this.$c.style.top=a-d-c+"px";this.HZ?this.$c.style.right=b-d+"px":this.$c.style.left=b-d+"px";this.$c.parentNode||this._parent.insertBefore(this.$c,this._parent.firstChild)}else this.$c.parentNode&&this.$c.parentNode.removeChild(this.$c)}};
function wac_LBb(a,b,c){this.CCa=Function.createDelegate(this,this.qXa);this.mi=[];this.$x=[];this.dispose=this.ka;wac_LBb.initializeBase(this,[a]);this.Xpb={};this.Rc=c;this.Mg=c.mk(Boolean,8);this.wN=c.mk(Boolean,11);a=c.mk(Number,12);this.q5=c.mk(Number,6);this.q5a=b;this._element.id=String.format("{0}-{1}","presencetooltip",wac_MBb++);this._element.className="prControl"+(this.Mg?"Rtl":"");a&&wac_mT(this,a);wac_cBb(this,this.Mg);this.rxc(b);this.G2=this.$j("div");this.G2.className=this.wN?"prContainerV":
"prContainerHr";this._element.appendChild(this.G2);this.nJ=Array(this.hfa);for(b=0;b<this.hfa;b++)this.nJ[b]=new wac_NBb(this.$j("div"),this.Rc),this.nJ[b].Cyb(this.CCa),this._element.appendChild(this.nJ[b]._element)}
wac_LBb.prototype={G2:null,hfa:0,Mg:!1,R0a:!1,wN:!1,twb:!1,q5a:0,Rc:null,Xpb:null,p7b:function(){return wac_Be(this.mi)},nJ:null,$ac:null,q5:0,eJ:function(){return this.wN?this.q5+2:this.q5a},sb:function(){return this._element},ka:function(){if(this.nJ)for(var a=this.nJ,b=a.length,c=0;c<b;++c){var d=a[c];d.x8b(this.CCa);wac_Zb(d)}wac_0ba(this.$x);this.$x=this.nJ=null;wac_lT.prototype.ka.call(this)},HIa:function(){this.cka();wac_OBb(this);this.rn(!0);this.R0a=!1},iRb:function(){!this.$x||1>this.$x.length||
(this.cka(),this.rn(!0),wac_OBb(this),wac_PBb(this,this.$x[this.$x.length-1],0),this.R0a=!0)},Xd:function(){this.rn(!1);this.cka();for(var a=0;a<this.$x.length;a++)this.$x[a].Xd();this.R0a=!1},$S:function(a){if(!(0>=this.hfa)){a.lk||(a.lk=(wac_MBb++).toString());if(a.lk in this.Xpb){var b=this.MFa(a.lk);if(0<=b){b=this.mi[b];if(b.xs===a.xs&&b.gp===a.gp)return;this.dla(a.lk)}}var b=wac_QBb(this),c,d=0;this.mi.length<this.hfa?(c=new wac_RBb(this.$j("div"),this.Rc,a),c.Cyb(this.CCa),this.Mg&&!this.wN&&
0<this.mi.length?this.G2.insertBefore(c._element,this.G2.firstChild):(this.G2.appendChild(c._element),d=this.$x.length),Array.add(this.$x,c)):(this.Mg&&!this.wN?c=this.$x[0]:(d=this.$x.length-1,c=this.$x[d]),c.$S(a));c.Ch();this.Xpb[a.lk]=c;Array.add(this.mi,a);this.ada(c,d);b&&wac_SBb(this)}},dla:function(a){var b=wac_QBb(this);b&&this.cka();this.Bib(a);this.mi.length>=this.hfa&&this.$x.length<this.hfa&&wac_TBb(this);0>=this.mi.length?this.Xd():b&&wac_SBb(this)},Bib:function(a){var b=this.MFa(a);
0>b||(a=this.mi[b],Array.removeAt(this.mi,b),b=this.Xpb[a.lk],delete this.Xpb[a.lk],b.dla(a.lk),this.ada(b,0),0>=wac_tT(b)&&(this.G2.removeChild(b._element),Array.remove(this.$x,b),b.ka()))},MFa:function(a){for(var b=0;b<this.mi.length;b++)if(this.mi[b].lk===a)return b;return-1},cka:function(){for(var a=0;a<this.hfa;a++)this.nJ[a].Xd();this.twb=!1},qXa:function(a,b){var c=window.$$as(wac_RBb,a),c=c?wac_UBb(this,c):-1;if(2===b.fc||1===b.fc&&-1!==c&&!this.nJ[c].Mm())wac_PBb(this,a,0);else if(1===b.fc)this.cka(),
this.R0a=!1;else if(3===b.fc){if(this.Ykc(b.Gcc))return;this.R0a||this.cka()}this.Xa("InteractivityChanged",b,null)},Ykc:function(a){a=a.Za.rawEvent;a=a.relatedTarget||a.toElement;for(var b=!1,c=this.nJ,d=c.length,e=0;e<d;++e)if(wac_td(c[e]._element,a)){b=!0;break}return this.G2!==a&&wac_td(this.G2,a)||b},ada:function(a,b){var c;c=wac_UBb(this,a);(c=!!this.$ac&&a===this.$ac&&-1!==c&&this.nJ[c].Mm())&&0>=wac_tT(a)?this.nJ[b].Xd():c?wac_PBb(this,a,0):this.nJ[b].Xd()},rxc:function(a){this.hfa=a===this.q5?
1:Math.floor(a/(this.q5+2));this.wN?(this._element.style.height=a+"px",this._element.style.width=this.q5+"px"):(this._element.style.width=a+"px",this._element.style.height=this.q5+"px")}};function wac_UBb(a,b){var c=0;a=a.$x;for(var d=a.length,e=0;e<d;++e){if(b===a[e])return c;c++}return-1}
function wac_PBb(a,b,c){if(b)if(a.$ac=b,a.wN){var d=a.q5;if(1<b.mi.length)a.nJ[c].Ch(b.mi,d,(a.wN?a.q5a:a.q5+2)-a.q5);else for(var e=a.G2.children.length,f=0;f<a.G2.children.length;f++)b._element===a.G2.children[f]&&a.nJ[c].Ch(b.mi,d,(a.wN?a.q5a:a.q5+2)-(e-f)*(a.q5+2)+2)}else a.nJ[c].Ch(b.mi,a.eJ(),0)}function wac_OBb(a){for(var b=0;b<a.$x.length;b++)a.$x[b].Ch()}
function wac_TBb(a){var b=a.Mg&&!a.wN?a.$x[0]:a.$x[a.$x.length-1];!b||1>=b.mi.length||(b=Array.clone(a.mi),Array.forEach(b,function(b){a.Bib(b.lk)}),Array.forEach(b,function(b){a.$S(b)}))}function wac_QBb(a){if(!a.twb)return!1;for(var b=0,c=a.nJ,d=c.length,e=0;e<d;++e)c[e].Mm()&&b++;a.twb=0<b&&(a.mi.length<=a.hfa?b===a.mi.length:b===a.hfa);return a.twb}
function wac_SBb(a){if(a.$x&&!(1>a.$x.length)){a.rn(!0);wac_OBb(a);for(var b=0,c=a.$x,d=c.length,e=0;e<d;++e)wac_PBb(a,c[e],b++);a.R0a=!1;a.twb=!0}}function wac_VBb(a){this.Rc=a;wac_sT(this.Rc,10,wac_Fg());wac_sT(this.Rc,9,wac_Hg());wac_sT(this.Rc,6,16);wac_sT(this.Rc,13,wac_Sg())}wac_VBb.prototype={Rc:null,ejc:function(a){return new wac_LBb(a,16,this.Rc)}};
function wac_NBb(a,b){this.PG=Function.createDelegate(this,this.w7);this.vk=Function.createDelegate(this,this.Np);wac_NBb.initializeBase(this,[a]);this.HZ=b.mk(Boolean,8);this.bea=b.mk(Number,6);this._element=a;this._element.className=wac_WBb;this.i5b=this.$j("ul");this._element.appendChild(this.i5b);this.Jc=b.mk(wac_4c,10);this.Jc.Na("click",this._element,this.vk);this.Vi=b.mk(wac_6c,9);this.Vi.Na("msospPointerOut",this._element,this.PG);this.Vi.Na("msospPointerDown",this._element,this.eS);this.Yw=
b.mk(wac_qk,13);this.Yw.Na(this._element,this.eS)}
wac_NBb.prototype={Jc:null,Vi:null,Yw:null,i5b:null,bea:0,HZ:!1,Cyb:function(a){this.fb("InteractivityChanged",a)},x8b:function(a){this.fd("InteractivityChanged",a)},Cwe:null,ka:function(){this._element&&(this.Jc.yb("click",this._element,this.vk),this.Vi.yb("msospPointerDown",this._element,this.eS),this.Vi.yb("msospPointerOut",this._element,this.PG),this.Yw.yb(this._element,this.eS));wac_lT.prototype.ka.call(this)},Xd:function(){this.rn(!1)},Ch:function(a,b,c){this.Xd();if(a&&!(0>=a.length)){this.HZ?
this._element.style.right=b+"px":this._element.style.left=b+"px";this._element.style.top=c+"px";this.Cwe=a;wac_sd(this.i5b);for(b=a.length-1;0<=b;b--)this.$S(a[b]);this.rn(!0)}},$S:function(a){var b=document.createElement("li");b.style.backgroundColor=a.xs;b.style.height=this.bea+"px";b.id="fly_"+a.lk;b.style.lineHeight=this.bea+"px";wac_ud(b,a.gp);b.setAttribute("dir","auto");this.i5b.appendChild(b)},Np:function(){this.Xd();return!1},w7:function(a){this.Xa("InteractivityChanged",new wac_nT(3,a),
null);return!1}};
function wac_RBb(a,b,c){this.vk=Function.createDelegate(this,this.Np);this.PG=Function.createDelegate(this,this.w7);this.eaa=Function.createDelegate(this,this.EHa);this.mi=[];wac_RBb.initializeBase(this,[a]);this._element.className="prGlyph";this.Rc=b;this.KNa=this.Rc.mk(wac_6c,9);this.Sk=this.Rc.mk(wac_4c,10);this.Yw=this.Rc.mk(wac_qk,13);this._element&&(this.KNa.Na("msospPointerDown",this._element,this.eS),this.KNa.Na("msospPointerOver",this._element,this.eaa),this.KNa.Na("msospPointerOut",this._element,
this.PG),this.Sk.Na("dblclick",this._element,this.eS),this.Sk.Na("click",this._element,this.vk),this.Yw.Na(this._element,this.eS));this.$S(c);this.WYb=!1}
wac_RBb.prototype={Xna:null,Rc:null,WYb:!0,Sk:null,KNa:null,Yw:null,Cyb:function(a){this.fb("InteractivityChanged",a)},ka:function(){this._element&&(this.KNa.yb("msospPointerDown",this._element,this.eS),this.KNa.yb("msospPointerOver",this._element,this.eaa),this.KNa.yb("msospPointerOut",this._element,this.PG),this.Sk.yb("dblclick",this._element,this.eS),this.Sk.yb("click",this._element,this.vk),this.Yw.yb(this._element,this.eS));wac_lT.prototype.ka.call(this)},$S:function(a){Array.add(this.mi,a);
2===wac_tT(this)?this.fU(!0):1===wac_tT(this)?this.fU(!1):this.fU(this.WYb)},dla:function(a){var b;a:{for(b=0;b<wac_tT(this);b++)if(this.mi[b].lk===a){a=this.mi[b];Array.removeAt(this.mi,b);b=a;break a}b=null}b&&(1<wac_tT(this)&&this.fU(!0),1===wac_tT(this)?this.fU(!1):1>wac_tT(this)&&this.Xd())},Ch:function(){this.fU(2<=wac_tT(this));this.rn(!0)},Xd:function(){this.rn(!1)},fU:function(a){this.WYb!==a&&(this.Xna&&this._element.removeChild(this.Xna),this.Xna=a?wac_XBb(this,0,5):wac_XBb(this,1,4),this._element.appendChild(this.Xna),
this.WYb=a);this.Xna.childNodes[0].style.backgroundColor=this.mi[this.mi.length-1].xs},EHa:function(a){3!==a.Ne&&this.Xa("InteractivityChanged",new wac_nT(2,a),null);return!1},Np:function(a){this.Xa("InteractivityChanged",new wac_nT(1,a),null);return!0},w7:function(a){3!==a.Ne&&this.Xa("InteractivityChanged",new wac_nT(3,a),null);return!1}};
function wac_XBb(a,b,c){var d=a.Rc.mk(Number,6),e=a.Rc.mk(Object,14);return wac_cka(d,d,a.Rc.mk(String,b),a.Rc.mk(String,c),"cui-img-cont-float cui-img-16by16","",!1,"",a._element.ownerDocument,e?e.cloneNode(!0):null)}function wac_tT(a){return a.mi.length}function wac_YBb(){this.CU={}}wac_YBb.prototype={mk:function(a,b){b=wac_g.wa.aua.NXa.toString(b);return a===Number?(a=this.CU[b])?Number.parseInvariant(a.toString()):0:this.CU[b]},U:function(a,b,c){this.CU[wac_g.wa.aua.NXa.toString(b)]=c}};
function wac_sT(a,b,c){wac_g.wa.aua.NXa.toString(b)in a.CU||(a.CU[wac_g.wa.aua.NXa.toString(b)]=c)}wac_lT.registerClass("Common.App.CollabControls.BasePresenceControl",wac_df,Sys.IDisposable);wac_nT.registerClass("Common.App.CollabControls.InteractivityChangedEventArgs",Sys.EventArgs);wac_oT.registerClass("Common.App.CollabControls.ModernPresenceTooltipControl",wac_lT,wac_aBb,Sys.IDisposable);(function(){}).registerClass("Common.App.CollabControls.ModernPresenceTooltipDancingDots");
wac_tBb.registerClass("Common.App.CollabControls.ModernPresenceTooltipFactory",null,wac_bBb);wac_iBb.registerClass("Common.App.CollabControls.ModernPresenceTooltipFlyoutControl",wac_lT);wac_dBb.registerClass("Common.App.CollabControls.ModernPresenceTooltipPositioner");wac_rT.registerClass("Common.App.CollabControls.FlyoutsPositioningInfo");wac_fBb.registerClass("Common.App.CollabControls.ModernPresenceTooltipTarget");
wac_LBb.registerClass("Common.App.CollabControls.PresenceTooltipControl",wac_lT,wac_aBb,Sys.IDisposable);wac_VBb.registerClass("Common.App.CollabControls.PresenceTooltipFactory",null,wac_bBb);wac_NBb.registerClass("Common.App.CollabControls.PresenceTooltipFlyoutControl",wac_lT);wac_RBb.registerClass("Common.App.CollabControls.PresenceTooltipGlyph",wac_lT);wac_YBb.registerClass("Common.App.CollabControls.PresenceTooltipSettings");
var wac_eBb=0,wac_pBb="http://www.w3.org/2000/svg",wac_qBb="prDancingDots",wac_sBb="prAnimateCircle",wac_vBb="0 0 {0} {1}",wac_oBb=40,wac_nBb=120,wac_uBb="prModernFlyout UIFont",wac_BBb="flyoutIdle",wac_yBb="flyoutExpanded",wac_ABb="flyoutCollapsed",wac_zBb="flyoutFromIdle",wac_CBb="flyoutFromExpanded",wac_EBb="flyoutFromCollapsed",wac_GBb="flyoutStacked",wac_DBb="flyoutFromStacked",wac_KBb="flyoutFadeOut",wac_JBb="cui-img-cont-float cui-img-20by20",wac_IBb="flyoutLtrDir",wac_HBb="flyoutRtlDir",wac_MBb=
0,wac_WBb="prFlyout UIFont";Type.registerNamespace("RealtimePresenceUI");function wac_ZBb(){}wac_ZBb.registerInterface("RealtimePresenceUI.IUserTracker");
function wac__Bb(a,b,c,d){this.ide=Function.createDelegate(this,this.MTe);this.gha=Function.createDelegate(this,this.Jva);this.J4b=new (wac_$a.$$(Number));this.dispose=this.ka;this.en=a;this.JXa=b;if(c){var e=this;c.CW(function(){e.ND=c.Nb();e.ND.ua.fb("UU",e.gha);wac_0Bb(e)})}if(d){var f=this;d.CW(function(){f.TJa=d.Nb();f.TJa.Bhf(f.gha);wac_0Bb(f)})}this.eef=new wac_Bm(this.en.lk,"Anonymous user","#cccccc",new wac_Cm(7),null,null,null,null,!1,!1,!1,0,null,0);this.JEb=this.vZb=!0;this.JXb=this.jQc=
!1;this.OX=wac_1Bb(this.en.lk,this.en.nSa,a.d9c)}function wac_2Bb(a,b){return a.ir.UW(1)&&b.ir.UW(1)||!a.ir.UW(1)&&!b.ir.UW(1)?a.gp.localeCompare(b.gp)-wac_Zf:a.ir.UW(1)?-1:1}
wac__Bb.prototype={eef:null,vZb:!1,jQc:!1,JXb:!1,en:null,OX:null,JXa:null,ND:null,TJa:null,JEb:!1,TLb:function(){return 0<this.OX.R1.ja()},Zzc:function(a){wac_(4482395,325,50,"PeoplesWell: Received user button click");a=a.MenuItemId;if(!a)return!1;var b=this.en.eEb(a);if(!wac_3Bb(this,a,b,!0))return!1;wac_4Bb(this,b);return!0},Jva:function(){if(!this.JXb){var a=this;window.setTimeout(function(){wac_0Bb(a);a.JXb=!1},3E3);this.JXb=!0}},MTe:function(a,b,c,d,e){wac_ab(this.J4b,e.RenderTime);return 32},
ka:function(){this.ND&&(this.ND.ua.fd("UU",this.gha),this.ND=null);this.TJa&&(this.TJa.jnf(this.gha),this.TJa=null)}};
function wac_0Bb(a){a.jQc||(wac_ab(a.J4b,(new Date).getTime()),wac_(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"));var b;b=(a.ND?wac_kT(a.ND):[])||[];for(var c=b.length,d=0;d<c;++d){var e=b[d];if(!e.Lf()){var f=wac_Yd().toString();e.lk=f}e.gp||wac_7qa(e,"Anonymous user");e.ir||(e.ir=new wac_Cm(0));e.gO()||e.H8b("#cccccc");e.x5||(e.x5=0)}c=a.OX;c.R1=new (wac_La.$$(Array));d=b.length;for(e=0;e<d;++e)if(f=b[e],f.Lf()===c.nH){c.Mjc=f;break}d=
b.length;for(e=0;e<d;++e)f=b[e],f.Lf()!==c.nH&&c.ted(f);a.JEb&&1<=a.OX.R1.ja()&&(wac_(6092429,325,50,"PeoplesWell: User is no longer forever alone."),a.JEb=!1);a.vZb=!0;a.XOd(a.en.ha())}
function wac_5Bb(){var a=wac_6Bb;wac_s(wac_q.Z,"CoauthorGalleryTelemetryIsEnabled")&&wac_y().qa(691867605,2147483648,a.ide);a.fa.qa(a.en.Rc.Sac,1,a.iae);wac_B(a.fa,a.en.Rc.Wac,1,a.Wme,96);wac_B(a.fa,a.en.Rc.Uac,1,a.w0d,96);wac_B(a.fa,a.en.Rc.Tac,1,a.v0d,96);wac_B(a.fa,a.en.Rc.Vac,1,a.xke,96);a.fa.qa(a.en.Rc.Xac,1,a.Ste);wac_B(a.fa,a.en.Rc.t7c,1,a.nke,96);a.jQc=!0;wac_0Bb(a)}function wac_7Bb(){return wac_q.Z&&wac_s(wac_q.Z,"ColorPresenceHashIsEnabled")?"Initials":"Menu32"}
function wac_8Bb(){var a;return a=new wac_Uf,a.Id="BasicChat",a.Command="2288458806",a.LabelText=CommonUIStrings.l_StartGroupChat,a.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",a}
function wac_9Bb(a,b){if(!b.ir.UW(1))return b.ot?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;var c=b.ot,d=a.en.nSa(b.Lf());b=a.en.eEb(b.Lf());if(!d)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(d.Oc){case 1:var e;if(b){if(c)a=CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline;else{var f,g;a=((g=wac_$Bb(a,b,f={val:e}),e=f.val,g)&&e.Te&&e.Te.N5&&"0"!==e.Te.N5?String.format(WordEditorIntl.WordEditorStrings.l_PresenceStatusOnPage,
e.Te.N5):CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown)||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}e=a}else e=CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;return e;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}
function wac_3Bb(a,b,c,d){if(!c)return d&&wac_(4482393,325,50,"User does not have any presence data"),!1;if(wac_aCb(a,c)){var e,f,g;(g=wac_$Bb(a,c,f={val:e}),e=f.val,g)&&a.Zwd(e.ll().lC(),e.ll().fH.We())?c=!0:(wac_(41236613,325,50,"Cannot jump to user location because paragraph has not been loaded yet"),c=!1)}else wac_(41236612,325,50,"Cannot jump to user location because presence is not valid"),c=!1;return c?(a=a.en.nSa(b))&&2===a.Oc?!1:!0:(d&&wac_(4482394,325,50,"User has presence data but app can't use it"),
!1)}function wac_bCb(a,b,c,d,e){this.Rc=a;this.lk=b;this.d9c=e;this.eEb=c||function(){return null};this.nSa=d||function(){return null}}function wac_cCb(a,b,c,d){var e=wac_s(wac_q.Z,"WordEditorPresenceDedupeMultipleCoauthorInstances");return new wac_bCb(a,b,c,d,e)}wac_bCb.prototype={Rc:null,ha:function(){return this.Rc.lb},hZc:function(){return this.Rc.jGb},y7b:function(){return this.Rc.vcd},RYc:function(){return this.Rc.Ead},lk:null,eEb:null,nSa:null,d9c:!1};
function wac_dCb(a){this.R1=new (wac_La.$$(Array));this.nH=a}wac_dCb.prototype={nH:null,Mjc:null};function wac_eCb(a,b,c){b=b.toUpperCase();var d,e,f;(f=a.R1.mc(b,e={val:d}),d=e.val,f)||(d=[],a.R1.W(b,d));Array.add(d,c)}function wac_fCb(a){for(var b=[],c=a.R1.Zk().$$ge();c.$$mn();){var d=c.$$cu(),d=a.Qqd(d);Array.add(b,d)}return b}function wac_1Bb(a,b,c){return c?new wac_gCb(a,b):new wac_hCb(a)}function wac_gCb(a,b){wac_gCb.initializeBase(this,[a]);this.eDd=b}
wac_gCb.prototype={eDd:null,ted:function(a){a.Nq||!a.sn?wac_eCb(this,a.Lf(),a):this.Mjc&&wac_qa().Aa(this.Mjc.sn,a.sn)||wac_eCb(this,a.sn,a)},Qqd:function(a){for(var b=new Date(0),c=0<a.length?a[0]:null,d=a.length,e=0;e<d;++e){var f=a[e],g=this.eDd(f.lk);g&&b.getTime()<g.$Ga.getTime()&&(b=g.$Ga,c=f)}return c}};function wac_hCb(a){wac_hCb.initializeBase(this,[a])}wac_hCb.prototype={ted:function(a){wac_eCb(this,a.Lf(),a)},Qqd:function(a){return a[0]}};
wac__Bb.registerClass("RealtimePresenceUI.APeoplesWell",null,wac_uc,Sys.IDisposable);wac_bCb.registerClass("RealtimePresenceUI.PeoplesWellSettings");wac_dCb.registerClass("RealtimePresenceUI.UserTracker",null,wac_ZBb);(function(){}).registerClass("RealtimePresenceUI.UserTrackerFactory");wac_gCb.registerClass("RealtimePresenceUI.UniqueUserTracker",wac_dCb);wac_hCb.registerClass("RealtimePresenceUI.UserInstanceTracker",wac_dCb);Type.registerNamespace("AppRealtimeChannel");
wac_Rn=window.AppRealtimeChannel||{};function wac_iCb(){}wac_iCb.registerInterface("AppRealtimeChannel.IConnectedUsageKpiLogger");window.AppRealtimeChannel.ApiType=wac_Rn.Obb=function(){};wac_Rn.Obb.prototype={SendNotification:0,SendPersistentState:1,Last:2};window.AppRealtimeChannel.ApiType.registerEnum("AppRealtimeChannel.ApiType",!1);window.AppRealtimeChannel.EventCountType=wac_Rn.hIe=function(){};
wac_Rn.hIe.prototype={AttemptCount:0,SuccessCount:1,DropCount:2,FailedCount:3,LatencyOverThresholdCount:4,LatencyUnderThresholdCount:5,ThrottledCount:6,Last:7};window.AppRealtimeChannel.EventCountType.registerEnum("AppRealtimeChannel.EventCountType",!1);function wac_jCb(){}wac_jCb.registerInterface("AppRealtimeChannel.IFrequentLoggingMetrics");function wac_kCb(){}wac_kCb.registerInterface("AppRealtimeChannel.IAssignRtcMachineStrategy");function wac_lCb(){}wac_lCb.registerInterface("AppRealtimeChannel.IRealtimeChannel");
function wac_mCb(){}wac_mCb.registerInterface("AppRealtimeChannel.IRealtimeChannelMetrics");function wac_nCb(){}wac_nCb.registerInterface("AppRealtimeChannel.IRealtimeChannelClientProxy");function wac_oCb(){}wac_oCb.registerInterface("AppRealtimeChannel.IRealtimeChannelServerProxy");function wac_pCb(){}wac_pCb.registerInterface("AppRealtimeChannel.IRealtimeChannelEventHub");function wac_qCb(){}wac_qCb.registerInterface("AppRealtimeChannel.IRealtimeChannelSettings");function wac_rCb(){}wac_rCb.registerInterface("AppRealtimeChannel.IMessageStatus");
function wac_sCb(){}wac_sCb.registerInterface("AppRealtimeChannel.IMessageHandler");function wac_tCb(){}wac_tCb.registerInterface("AppRealtimeChannel.IThrottle");function wac_uCb(){}wac_uCb.registerInterface("AppRealtimeChannel.IThrottleMaxRate");function wac_vCb(){}wac_vCb.registerInterface("AppRealtimeChannel.IMaxOutstandingThrottler");function wac_wCb(){}wac_wCb.registerInterface("AppRealtimeChannel.IThrottlerFactory");function wac_xCb(){}wac_xCb.registerInterface("AppRealtimeChannel.IThrottlerManager");
function wac_yCb(a){this.dhe=Function.createDelegate(this,this.eYe);this.bje=Function.createDelegate(this,this.ZZe);this.n$d=Function.createDelegate(this,this.ONe);this.Fra=Function.createDelegate(this,this.uP);this.os=a;this.os.rga(this.Fra)}wac_yCb.prototype={os:null,U5a:null,Uaa:0,hSa:!1,uP:function(a,b){this.Uaa=b.OL},ZZe:function(){wac_(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");wac_zCb(this.os,null)},ONe:function(a){this.U5a.kb(a)}};
function wac_ACb(a){this.Wae=Function.createDelegate(this,this.IQe);this.kEa=wac_BCb;this.VCa=wac_CCb;this.jad=this.Wae;this.Cn=a}function wac_BCb(a,b){return window.setTimeout(a,b)}function wac_CCb(a){window.clearTimeout(a)}wac_ACb.prototype={rV:!1,iPa:0,TDc:!1,Cn:null,kEa:null,VCa:null,jad:null,IQe:function(){wac_(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Cn)},BW:function(){this.rV&&this.VCa(this.iPa);this.iPa=0;this.rV=!1}};
function wac_DCb(a){a.BW();a.TDc||(a.TDc=!0,a.jad())}function wac_ECb(a){a.rV||(a.iPa=a.kEa(function(){a.rV=!1;wac_DCb(a)},8E3),a.rV=!0,a.TDc=!1)}function wac_FCb(){}wac_FCb.prototype={uad:0,tad:0,sad:0,M9c:0,OEb:!1,Ecc:null,Vbc:null,Usa:null,kJ:null,F_:null};
function wac_GCb(a,b,c,d,e,f,g,h,k,l,m,n){function p(){var c=m?m():wac_q.xk,c=String.format("{0}={1}","qs",wac_bg(c)),c=String.format("{0}&{1}={2}",c,"ClientId",wac_bg(g)),c=String.format("{0}&{1}={2}",c,"usid",wac_bg(a)),c=String.format("{0}&{1}={2}",c,"UserApp",wac_bg(f.toString())),c=String.format("{0}&{1}={2}",c,"UserType",wac_bg((1).toString())),c=String.format("{0}&{1}={2}",c,"UserVersion",wac_bg(e)),c=String.format("{0}&{1}={2}",c,"clientProtocol",wac_bg("1.0")),d;(d=4===f?String.format("{0}={1}",
"NoAuth","1"):b?wac_Pla():null)&&(c=String.format("{0}&{1}",c,d));return c}this.vne=Function.createDelegate(this,this.Bpd);this.Fra=Function.createDelegate(this,this.uP);this.zoe=Function.createDelegate(this,this.s5e);this.pId=(new Date(0)).getTime();this.qgf="enabled errorMessage url connectionString queryString throttling_globalMaxNumberOfOutstandingMessages throttling_maxNumberOfOutstandingMessages throttling_timeToWaitForResponse throttling_messageDelay".split(" ");this.pgf=["enabled","errorMessage"];
this.gc=d;this.Ed=b;this.Vob=c;this.eHc=p();this.Cn=h;this.os=k;this.H0a=n;this.fHc=!1;this.mDa=9E4;if(l){var q=this;l.rb(function(a){a.k6b(function(){wac_(40768456,500,50,"Connection parameters refresh requested for client [{0}]",q.Cn);q.eHc=p();q.Bpd()})})}}function wac_HCb(a,b,c,d,e,f,g,h,k,l){a=a||wac_Yd().toString();a=new wac_GCb(a,b,c,d,e,1,f,g,h,k,null,l);a.kb();return a}
wac_GCb.prototype={eHc:null,Vob:null,Ed:null,XJd:0,B_b:!1,Zqb:!1,gc:null,os:null,Cn:null,SQd:null,F_a:1E3,H0a:null,fHc:!1,aEa:null,Uaa:0,M8c:null,Lab:null,mad:null,q7a:function(){return this.mad},kJ:null,mDa:0,kb:function(){this.os.ua.fb("RMID",this.zoe);this.os.rga(this.Fra)},uP:function(a,b){this.Uaa=b.OL},Bpd:function(){this.B_b=!1;var a=this,b=this;this.oKb(function(b){var d=a.M8c!==b.Usa,e=a.kJ!==b.kJ;wac_ICb(a,b);a.Uaa&&(e?(wac_(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",
a.kJ||"null",b.kJ),wac_zCb(a.os,null)):(a.os.ua.Xa("SPC",new wac_JCb(d,e),null),wac_KCb(a)))},function(){wac_KCb(b)},!0)},s5e:function(){this.F_a=1E3},oKb:function(a,b,c){var d=this.eHc;this.Lab&&""!==this.Lab&&(d=String.format("{0}&{1}={2}",d,"rr",this.Lab));var d=this.Vob+"?"+d,e=null;wac_(4317445,500,50,"Getting MachineId from server for [{0}]",this.Cn);var f={};f["X-CorrelationId"]=wac_Yd().toString();var g={};g.IsNetworkOfflineBeforeSendRequest=this.Ed.xaa;g.HasAvailableConnectionsBeforeSendRequest=
wac_Gla(this.Ed);g.MaxConnectionsAllowed=this.Ed.fTa;g.IsRefreshMachineId=c;this.H0a&&!this.fHc?(wac_LCb(this,wac_MCb(this,null,g,a,b,c),wac_NCb(this,null,g,b,c)),this.fHc=!0):(this.gc&&(e=this.gc.Qe("WebServiceCall","GetMachineIdFromTheServer")),wac_Uj(this.Ed,d,1,null,f,["RtcErrorCode","RtcGracefulShutdownInProgress"],1,wac_MCb(this,e,g,a,b,c),wac_NCb(this,e,g,b,c),null,this.mDa,"3",!1,null,null))}};
function wac_OCb(a,b,c){b||(b={});b.ConnectionState=wac_g.dIb.toString(a.Uaa);c||a.os.ua.Xa("RCF",new wac_PCb(1,b),null)}function wac_QCb(a,b,c,d){d||(d={});d.IsNetworkOfflineAfterRequestComplete=a.Ed.xaa;d.IsRequestSucceeded=c;b&&(d.EnqueueTime=b.K0,d.InvokedTime=b.hB,d.CompletedTime=b.aP,b.Qj&&"X-CorrelationId"in b.Qj&&(d.CorrelationId=b.Qj["X-CorrelationId"]));wac_(38633565,500,c?50:15,wac_uT(d))}
function wac_NCb(a,b,c,d,e){return function(f){b&&b.gd();a.Zqb=!1;wac_QCb(a,f.Qa,!1,c);var g=null,h="unknown",k="unknown";if(f.Qa){if(h=f.Qa.Qj)"RtcErrorCode"in h&&(g=h.RtcErrorCode.toString()),"RtcGracefulShutdownInProgress"in h&&(a.Zqb=!0);h=wac_g.fla.toString(f.Qa.Oc);k=f.Qa.kj.toString()}c.FindSessionFailureReason="FindSessionRequestFailed";c.HttpErrorCode=k;c.HttpErrorStatus=h;c.RtcErrorCode=g;c.RtcGracefulShutdownInProgress=a.Zqb.toString();wac_(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}', RtcGracefulShutdownInProgress='{4}'",
h,k,a.Cn,g,a.Zqb);wac_OCb(a,c,e);d(g)}}
function wac_MCb(a,b,c,d,e,f){return function(g){b&&b.gd();wac_QCb(a,g.Qa,!0,c);if(g=wac_RCb(g.Qa.he,"FindSession",null,!0)){var h;if(Object.getType(g)!==Object)h=null;else{for(var k in g);b:if("enabled"in g){for(var l=(k=g.enabled)?a.qgf:a.pgf,m=l.length,n=0;n<m;++n)if(!(l[n]in g)){h=null;break b}l=(h=new wac_FCb,h.OEb=g.enabled,h.Ecc=g.errorMessage,h.F_=wac_Yd().toString(),h);k&&(l.Vbc=g.url,l.Usa=g.queryString,l.kJ=g.connectionString,l.M9c=g.throttling_globalMaxNumberOfOutstandingMessages,l.sad=
g.throttling_maxNumberOfOutstandingMessages,l.tad=g.throttling_timeToWaitForResponse,l.uad=g.throttling_messageDelay);h=l}else h=null}if(h){if(h.OEb&&h.Usa&&h.kJ){wac_(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",a.Cn);a.Lab=null;d(h);return}c.FindSessionFailureReason="FindSessionInvalidResponse";c.IsRtcEnabled=h.OEb;c.IsQueryStringEmpty=!h.Usa;c.IsConnectionStringEmpty=!h.kJ;wac_(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
a.Cn,h.OEb,!h.Usa,!h.kJ)}else c.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",wac_(8745097,500,15,"Could not translate server response to findSession response for [{0}]",a.Cn)}else c.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",wac_(7372827,500,10,"Could not deserialize response data for [{0}]",a.Cn);wac_OCb(a,c,f);e(null)}}
function wac_LCb(a,b,c){wac_(50448152,500,50,"Using FindSessionUtils find session response");a.H0a.$Wb.yc.CW(function(){a.H0a.$Wb.yc.Nb()?(wac_(50448153,500,50,"FindSessionUtils find Session resulted in success"),b(a.H0a.YDb)):(wac_(50448154,500,15,"FindSessionUtils find Session resulted in error"),c(a.H0a.YDb))})}function wac_SCb(a){a.B_b&&(window.clearTimeout(a.XJd),a.B_b=!1)}function wac_KCb(a){wac_SCb(a);a.B_b=!0;a.XJd=window.setTimeout(a.vne,9E5)}
function wac_ICb(a,b){try{a.aEa=b,a.mad=b.Vbc+"?"+b.Usa,a.kJ=b.kJ,a.M8c=b.Usa,a.SQd=b.Vbc}catch(c){wac_(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",c.toString())}}function wac_TCb(a){var b=(new Date).getTime();a=a.pId+a.F_a-b;0>a&&(a=0);return a}
function wac_UCb(a,b,c,d,e){wac_(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}] OrderlyShutdownInprogress is [{1}]",a.kJ,a.Zqb);if(a.kJ)b();else{var f=wac_TCb(a);window.setTimeout(function(){d(e,"RequestMachineId")&&(a.pId=(new Date).getTime(),a.oKb(function(c){wac_ICb(a,c);wac_KCb(a);b()},function(b){a.kJ=null;wac_SCb(a);c(b)},!1))},f)}}
function wac_VCb(a,b,c,d,e,f){wac_UCb(a,function(){e(f,"GetMachineIdSuccess")&&(wac_(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",a.kJ,a.Cn),b(a.SQd),d(new wac_WCb(a.aEa.uad,a.aEa.tad,a.aEa.sad,a.aEa.M9c)))},function(b){e(f,"GetMachineIdFailure")&&(wac_(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",a.Cn),c(b))},e,f)}function wac_XCb(a,b){b.val=a.aEa.F_;return String.format("{0}&{1}={2}",a.aEa.Usa,"corrid",wac_bg(b.val))}
function wac_YCb(a){this.Vae=Function.createDelegate(this,this.HQe);this.Ed=a;this.Dq=Array(2);for(a=0;2>a;a++){this.Dq[a]=Array(7);for(var b=0;7>b;b++)this.Dq[a][b]=0}this.UDb=this.lHc=this.V_b=!1}
wac_YCb.prototype={UDb:!1,Dq:null,Ed:null,V_b:!1,lHc:!1,$Mc:0,UJd:0,HQe:function(){if(this.V_b){if((new Date).getTime()-this.$Mc<5E3+this.UJd){for(var a={},b=0;2>b;b++)for(var c=0;7>c;c++){var d=window.AppRealtimeChannel.ApiType.toString(b)+window.AppRealtimeChannel.EventCountType.toString(c);a[d]=this.Dq[b][c]}a=wac_rn(a);wac_(50644352,500,15,a)}this.$Mc=(new Date).getTime();for(a=0;2>a;a++)for(b=0;7>b;b++)this.Dq[a][b]=0;this.V_b=!1}}};
function wac_vT(a,b,c){a.lHc&&!a.UDb&&window.navigator.onLine&&!a.Ed.xaa&&(a.Dq[b][c]++,a.V_b=!0)}function wac_ZCb(a,b){a.UJd=b;window.setInterval(a.Vae,b);a.$Mc=(new Date).getTime()}
function wac__Cb(a,b,c,d,e,f,g,h,k,l,m,n){this.b0d=Function.createDelegate(this,this.Uze);this.c7c=Function.createDelegate(this,this.bud);this.oee=Function.createDelegate(this,this.ond);this.M0d=Function.createDelegate(this,this.XAe);this.bie=Function.createDelegate(this,this.lZe);this.aie=Function.createDelegate(this,this.kZe);this.fie=Function.createDelegate(this,this.pZe);this.ite=Function.createDelegate(this,this.rbf);this.mje=Function.createDelegate(this,this.l_e);this.nje=Function.createDelegate(this,
this.m_e);this.L5d=Function.createDelegate(this,this.sJb);this.FK=new (wac_La.$$(wac_Ha.$$(wac_Rn.aib,wac_0Cb)));this.ZLc=(new Date(0)).getTime();this._clientId=a;this.Mxb=b;this.eN=0;this.gc=d;this.FUb=h;this.mOa=g;this.tx=k;this.iyd=e;this.bxa=f;this.Cn=c;this.Dq=l;this.Rc=m;this.Ed=n}function wac_1Cb(a,b,c,d,e,f,g,h){return wac_2Cb(a,b,c,d,e,f,g,h)}
wac__Cb.prototype={_clientId:null,hY:null,eN:0,Rc:null,q7a:function(){return this.bxa.q7a()},iyd:null,Qmb:1,wU:null,Mxb:null,gc:null,FUb:null,bxa:null,mOa:null,Cn:null,Dq:null,Ed:null,tx:null,kb:function(){this.tx.ua.fb("RC",this.L5d);this.tx.ua.fb("UPSR",this.nje);this.tx.ua.fb("UPSC",this.mje);wac_Sj(this.Ed,this.Dq);var a=this;wac_Ah(function(){a.Dq.qpd()});wac_3Cb(this);wac_4Cb();this.tx.ua.fb("SPC",this.ite)},bud:function(a,b){return a!==this.Qmb?(wac_(4309017,500,15,"ConnectionToken verification failed for {0}",
b),!1):!0},IIb:function(){2!==this.eN&&1!==this.eN&&(wac_(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Cn),wac_ECb(this.FUb),this.uP(1,this.eN),wac_5Cb(this),wac_wT&&(wac_wT.UDb=!1))},ond:function(a){this.Dq.kpd();var b=null;!a||"documentsessiondeleted"!==(b=a.toLowerCase())&&"documentsessionexpired"!==b?this.sJb(null,null):(wac_(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Cn,a),
this.eVa())},sJb:function(a,b){wac_(4309018,500,50,"Disconnecting the connection [{0}]",this.hY);a=(a=2===this.eN||1===this.eN)&&!this.mOa.hSa;b&&Object.getType(b)!==Object.getType(Sys.EventArgs.Empty)&&b.TFb&&""!==b.TFb&&(a=!0,this.bxa.Lab=b.TFb);a&&this.uP(1,this.eN);++this.Qmb;this.mOa.MX();wac_6Cb(this);b=this.bxa;b.kJ=null;wac_SCb(b);b.F_a+=3E3;b.F_a=Math.min(b.F_a,3E5);wac_3Cb(this);a&&wac_5Cb(this)},rbf:function(){var a=null,b,c,d=(c=wac_XCb(this.bxa,b={val:a}),a=b.val,c);this.wU.qs=d;wac_(40768457,
500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Cn,a)},XAe:function(a){this.ZLc=(new Date).getTime();var b=null,c,d;this.wU.qs=(d=wac_XCb(this.bxa,c={val:b}),b=c.val,d);this.Rc.dbc&&(this.wU.url=a,wac_(51655757,500,50,"Using [{0}] url for SignalR connection",wac_si(a)));var e=null;this.gc&&(e=this.gc.Qe("WebServiceCall","ConnectToServer"));wac_(3290048,500,50,"Connecting to server for client [{0}]",this.Cn);a={};this.Mxb&&(a.transport=1===this.Mxb.length?this.Mxb[0]:
this.Mxb);var f=this,g=this;this.wU.start(a,null).done(function(a){f.Dq.lpd();wac_(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",a.id,b)}).fail(function(a){wac_(3457858,500,15,"Failed to connect to server : connection string: {0}, machine connection string: {1}, CorrelationId:{2}, callback parameter:{3} for [{4}]",g.bxa.kJ,g.q7a(),b,wac_uT(a),g.Cn);g.ond(null);g.Dq.jpd(a);a={CorrelationId:b,ErrorDetails:a,ConnectionState:wac_g.dIb.toString(g.eN)};g.tx.ua.Xa("RCF",
new wac_PCb(0,a),null)}).always(function(){e&&e.gd()})},eVa:function(){this.eN?(this.Dq.mpd(),wac_wT&&(wac_wT.UDb=!0),wac_(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Cn),this.mOa.hSa=!0,this.FUb.BW(),this.uP(0,this.eN),this.sJb(null,null),this.mOa.hSa=!1):wac_(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Cn)},VZ:function(){return this.eN},rga:function(a){this.tx.rga(a)},dBb:function(a){this.tx.dBb(a)},$qd:function(a){return this.uIa(0,
a)},uIa:function(a,b){var c=new (wac_$a.$$(Object));this.tx.ua.Xa("SP",new wac_7Cb(a,b,c),null);return c.yc},LPa:function(a){this.tx.LPa(a)},sga:function(a){this.tx.sga(a)},SQa:function(a){this.tx.SQa(a)},Q6a:function(a){this.tx.Q6a(a)},B8b:function(a){this.tx.B8b(a)},l6b:function(a){this.tx.l6b(a)},A8b:function(a){this.tx.A8b(a)},QLe:function(a){return this.FK.gb(a)&&this.FK.B(a).gb(0)?this.FK.B(a).B(0).gDa:null},zja:function(){return this.Eua(0)},Eua:function(a){for(var b={},c=this.FK.GetEnumerator();c.$$mn();){var d=
c.$$cu();d.pa().gb(a)&&(b[d.Ge()]=d.pa().B(a).gDa)}return b},m_e:function(a,b){for(a=b.qdd.GetEnumerator();a.$$mn();){var c=a.$$cu();this.FK.gb(c.Ge())||this.FK.W(c.Ge(),new (wac_Ha.$$(wac_Rn.aib,wac_0Cb)));var d=c.pa();this.FK.B(c.Ge()).W(b.fc,new wac_0Cb(d.Presence,new Date(d.TimeStamp)));c.Ge()!==this._clientId||b.fc||this.tx.Jvc(d.Presence)}},l_e:function(a,b){a=b.ORa;b=a.length;for(var c=0;c<b;++c)this.FK.xb(a[c])},BM:function(a,b,c){var d=new (wac_$a.$$(Object));this.tx.ua.Xa("SUN",new wac_8Cb(a,
b,c,d),null);return d.yc},U3:function(a){this.tx.U3(a)},eBb:function(a){this.tx.eBb(a)},ljd:function(a){var b,c,d,e,f,g;(e=this.FK.mc(a,d={val:b}),b=d.val,e)&&(g=b.mc(0,f={val:c}),c=f.val,g)?(a=(a=c)&&a.DGb?(new Date).getTime()-a.DGb.getTime()>(this.Rc.wbc?6E4:this.Rc.vbc)?2:1:1,c=new wac_2ja(a,c.DGb)):c=null;return c},leb:function(){for(var a={},b=this.FK.GetEnumerator();b.$$mn();){var c=b.$$cu(),d,e,f;if(f=c.pa().mc(0,e={val:d}),d=e.val,f)a[c.Ge()]=this.ljd(c.Ge())}return a},Lf:function(){return this._clientId},
uP:function(a,b){if((1!==this.eN||b||1!==a)&&this.eN!==b){var c=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.eN,b,a]));wac_(3290053,500,10,c)}if(this.eN!==a){switch(a){case 2:wac_wT&&(wac_wT.lHc=!0);this.hY=this.wU.id;wac_(3249539,500,50,"Established connection [{0}] for client [{1}]",this.hY,this.Cn);if((c=this.wU)&&c.transport&&c.transport.name){var c=c.transport.name,d=c.toLowerCase();"websockets"===
d?wac_(4290723,500,50,"Transport name - {0} for [{1}]",c,this.Cn):"serversentevents"===d?wac_(4290752,500,50,"Transport name - {0} for [{1}]",c,this.Cn):"foreverframe"===d?wac_(4290753,500,50,"Transport name - {0} for [{1}]",c,this.Cn):"longpolling"===d?wac_(4290754,500,50,"Transport name - {0} for [{1}]",c,this.Cn):"mocktransport"!==d&&wac_(4290755,500,15,"Unknown transport protocol encountered - '{0}'",c)}else wac_(4290722,500,10,"Transport protocol name is missing");wac_(4298369,500,50,"Retrieving complete session state");
c=null;this.gc&&(c=this.gc.Qe("WebServiceCall","Receive First Presence"));var d=this.tx,e=this.c7c,f=this.Qmb,g=this.FUb,h=this.b0d;var k=new (wac_Ha.$$(wac_Rn.aib,Object));if(this.FK.gb(this._clientId))for(var l=this.FK.B(this._clientId).$$ge();l.$$mn();){var m=l.$$cu();k.W(m.Ge(),m.pa().gDa)}d.ua.Xa("RPS",new wac_9Cb(e,f,g,h,k,c),null);break;case 1:2===b&&wac_(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.hY);break;case 0:if(this.mOa.hSa)wac_(3249543,500,
50,"Connection [{0}] has been explicitly closed",this.hY);else{1===b&&(wac_(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.hY),this.Dq.npd());2===b&&wac_(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.hY);this.sJb(null,null);return}}this.eN=a;this.tx.ua.Xa("CSC",new wac__ja(a,
b),null)}},pZe:function(){wac_(3249544,500,50,"Detected that the connection [{0}] is slow",this.hY)},kZe:function(a){wac_(3249545,600,10,"SignalR ERROR for connection [{0}]: {1}",this.hY,wac_uT(a)||"<empty>")},lZe:function(){},Uze:function(){var a,b=[],c,d;(d=this.FK.mc(this._clientId,c={val:a}),a=c.val,d)&&this.FK.xb(this._clientId);for(d=this.FK.Yg().$$ge();d.$$mn();)c=d.$$cu(),Array.add(b,c);d=b.length;for(var e=0;e<d;++e)c=b[e],this.FK.xb(c);a&&this.FK.W(this._clientId,a);this.tx.ua.Xa("IPSC",
new wac_Li(b),null)}};function wac_$Cb(a){switch(a){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",a,"Unknown SignalR state");}}function wac_aDb(a){var b=0;a.wU.state||(b=a.ZLc+15E3-(new Date).getTime(),0>b&&(b=0));return b}
function wac_6Cb(a){function b(){d.stop(!0,!0)}var c=wac_aDb(a),d=a.wU;a=a.hY;0<c?(wac_(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",a,c),window.setTimeout(b,c)):(wac_(36804372,500,50,"Stopping connection [{0}].",a),b())}function wac_5Cb(a){var b=a.Qmb;a.Dq.ipd();wac_VCb(a.bxa,a.M0d,a.oee,a.mOa.n$d,a.c7c,b)}
function wac_3Cb(a){var b=++a.Qmb;a.ZLc=(new Date(0)).getTime();a.wU=a.iyd();a.tx.ua.Xa("RP",new wac_bDb(a.wU),null);a.wU.stateChanged(function(c){a.bud(b,"StateChangedSignalR")&&a.uP(wac_$Cb(c.newState),wac_$Cb(c.oldState))});a.wU.connectionSlow(a.fie);a.wU.error(a.aie);a.wU.log=a.bie}function wac_cDb(){return function(){return!1}}
function wac_4Cb(){try{var a=$.signalR;if(!a)throw Error.invalidOperation("Failed to retrieve Signalr object");var b=a.version;if(!b)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===b){var c=a.transports;if(!c)throw Error.invalidOperation("Failed to retrieve transports object");var d=c.longPolling;if(!d)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!d.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");
d.supportsKeepAlive=wac_cDb()}}catch(e){wac_(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",e.message)}}function wac_0Cb(a,b){this.gDa=a;this.DGb=b}wac_0Cb.prototype={gDa:null,DGb:null};
function wac_2Cb(a,b,c,d,e,f,g,h){var k=null,l=null,m=wac_dDb(),n=wac_q.Jr?wac_q.Jr:"1.0",p=wac_eDb(a,b),q=m.Rbc?wac_fDb(p):new wac_gDb,r;wac_wT||(wac_wT=new wac_YCb(d));r=wac_wT;m.Ybd&&wac_ZCb(r,m.Xbd);var t="",t=g&&""!==g?g:"/rtc2/";wac_(51655758,500,50,"Using [{0}] url for findSession and initial hubConnection",wac_si(t));var u=t+"signalr";g=t+"findsession";t=new wac_hDb;l=l||wac_iDb||(wac_iDb=new wac_jDb);r=new wac_kDb(m,new wac_lDb(t),a,p,function(a){return new wac_mDb(a.createHubProxy("realtimeChannelHub"))},
f,l,q,r);k||(k=wac_HCb(b,d,g,f,n,a,p,l,e,h));k.mDa=m.mDa;b=new wac_ACb(p);c=c?c.split(","):null;a=new wac__Cb(a,c,p,f,function(){return window.$.hubConnection(u)},k,r,b,l,q,m,d);a.kb();return a}function wac_eDb(a,b){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",a,wac_nDb(wac_Rn.Xwc.toString(1)),wac_nDb(wac_Rn.Ywc.toString(1)),b)}function wac_nDb(a){return a?a.charAt(0).toLocaleUpperCase()+a.substring(1,a.length):a}function wac_oDb(){}
function wac_fDb(a){wac_pDb||(wac_pDb=new wac_oDb,wac_(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",a));return wac_pDb}
wac_oDb.prototype={sOc:0,htb:0,ALd:0,yLd:0,zLd:0,DLd:0,CLd:0,BLd:0,J0a:null,aXb:null,XLc:null,s2a:null,Drb:null,mza:null,YLc:null,hMc:null,gMc:null,Orb:null,qMc:null,dXb:null,vxd:0,PQd:0,qsb:0,lNc:0,ipd:function(){this.sOc++;this.XLc=new Date;this.J0a||(this.J0a=new Date)},lpd:function(){this.htb++;this.mza=new Date;this.aXb||(this.aXb=this.mza);this.Orb=this.mza;this.J0a&&1===this.htb&&(this.qsb=Math.max(this.qsb,this.mza.getTime()-this.J0a.getTime()));this.s2a&&1<this.htb&&(this.qsb=Math.max(this.qsb,
this.mza.getTime()-this.s2a.getTime()));this.Drb&&1<this.htb&&(this.lNc=Math.max(this.lNc,this.mza.getTime()-this.Drb.getTime()))},kpd:function(){this.ALd++;this.YLc=new Date},npd:function(){this.yLd++;this.s2a=new Date},mpd:function(){this.zLd++;this.Drb=new Date},Rvc:function(){this.hMc=new Date;this.DLd++},sib:function(){this.dXb||(this.dXb=new Date);this.CLd++},YHa:function(){this.gMc=new Date;this.BLd++},wKd:!1,qpd:function(){!this.wKd&&this.sOc&&(wac_(39321871,500,15,wac_rn({numberOfConnectionAttempts:this.sOc,
numberOfSuccessfulConnections:this.htb,numberOfFailedConnections:this.ALd,numberOfDisconnectedConnections:this.yLd,numberOfExplicitDisconnectedConnections:this.zLd,numberOfSentMessages:this.DLd,numberOfReceivedMessages:this.CLd,numberOfLostMessages:this.BLd,firstConnectionAttempt:this.J0a?this.J0a:null,firstMessageReceived:this.dXb?this.dXb:null,firstConnectionSuccess:this.aXb?this.aXb:null,lastConnectionAttempt:this.XLc?this.XLc:null,lastConnectionSuccess:this.mza?this.mza:null,lastConnectionFailure:this.YLc?
this.YLc:null,lastMessageSent:this.hMc?this.hMc:null,lastMessageLost:this.gMc?this.gMc:null,lastDisconnect:this.s2a?this.s2a:null,lastExplicitDisconnect:this.Drb?this.Drb:null,lastTimeOnline:this.Orb?this.Orb:null,lastTimeOffline:this.qMc?this.qMc:null,maxDisconnectedTimeMs:this.qsb,maxExplicitDisconnectedTimeMs:this.lNc,clientConnectionErrors:this.vxd,serverConnectionErrors:this.PQd})),this.wKd=!0)},jpd:function(a){var b,c,d,e=b={val:b},f=c={val:c},g=d={val:d};e.val=0;f.val=null;g.val=null;if(a)try{var h=
a.source;h&&Object.getType(h)===String&&(g.val=h);var k=a.context;k&&(a=k,e.val=a.status?a.status:0,f.val=a.statusText?a.statusText:null)}catch(l){}b=b.val;c=c.val;d=d.val;b&&200!==b&&(wac_(40157596,500,15,wac_rn({HttpErrorCode:b,HttpErrorStatus:c,Exception:d})),400<=b&&499>=b&&this.vxd++,500<=b&&599>=b&&this.PQd++)},lHa:function(){this.qMc=new Date},mHa:function(){this.s2a=this.Orb=new Date}};function wac_gDb(){}
wac_gDb.prototype={ipd:function(){},lpd:function(){},kpd:function(){},npd:function(){},mpd:function(){},Rvc:function(){},sib:function(){},YHa:function(){},qpd:function(){},jpd:function(){},lHa:function(){},mHa:function(){}};function wac_mDb(a){this.Ap=a}wac_mDb.prototype={Ap:null,BM:function(a,b){return this.Ap.invoke("SendUpdateNotification",a,b)}};function wac_qDb(){}
function wac_dDb(){var a=wac_q.Z;if(!a){var b;return b=new wac_qDb,b.Y7c=!1,b.wbc=!1,b.vbc=9E5,b.dbc=!1,b.Cbd=5E3,b.iec=!0,b.Hfc=!1,b.Rbc=!1,b.mDa=9E4,b}var c;return c=new wac_qDb,c.Y7c=wac_s(a,"AwayStatusManagerIsEnabled"),c.wbc=wac_s(a,"AwayStatusOneMinuteTimeoutIsEnabled"),c.vbc=wac_D(a,"AwayCoauthorThresholdMs",9E5),c.dbc=wac_s(a,"RtcAllowCrossDomainAccessEnabled"),c.Cbd=wac_D(a,"RTCReconnectionSlowDurationMilliseconds",5E3),c.iec=wac_s(a,"RTCLogUpdateNotificationHintOnDeserializationFailure"),
c.Hfc=wac_s(a,"ShouldLogOnContentNotification"),c.Rbc=wac_s(a,"RtcClientMetricsEnabled"),c.mDa=wac_D(a,"RtcFindSessionRequestTimeoutInMS",6E4),c.Ybd=wac_s(a,"RtcJsClientFrequentlyLogsMetrics"),c.wfc=wac_D(a,"RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),c.Xbd=wac_D(a,"RtcJsClientFrequentMetricsLogIntervalInMS",3E5),c}wac_qDb.prototype={Y7c:!1,wbc:!1,vbc:0,dbc:!1,Cbd:0,iec:!1,Hfc:!1,Rbc:!1,mDa:0,Ybd:!1,wfc:0,Xbd:0};function wac_jDb(){this.ua=new wac_df}
wac_jDb.prototype={ua:null,Jvc:function(a){this.ua.Xa("MPU",new wac_0ja(a),null)},rga:function(a){this.ua.fb("CSC",a)},dBb:function(a){this.ua.fd("CSC",a)},sga:function(a){this.ua.fb("PU",a)},SQa:function(a){this.ua.fd("PU",a)},LPa:function(a){this.ua.fb("MPU",a)},U3:function(a){this.ua.fb("UNR",a)},eBb:function(a){this.ua.fd("UNR",a)},Q6a:function(a){this.ua.fb("PSU",a)},B8b:function(a){this.ua.fd("PSU",a)},l6b:function(a){this.ua.fb("PSC",a)},A8b:function(a){this.ua.fd("PSC",a)}};
function wac_zCb(a,b){a.ua.Xa("RC",b,null)}function wac_7Cb(a,b,c){wac_7Cb.initializeBase(this);this.fc=a;this.uC=b;this.abb=c}wac_7Cb.prototype={fc:0,uC:null,abb:null};function wac_8Cb(a,b,c,d){wac_8Cb.initializeBase(this);this.fc=a;this.pdd=b;this.b9c=c;this.abb=d}wac_8Cb.prototype={fc:0,pdd:null,b9c:!1,abb:null};function wac_bDb(a){wac_bDb.initializeBase(this);this.c$c=a}wac_bDb.prototype={c$c:null};
function wac_9Cb(a,b,c,d,e,f){wac_9Cb.initializeBase(this);this.Agc=a;this.qDb=b;this.L8c=c;this.Hcc=e;this.C8c=d;this.nEa=f}wac_9Cb.prototype={nEa:null,Hcc:null,C8c:null,L8c:null,qDb:0,Agc:null};function wac_rDb(a,b){wac_rDb.initializeBase(this);this.fc=a;this.qdd=b}wac_rDb.prototype={fc:0,qdd:null};function wac_sDb(a){wac_sDb.initializeBase(this);this.ORa=a}wac_sDb.prototype={ORa:null};function wac_tDb(a,b,c){wac_tDb.initializeBase(this);this.TFb=a;this.awe=b;this.$ve=c}
wac_tDb.prototype={TFb:null,awe:0,$ve:null};function wac_JCb(a,b){wac_JCb.initializeBase(this);this.Nue=a;this.Ive=b}wac_JCb.prototype={Nue:!1,Ive:!1};function wac_PCb(a,b){wac_PCb.initializeBase(this);this.$ue=a;this.Ecc=b}wac_PCb.prototype={$ue:0,Ecc:null};function wac_uDb(a){wac_uDb.initializeBase(this);this.Yve=a}wac_uDb.prototype={Yve:null};
function wac_kDb(a,b,c,d,e,f,g,h,k){this.fha=Function.createDelegate(this,this.Iva);this.I8a=Function.createDelegate(this,this.uOb);this.eha=Function.createDelegate(this,this.Pka);this.gJ=Function.createDelegate(this,this.xP);this.zpe=Function.createDelegate(this,this.uIa);this.xfe=Function.createDelegate(this,this.lWe);this.yfe=Function.createDelegate(this,this.mWe);this.Afe=Function.createDelegate(this,this.oWe);this.zfe=Function.createDelegate(this,this.nWe);this.yac=Function.createDelegate(this,
this.BM);this.ahe=Function.createDelegate(this,this.cYe);this.fQc=new (wac_Ha.$$(wac_Rn.Fkb,Object));wac_kDb.initializeBase(this,[g]);this.Rc=a;this.rOc=this.pOc=0;this.U5a=b;this.U5a.m6b(this.bje);this._clientId=c;this.AOd=e;this.os.ua.fb("RP",this.dhe);this.os.ua.fb("RPS",this.ahe);this.os.ua.fb("SUN",this.yac);this.os.ua.fb("IPU",this.zfe);this.os.ua.fb("IUNR",this.Afe);this.os.ua.fb("IPSU",this.yfe);this.os.ua.fb("IPSC",this.xfe);this.os.ua.fb("SP",this.zpe);this.gc=f;this.Cn=d;this.Dq=h;this.mK=
k}
wac_kDb.prototype={Rc:null,Ap:null,pOc:0,rOc:0,PJd:!1,_clientId:null,AOd:null,gc:null,U_b:0,Cn:null,Dq:null,mK:null,eYe:function(a,b){this.Ap=this.AOd(b.c$c);this.U5a.Nc();this.Ap.Ap.on("presenceUpdated",this.gJ);this.Ap.Ap.on("persistentStateUpdated",this.eha);this.Ap.Ap.on("persistentStateCleared",this.I8a);this.Ap.Ap.on("updateNotification",this.fha)},uP:function(a,b){this.Uaa=b.OL;if(2===b.OL){for(a=this.fQc.$$ge();a.$$mn();)b=a.$$cu(),this.BM(null,new wac_8Cb(b.Ge(),b.pa(),!1,new (wac_$a.$$(Object))));this.fQc=
new (wac_Ha.$$(wac_Rn.Fkb,Object))}},cYe:function(a,b){b.C8c();for(a=0;2>a;++a)wac_vDb(this,a,b)},uIa:function(a,b){a=b.uC;var c=wac_wDb(a),d=b.abb,e=new (wac_La.$$(window.Common.PresenceDataEntryForClients)),f;e.W(this._clientId,(f=new window.Common.PresenceDataEntryForClients,f.Presence=a,f.TimeStamp=(new Date).getTime(),f));this.os.ua.Xa("UPSR",new wac_rDb(b.fc,e),null);wac_vT(this.mK,1,0);if(2!==this.Uaa)this.Dq.YHa(),wac_vT(this.mK,1,2),d.Me(null);else{var g=this.U_b.toString();++this.U_b;var h=
this;f=new wac_xDb(function(){return wac_yDb(h,b.fc,c,g)},g);f=wac_zDb(this.U5a,"0,"+b.fc).U(f);var k=this;wac_ADb(f,function(a){2===a&&wac_vT(k.mK,1,6);d.Me(null)});wac_BDb(f,function(){})}},BM:function(a,b){var c=b.fc;a=b.pdd;var d=b.b9c,e=b.abb,f=wac_wDb(a);wac_vT(this.mK,0,0);if(2!==this.Uaa)d?this.fQc.W(c,a):(this.Dq.YHa(),wac_vT(this.mK,0,2)),e.Me(null);else{var g=this.U_b.toString();++this.U_b;var h=this;b=new wac_xDb(function(){return wac_CDb(h,c,f,g)},g);b=wac_zDb(this.U5a,"1,"+c).U(b);var k=
this;wac_ADb(b,function(a){2===a&&wac_vT(k.mK,0,6);e.Me(null)});wac_BDb(b,function(){})}},MX:function(){this.Ap.Ap.off("presenceUpdated",this.gJ);this.Ap.Ap.off("persistentStateUpdated",this.eha);this.Ap.Ap.off("persistentStateCleared",this.I8a);this.Ap.Ap.off("updateNotification",this.fha)},nWe:function(a,b){this.xP(b.HS,b.N9a)},xP:function(a){this.Dq.sib();this.Pka(0,a)},mWe:function(a,b){this.Pka(b.fc,b.HS)},Pka:function(a,b){this.Dq.sib();wac_DDb(this,a,b,null)},lWe:function(a,b){this.uOb(b.ORa)},
uOb:function(a){this.Dq.sib();if(wac_ha.D1(500,100))for(var b=0;b<a.length;++b);a.length&&(this.os.ua.Xa("UPSC",new wac_sDb(a),null),this.os.ua.Xa("PSC",new wac_Li(a),null),this.os.ua.Xa("PU",new wac_Ii({},a,null),null))},oWe:function(a,b){this.Iva(b.wg,b.mqa)},Iva:function(a,b){this.Rc.Hfc&&!a&&wac_(40128990,500,100,"Received ContentUpdate notification from the server");this.Dq.sib();if(5===a){wac_(18637071,500,50,"Received client reconnection request from the server - rebooting the client connection");
a=this.os;var c;try{if(b&&""!==b){var d=JSON.parse(b);c=new wac_tDb(d.rr,d.rbp,d.rd)}else c=null}catch(e){wac_(593844380,500,15,"Error when parsing reconnect hint: {0}",e.message),c=null}wac_zCb(a,c)}else b=wac_RCb(b,String.format("UpdateNotification-{0}",wac_Rn.Fkb.toString(a)),null,this.Rc.iec),this.os.ua.Xa("UNR",new wac_1ja(a,b),null)}};
function wac_DDb(a,b,c,d){if(wac_ha.D1(500,100))for(var e in c);delete c[a._clientId];if(!wac_Lf(c)){for(var f in c){e={key:f,value:c[f]};var g=e.key;c[g]=wac_RCb(e.value,"Presence",g,!1)}f=new (wac_La.$$(window.Common.PresenceDataEntryForClients));var h=(new Date).getTime(),k;for(k in c){e={key:k,value:c[k]};var g=e.key,l;if(d)l=d[g],l.Presence=e.value;else{var m;l=(m=new window.Common.PresenceDataEntryForClients,m.Presence=e.value,m.TimeStamp=h,m)}f.W(g,l)}a.os.ua.Xa("UPSR",new wac_rDb(b,f),null);
b?a.os.ua.Xa("PSU",new wac_Ki(b,c),null):(a.PJd||(wac_(4539734,500,50,"Raising first presence update notification for [{0}]",a.Cn),a.PJd=!0,wac_q.hm&&(wac_q.hm.IsCoauthSession=!0)),a.os.ua.Xa("PU",new wac_Ii(c,[],null),null))}}
function wac_CDb(a,b,c,d){var e=null,f=new wac_EDb,g=new wac_xT;wac_(3249505,500,50,"Sending update notification for [{0}]",a.Cn);if(2!==a.Uaa)return a.Dq.YHa(),wac_vT(a.mK,0,2),wac_(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",a.Cn),wac_FDb(g),g;a.gc&&3===b&&20>a.rOc&&(e=a.gc.Qe("WebServiceCall","Send WetContent Update"),a.rOc++);f.ae();wac_yT(g.OMa,1);a.Ap.BM(b,c).done(function(){a.Dq.Rvc();wac_vT(a.mK,0,1);wac_(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",
d,a.Cn);wac_yT(g.Boa,1);f&&(f.gd(),f.eh()>a.Rc.wfc?wac_vT(a.mK,0,4):wac_vT(a.mK,0,5))}).fail(function(b){a.hSa||(a.Dq.YHa(),wac_vT(a.mK,0,3),wac_(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",d,wac_uT(b),a.Cn));wac_yT(g.Boa,2)}).always(function(){e&&e.gd()});return g}
function wac_yDb(a,b,c,d){var e=null,f=new wac_EDb,g=new wac_xT;wac_(3249501,500,50,"Sending presence update for [{0}]",a.Cn);if(2!==a.Uaa)return a.Dq.YHa(),wac_vT(a.mK,1,2),wac_(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",a.Cn),wac_FDb(g),g;a.gc&&20>a.pOc&&(e=a.gc.Qe("WebServiceCall","Send Presence Message"),a.pOc++);f.ae();wac_yT(g.OMa,1);a.Ap.Ap.invoke("UpdatePersistentState",b,c).done(function(){a.Dq.Rvc();wac_vT(a.mK,1,1);wac_(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",
d,a.Cn);wac_yT(g.Boa,1);f&&(f.gd(),f.eh()>a.Rc.wfc?wac_vT(a.mK,1,4):wac_vT(a.mK,1,5))}).fail(function(b){a.hSa||(a.Dq.YHa(),wac_vT(a.mK,1,3),wac_(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",d,wac_uT(b),a.Cn));wac_yT(g.Boa,2)}).always(function(){e&&e.gd()});return g}
function wac_vDb(a,b,c){try{a.Ap.Ap.invoke("GetCompletePersistentStateWithMetadata",b).done(function(d){if(c.Agc(c.qDb,"GetCompletePresenceSuccess")){wac_DCb(c.L8c);wac_(3249540,500,50,"Successfully retrieved complete session state for [{0}]",a.Cn);a.os.ua.Xa("RMID",null,null);var e={},f;for(f in d){var g={key:f,value:d[f]};e[g.key]=g.value.Presence}wac_DDb(a,b,e,d);a.os.ua.Xa("CPSWM",new wac_uDb(d),null);c.Hcc.gb(b)&&(d=c.Hcc.B(b),e=new (wac_$a.$$(Object)),a.os.ua.Xa("SP",new wac_7Cb(b,d,e),null))}}).fail(function(b){c.Agc(c.qDb,
"GetCompletePresenceFail")&&(wac_(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",wac_uT(b),a.Cn),wac_zCb(a.os,null))}).always(function(){c.nEa&&c.nEa.gd()})}catch(d){wac_(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",c.qDb,d.message)}}
function wac_wDb(a){var b;try{b=wac_Ti(a)}catch(c){throw a=String.format("Failed to JSON-serialize payload : {0}",c),wac_(18637072,500,10,a),Error.argument("payload",a);}if(8E3<b.length)throw a=String.format("Payload exceeds maximum length: {0} > {1} : {2}",b.length,8E3,b),wac_(18637074,500,10,a),Error.argument("payload",a);return b}
function wac_RCb(a,b,c,d){if(!a)return null;if(Object.getType(a)!==String){var e;if(d)try{e=wac_wDb(a)}catch(f){e=String.format("Failed to JSON serialize the object with exception [{0}]",f)}else e="not allowed to log the object";a=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}]. Object: [{3}].",b,Object.getType(a).getName(),c,e);wac_(18637075,500,10,a);return null}e=null;try{e=wac_Bi(a)}catch(f){a=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}]. Object: [{3}]",
b,f,c,d?a:"not allowed to log the object"),wac_(18637077,500,10,a)}return e}function wac_uT(a){if(!a)return"";if(String.isInstanceOfType(a))return a.toString();try{return wac_Ti(a)}catch(b){return a.toString()}}function wac_EDb(){}wac_EDb.prototype={Fh:null,gUc:null,eh:function(){return this.Fh?this.gUc?this.gUc.getTime()-this.Fh.getTime():(new Date).getTime()-this.Fh.getTime():0},ae:function(){this.Fh=new Date},gd:function(){this.gUc=new Date}};
function wac_xT(){this.OMa=new (wac_zT.$$(wac_g.rqc));this.Boa=new (wac_zT.$$(wac_g.pqc))}wac_xT.prototype={OMa:null,Boa:null};function wac_FDb(a){wac_yT(a.OMa,2);wac_yT(a.Boa,2)}function wac_BDb(a,b){a.Boa.Jka(b)}function wac_ADb(a,b){a.OMa.Jka(b)}function wac_zT(){this.fyd=this.Kb["AppRealtimeChannel.CompletionTask$1"].T===Number||Type.isEnum(this.Kb["AppRealtimeChannel.CompletionTask$1"].T)?0:this.Kb["AppRealtimeChannel.CompletionTask$1"].T===Boolean?!1:null}
wac_zT.$$=function(a){var b=wac_Rn.__tc=wac_Rn.__tc||{},c="CompletionTask$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_zT.apply(this,a)};d.registerClass("AppRealtimeChannel.__tc."+c);d.prototype.Kb={"AppRealtimeChannel.CompletionTask$1":{T:a},ctor:wac_zT};a=wac_zT.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};
wac_zT.prototype={Jka:function(a){this.Wra=a;wac_GDb(this)},NDc:!1,Twd:!1,Wra:null};function wac_GDb(a){a.NDc&&a.Wra&&!a.Twd&&(a.Twd=!0,a.Wra(a.fyd))}function wac_yT(a,b){a.NDc||(a.NDc=!0,a.fyd=b,wac_GDb(a))}function wac_xDb(a,b){this.DQd=a;this.Lve=b}wac_xDb.prototype={BX:function(){return this.DQd()},Lve:null,DQd:null};function wac_HDb(a,b){this.NSc=a;this.fgc=b;this.kEa=wac_IDb;this.hBa=this.txb=this.iob=0}function wac_IDb(a,b){return window.setTimeout(a,b)}
wac_HDb.prototype={hBa:0,txb:0,iob:0,NSc:null,$ya:!1,H4b:null,T5a:null,i2a:!1,fgc:null,kEa:null};function wac_JDb(a,b){a.$ya=!1;a.T5a&&b&&(a.iob++,wac_FDb(a.T5a));a.H4b=null;a.T5a=null}function wac_KDb(a,b,c){a.txb++;wac_JDb(a,!0);a.$ya=!0;a.H4b=b;a.T5a=c}
function wac_LDb(a){0<a.hBa&&0<a.iob&&wac_(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",a.fgc,a.iob,a.hBa);0<a.hBa&&0<a.txb&&wac_(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",a.fgc,a.txb,a.hBa)}function wac_MDb(a,b){this.Cpe=Function.createDelegate(this,this.e7e);wac_MDb.initializeBase(this,[a,b]);this.z2a=(new Date(0)).getTime();this.occ=function(){return(new Date).getTime()}}
wac_MDb.prototype={tec:0,z2a:0,occ:null,kb:function(a){this.i2a||(this.tec=a,this.i2a=!0)},U:function(a){this.i2a||this.kb(200);this.hBa++;var b=this.occ(),c=new wac_xT;this.z2a>b&&(this.z2a=b);this.$ya?(wac_JDb(this,!0),wac_KDb(this,a,c)):this.z2a+this.tec<=b?this.Zib(a,c):(wac_KDb(this,a,c),this.kEa(this.Cpe,this.z2a+this.tec-b));return c},e7e:function(){if(this.$ya){var a=this.H4b,b=this.T5a;wac_JDb(this,!1);this.Zib(a,b)}},Zib:function(a,b){this.z2a=this.occ();a=this.NSc(a);wac_ADb(a,function(a){wac_yT(b.OMa,
a)});wac_BDb(a,function(a){wac_yT(b.Boa,a)})}};function wac_NDb(a,b){this.Dpe=Function.createDelegate(this,this.f7e);this.ege=Function.createDelegate(this,this.RWe);this.ua=new wac_df;wac_NDb.initializeBase(this,[a,b]);this.gtb=0;this.yxb=[];this.VCa=wac_ODb}function wac_ODb(a){window.clearTimeout(a)}
wac_NDb.prototype={Xsd:0,pec:0,VCa:null,gtb:0,yxb:null,h2a:!1,aVc:0,GUb:0,$Ub:0,U:function(a){this.i2a||this.kb(15E3,5);this.hBa++;var b=new wac_xT;this.$ya?wac_KDb(this,a,b):this.gtb<this.pec?this.Zib(a,b):(wac_KDb(this,a,b),this.h2a=!1);return b},Zib:function(a,b){a=this.NSc(a);var c=this.kEa(this.ege,this.Xsd);++this.gtb;Array.add(this.yxb,c);var d=this.GUb;wac_ADb(a,function(a){wac_yT(b.OMa,a)});var e=this;wac_BDb(a,function(a){e.GUb===d&&(e.GUb===d&&(--e.gtb,e.VCa(c),Array.remove(e.yxb,c),e.$ya&&
e.$ya&&!e.h2a&&(e.aVc=e.kEa(e.Dpe,0),e.h2a=!0)),wac_yT(b.Boa,a))})},f7e:function(){this.h2a=!1;if(this.$ya){var a=this.H4b,b=this.T5a;wac_JDb(this,!1);this.Zib(a,b)}},RWe:function(){++this.$Ub;var a=Math.floor(this.pec/2);this.$Ub>a&&(this.$Ub=-1E9,this.ua.Xa("TMUDM",null,null))},m6b:function(a){this.ua.fb("TMUDM",a)},Nc:function(){this.hBa=this.txb=this.iob=this.$Ub=0;++this.GUb;for(var a=this.yxb,b=a.length,c=0;c<b;++c)this.VCa(a[c]);this.gtb=0;this.yxb=[];wac_JDb(this,!0);this.h2a&&(this.VCa(this.aVc),
this.aVc=0,this.h2a=!1)},kb:function(a,b){this.i2a||(this.Xsd=a,this.pec=b,this.i2a=!0)}};function wac_hDb(){}wac_hDb.prototype={};function wac_PDb(a,b){return new wac_MDb(a,b)}function wac_QDb(a,b){return new wac_NDb(a,b)}function wac_lDb(a){this.ua=new wac_df;this.M_b=new (wac_La.$$(wac_uCb));this.K_b=new (wac_La.$$(wac_vCb));this.dhf=a;this.f1a=wac_QDb(function(a){return a.BX()},"GlobalMaxOustandingThrottler");var b=this;this.f1a.m6b(function(){b.ua.Xa("TMUDM",null,null)})}
wac_lDb.prototype={dhf:null,M_b:null,K_b:null,f1a:null,Rc:null,gx:!1,kb:function(a){this.gx||(this.Rc=a,this.f1a.kb(this.Rc.ggc,this.Rc.L9c),this.gx=!0)},Nc:function(){for(var a=this.M_b.GetEnumerator();a.$$mn();){var b=a.$$cu();wac_LDb(b.pa())}for(a=this.K_b.GetEnumerator();a.$$mn();)b=a.$$cu(),wac_LDb(b.pa()),b.pa().Nc();wac_LDb(this.f1a);this.f1a.Nc()},m6b:function(a){this.ua.fb("TMUDM",a)}};
function wac_zDb(a,b){a.gx||a.kb(new wac_WCb(200,15E3,5,1E3));var c,d,e;if(e=a.M_b.mc(b,d={val:c}),c=d.val,!e){var f,g,h;(h=a.K_b.mc(b,g={val:f}),f=g.val,h)||(f="MaxOutstandingThrottler-"+b,c=a.f1a,f=wac_QDb(c.T8b||(c.T8b=Function.createDelegate(c,c.U)),f),f.kb(a.Rc.ggc,a.Rc.rad),f.m6b(function(){a.ua.Xa("TMUDM",null,null)}),a.K_b.U(b,f));c="MaxRateThrottler-"+b;c=wac_PDb(f.T8b||(f.T8b=Function.createDelegate(f,f.U)),c);c.kb(a.Rc.Aad);a.M_b.U(b,c)}return c}
function wac_WCb(a,b,c,d){this.Aad=a;this.ggc=b;this.rad=c;this.L9c=d}wac_WCb.prototype={Aad:0,ggc:0,rad:0,L9c:0};wac_yCb.registerClass("AppRealtimeChannel.ARtcMessageHandler");wac_ACb.registerClass("AppRealtimeChannel.ConnectedUsageKpiLogger",null,wac_iCb);wac_FCb.registerClass("AppRealtimeChannel.FindSessionResponse");wac_GCb.registerClass("AppRealtimeChannel.FindSessionStrategy",null,wac_kCb);wac_YCb.registerClass("AppRealtimeChannel.FrequentLoggingMetrics",null,wac_jCb);
wac__Cb.registerClass("AppRealtimeChannel.RealtimeChannel",null,wac_lCb,wac_vc);wac_0Cb.registerClass("AppRealtimeChannel.RealtimeChannel.PresenceData");(function(){}).registerClass("AppRealtimeChannel.RealtimeChannel.RealtimeChannelFactory");wac_oDb.registerClass("AppRealtimeChannel.RealtimeChannelMetrics",null,wac_mCb,wac_Qc);wac_gDb.registerClass("AppRealtimeChannel.NoopRealtimeChannelMetrics",null,wac_mCb,wac_Qc);wac_mDb.registerClass("AppRealtimeChannel.RealtimeChannelProxy",null,wac_nCb,wac_oCb);
wac_qDb.registerClass("AppRealtimeChannel.RealtimeChannelSettings",null,wac_qCb);wac_jDb.registerClass("AppRealtimeChannel.RtcEventHub",null,wac_pCb);wac_7Cb.registerClass("AppRealtimeChannel.SendPersistentStateEventArgs",Sys.EventArgs);wac_8Cb.registerClass("AppRealtimeChannel.SendUpdateNotificationEventArgs",Sys.EventArgs);wac_bDb.registerClass("AppRealtimeChannel.RefreshProxyEventArgs",Sys.EventArgs);wac_9Cb.registerClass("AppRealtimeChannel.RefreshAllPersistentStateEventArgs",Sys.EventArgs);
wac_rDb.registerClass("AppRealtimeChannel.UpdatePersistentStateRequestEventArgs",Sys.EventArgs);wac_sDb.registerClass("AppRealtimeChannel.UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs);wac_tDb.registerClass("AppRealtimeChannel.RefreshConnectionReconnectArgs",Sys.EventArgs);wac_JCb.registerClass("AppRealtimeChannel.SessionPropertiesChangedEventArgs",Sys.EventArgs);wac_PCb.registerClass("AppRealtimeChannel.RtcConnectFailedEventArgs",Sys.EventArgs);
wac_uDb.registerClass("AppRealtimeChannel.GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs);wac_kDb.registerClass("AppRealtimeChannel.RtcMessageHandler",wac_yCb);(function(){}).registerClass("AppRealtimeChannel.RtcUtils");wac_EDb.registerClass("AppRealtimeChannel.SimpleStopwatch");wac_xT.registerClass("AppRealtimeChannel.MessageStatus",null,wac_rCb);wac_xDb.registerClass("AppRealtimeChannel.MessageHandler",null,wac_sCb);wac_HDb.registerClass("AppRealtimeChannel.ThrottlerBase");
wac_MDb.registerClass("AppRealtimeChannel.MaxRateThrottler",wac_HDb,wac_uCb,wac_tCb);wac_NDb.registerClass("AppRealtimeChannel.MaxOutstandingThrottler",wac_HDb,wac_vCb,wac_tCb);wac_hDb.registerClass("AppRealtimeChannel.ThrottlerFactory",null,wac_wCb);wac_lDb.registerClass("AppRealtimeChannel.ThrottlerManager",null,wac_xCb);wac_WCb.registerClass("AppRealtimeChannel.ThrottlerManagerSettings");var wac_wT=null,wac_pDb=null,wac_iDb=null;Type.registerNamespace("RealtimePresenceUI");
function wac_RDb(a,b,c,d){this.nke=Function.createDelegate(this,this.P0e);this.Ste=Function.createDelegate(this,this.dcf);this.xke=Function.createDelegate(this,this.a1e);this.v0d=Function.createDelegate(this,this.yAe);this.w0d=Function.createDelegate(this,this.zAe);this.Wme=Function.createDelegate(this,this.J3e);this.iae=Function.createDelegate(this,this.ROe);this.Tte=Function.createDelegate(this,this.ecf);this.yke=Function.createDelegate(this,this.b1e);this.Xme=Function.createDelegate(this,this.K3e);
wac_RDb.initializeBase(this,[a,c,d,null]);this.iea=function(){return!0};this.fa=b}
wac_RDb.prototype={iea:null,fa:null,K3e:function(a){if(this.vZb){this.JEb||(a[wac_AT.Visible]=!0);var b,c,d,e,f,g=b={val:b},h=c={val:c},k=d={val:d},l=e={val:e},m=f={val:f},n,p,q,r;2<=this.OX.R1.ja()?r=[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.OX.R1.ja())]:1===this.OX.R1.ja()?(n=wac_fCb(this.OX)[0],r=(p=this.en.nSa(n.Lf()))&&2===p.Oc?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,n.gp]:[n.ot?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,
n.gp]):r=[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself];this.OX.R1.ja()?1===this.OX.R1.ja()?(n=!0,p=this.en.hZc().C9a,q=wac_fCb(this.OX)[0].gO()):(n=!0,p=this.en.RYc().C9a,q=""):(n=!1,q=p="");g.val=r[0];h.val=r.slice(1);k.val=n;l.val=p;m.val=q;b=b.val;c=c.val;d=d.val;e=e.val;f=f.val;a[wac_AT.LabelText]=b;c&&c.length&&(a[wac_AT.LabelTextUserGeneratedPlaceholderReplacements]=c);a.ImageIsVisible=d;a[wac_AT.Image16by16Class]=e;a.ImageBackColor=f;this.vZb=!1}return!0},b1e:function(a){if(0>=this.OX.R1.ja())a=
!1;else{var b=wac_fCb(this.OX),c=[];Array.addRange(c,b);c.sort(wac_2Bb);for(var b=[],d=c.length,e=0;e<d;++e){var f=c[e],g=String.format("buttonPeoplesWellUser-{0}",f.Lf()),h=f.Lf(),k=wac_9Bb(this,f),l=f.gp,m=f.gO(),n=void 0,g=(n=new wac_2m,n.Id=g,n.Command=this.en.Rc.Xac.toString(),n.LabelText="{0}",n.Image32by32=this.en.y7b().Ubc,n.Image32by32Class=this.en.y7b().C9a,n.MenuItemId=h,n.CommandValueId=h,n.Alt=l,n.DisplayMode=wac_7Bb(),n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",
n.Description=k,n.ImageBackColor=m,n.IsAnonymous=f.Nq,n.LabelTextUserGeneratedPlaceholderReplacements=wac_SDb([l]),n.Upn=f.sn,n);wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&this.JXa&&(n=this.JXa.ddb(f.sn,"O365",wac_q.xk,0),h=this.en.nSa(f.Lf()),h=!h||h&&1===h.Oc?!0:!1,g.ImageUrl=n,g.ActiveStatus=h,g.JoinTimeInMS=f.x5,h=wac_3Bb(this,f.Lf(),this.en.eEb(f.Lf()),!1),f=this.TJa?this.TJa.Uhd(f.Lf()):f.ir.UW(4),g.CanJump=h,g.ChatCapable=f,""===n&&wac_(40969413,302,50,"ImageURL collection failed"));
Array.add(b,g)}var p,c=(p=new wac_Hf,p.Id="menuCoauthors",p.MaxWidth="220px",p.MenuSectionList=[],p),q;p=(q=new wac_Of,q.Id="msCoauthors",q.ControlsId="msCoauthorsControls",q.DisplayMode=wac_7Bb(),q.ControlList=b,q);wac_s(wac_q.Z,"WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.JXa&&(p.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,p.TitleId="menuCoauthorsTitle",p.Theme="Light");Array.add(c.MenuSectionList,p);if(wac_s(wac_q.Z,"DocChatIsEnabled")&&wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&
wac_t()&&wac__g().pd()){q=[];Array.add(q,wac_8Bb());var r;q=(r=new wac_Of,r.Id="msGroupChat",r.ControlsId="msGroupChatControl",r.ControlList=q,r);Array.add(c.MenuSectionList,q)}wac_t()&&wac__g().pd()?a.MenuItems=c:a.PopulationXML=wac_gn(c);a=!0}return a},ecf:function(a){return this.Zzc(a)},aka:function(a,b,c,d,e,f,g){a=!1;switch(c){case 1:a=f(e);break;case 2:a=g(e)}return a?32:8},ROe:function(a,b,c,d,e){var f=this;return this.aka(a,b,c,d,e,function(){return f.TLb()},this.iea)},J3e:function(a,b,c,
d,e){return this.aka(a,b,c,d,e,this.Xme,this.iea)},a1e:function(a,b,c,d,e){return this.aka(a,b,c,d,e,this.iea,this.yke)},zAe:function(a,b,c,d,e){return this.aka(a,b,c,d,e,this.iea,this.iea)},yAe:function(a,b,c,d,e){return this.aka(a,b,c,d,e,this.iea,this.iea)},dcf:function(a,b,c,d,e){return this.aka(a,b,c,d,e,this.iea,this.Tte)},P0e:function(a,b,c,d,e){var f=this;return this.aka(a,b,c,d,e,this.iea,function(){wac_0Bb(f);return!0})},ka:function(){wac__Bb.prototype.ka.call(this)}};
wac_RDb.registerClass("RealtimePresenceUI.ABox4PeoplesWell",wac__Bb);Type.registerNamespace("BPr");function wac_TDb(){}wac_TDb.registerInterface("BPr.IMyPresenceUser");window.BPr.SerializablePresenceData=function(a,b){this.ip=a;this.user=b};window.BPr.SerializablePresenceIpData=function(a,b,c,d,e){this.paragraphId=a;this.cp=b;this.length=c;this.shapeId=d;this.dryDeletion=e};
function wac_UDb(a,b,c,d,e,f,g,h){this.sie=Function.createDelegate(this,this.yZe);this.ape=Function.createDelegate(this,this.e6e);this.Wbd=a;this.zXb=b;this.Lxd=c;this.MTd=e;this.DAd=f;this.JJc=g;this.p9=d;this.xsd=h;this.Wbd.U3(this.ape)}
wac_UDb.prototype={Wbd:null,xsd:null,zXb:null,Lxd:null,MTd:!1,DAd:0,JJc:null,p9:null,e6e:function(a,b){b.wg||(this.JJc.Be("CU"),a=this.Lxd,a=(a.UA?a.UA.nw:0)>=this.DAd,this.MTd&&a?(a=this.zXb())?(a.dEc=!0,b=a.IK.Qaa,wac_yWa(a.IK,a.hPd),b&&this.JJc.Be("PI")):wac_(19682513,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt."):this.uu())},uu:function(){var a=this.zXb();if(!a)wac_(19682514,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt.");
else if(!this.p9()&&!a.cV.GO){var b=-1;wac_2F.isInstanceOfType(a)&&(b=a.Ze.Jib());var c=this.xsd.Qe("Task","ShoulderTapInboundReplicationTimer");a.uu(this.sie,null,new wac_VDb(b,c,a.yp))}},yZe:function(a){var b=window.$$as(wac_VDb,a);if(b){a=b.kkd.eh().toString();var c=this.zXb(),d=c.yp,e="";if(d!==b.Cpc)if(wac_(19964236,500,50,"Time saved due to force inbound on update notification message = {0} ms",b.Gqd.toString()),b=b.Cpc,e=new Sys.StringBuilder,c=wac_Wv(wac_wv(c.Pf().ed()),d)){for(e.append(c.ha().Dz);d!==
b;){e.append(", ");e.append(d.Dz);c=c.kk;if(!c)break;d=c.ha()}e=e.toString()}else wac_(19964238,500,10,"The revision we got from the last replicator revisionId was null - {0}",{lastRevisionId:d}),e="";wac_(19964237,500,50,"Revisions: {0}, InboundDuration: {1}",e,a)}else wac_(19964235,500,10,"The callback data was null")}};function wac_BT(){wac_BT.initializeBase(this)}wac_BT.prototype={gec:null,zTa:null};
function wac_WDb(a){var b=wac_q.Vw,c=wac_q.Z.Pa.UserPrincipalName,d=a.gec?a.gec.MA:null,e=wac_q.Kwa||wac_q.gX,f;a.zTa?(f=a.zTa,f=f.lD.Xo()&&f.lD.Nb()?f.lD.Nb().I6b().toString():"0"):f=null;return new wac_CT(a.lk,b,a.xs,a.ir,d,a.zL,c,a.WCa,a.YV,e,a.tsa,a.ot,f)}function wac_XDb(a,b,c,d){this.J4=Function.createDelegate(this,this.x7);this.B4c=Function.createDelegate(this,this.RXe);this.dispose=this.ka;this.Wk=d;this.sa=b;this.vVb=a;this.Gi=c;wac_YDb(this.Wk,this)}
wac_XDb.prototype={sa:null,vVb:null,L_a:null,BKc:!1,Gi:null,Wk:null,_started:!1,APa:null,ae:function(){this._started||(this._started=!0,this.APa={},this.vVb.fb("PPC",this.B4c),wac_VB(this.sa,this.J4),wac_ZDb(this,this.sa.nb()))},gd:function(){this._started&&(this._started=!1,this.APa=null,this.vVb.fd("PPC",this.B4c),wac_NF(this.sa,this.J4))},x7:function(a,b){if(!wac_q.Og&&(a=wac_ZDb(this,b.el),this.L_a&&a)){a=wac__Db(this.vVb,this.L_a.toString(),-1,-1,!0);for(b=0;b<a.length;b++)this.APa[a[b].Te.Lf()]=
a[b];if(!(0>=a.length)){if(1===a.length)a=String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphSingle,a[0].Te.gp);else{b=[];for(var c=a.length,d=0;d<c;d++)Array.add(b,a[d].Te.gp);a=String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphMany,b.join(Box4Intl.Box4Strings.l_DisplayNameSeparator))}this.Gi.Fy(a,!0)}}},RXe:function(a,b){this.sa.nb()&&!wac_q.Og&&this.BKc&&this.L_a&&this.L_a.Aa(b.pJ)&&(a=null,!b.tEb||b.uC.Te.Lf()in this.APa?b.tEb||(a=String.format(Box4Intl.Box4Strings.l_UserLeavingParagraph,
b.uC.Te.gp),delete this.APa[b.uC.Te.Lf()]):(a=String.format(Box4Intl.Box4Strings.l_UserJoiningParagraph,b.uC.Te.gp),this.APa[b.uC.Te.Lf()]=b.uC),a&&this.Gi.Fy(a,!0))},ka:function(){wac_0Db(this.Wk,this);this.gd()}};function wac_ZDb(a,b){if(!b)return!1;b=b.pb();if(!b)return!1;b=b.Ca();if(!b)return!1;a.BKc=wac_8B(b);b=b.aa.ha();if(b.Aa(a.L_a)||!a.BKc)return!1;a.L_a=b;a.APa={};return!0}function wac_1Db(a,b){wac_1Db.initializeBase(this);this.pJ=a;this.cad=b}wac_1Db.prototype={pJ:null,cad:!1};
function wac_DT(a,b,c,d,e,f,g){wac_DT.resolveInheritance();this.dispose=this.ka;wac_DT.initializeBase(this,[null]);this.al=a;this.lPa=b;this.Vi=c;this.$e=d;this.qQ=e;wac_ET=0;this.nXc=new (wac_La.$$(Boolean));this.f0c=new (wac_La.$$(Boolean));this.In=f;this.xa=g;this.AQ=wac_D(this.xa,"PresenceIpRenderedFloodgateTimeLapseSec",30);this.uR=wac_D(this.xa,"PresenceIpRenderedFloodgateTriggerThreshold",3);this.Pda=0}
function wac_2Db(){wac_3Db||(wac_3Db=!0,wac_(4006594,302,50,"First presence ip rendered on the page"))}wac_DT.prototype={lPa:null,Vi:null,$e:null,Oi:null,hJc:null,qQ:null,Uyd:0,xa:null,AQ:0,uR:0,In:null,Pda:0,H$a:!1,al:null,nXc:null,f0c:null,GS:0};function wac_4Db(a){!a.In||a.Pda>=a.uR||a.In.CW(function(){a.In.Nb().Mp("PresenceIpRendered","PresenceIpRenderedFloodgateEnabled",a.AQ)&&a.Pda++})}
function wac_5Db(a){if(wac_oT.isInstanceOfType(a.Oi)){var b=window.$$as(wac_oT,a.Oi);wac_ET=0<wac_ET?wac_ET+1:b.maa+1;wac_mT(b,wac_ET);a._element.style.zIndex=wac_ET}}function wac_6Db(a){a.Xa("CR",new wac_1Db(a.al.ll().lC(),a.H$a),null)}function wac_FT(){return wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")}function wac_7Db(a,b,c,d,e,f){this.I_a={};this.H_a={};this.xxd={};this.lPa=a;this.Vi=b;this.Nh=c;this.qQ=d;this.In=e;this.xa=f}
wac_7Db.prototype={lPa:null,Vi:null,Nh:null,qQ:null,In:null,xa:null};function wac_GT(a,b,c){wac_GT.initializeBase(this);this.pJ=a;this.uC=b;this.tEb=c}wac_GT.prototype={pJ:null,uC:null,tEb:!1};function wac_HT(){this.$tb={};this.Bma={};wac_HT.initializeBase(this)}
wac_HT.prototype={QBd:!1,OVa:function(a){return a.ll().lC().toString()},Zgc:function(a,b){this.QBd||(this.QBd=!0,wac_(4289312,302,50,"First presence added to data manager"));var c,d;c=d={val:!1};var e=this.Bma[a.Te.Lf()],f=!e||0>=e.length?null:e[e.length-1],e=!!f&&this.OVa(f)===this.OVa(a);c.val=e&&f.ll().fH.Aa(a.ll().fH)&&f.Te.Aa(a.Te);wac_8Db()&&c.val&&f.ll().Qv&&a.ll().Qv&&f.ll().Qv!==a.ll().Qv&&(c.val=!1);d=(c=d.val,e);c&&!b?(d=this.Bma[a.Te.Lf()])&&0<=d.length&&d[d.length-1].ll().WYd(a.ll().uS):
(d||wac_9Db(this,a.Te.Lf()),wac_8Db()&&d&&(b=this.Bma[a.Te.Lf()],!(b=!b||0>=b.length?null:b[b.length-1])||!b.ll().Qv||a.ll().Qv&&a.ll().Qv===b.ll().Qv||(c=b.ll().lC(),this.Xa("PPC",new wac_GT(c,b,!1),null))),b=this.OVa(a),c=a.Te.Lf(),e=this.$tb[b]||[],f=this.Bma[c]||[],f.length>=wac_$Db&&(f=f.splice(-wac_aEb,wac_$Db)),d||Array.add(e,c),Array.add(f,a),this.$tb[b]=e,this.Bma[c]=f,a.ll().lC().Aa(wac_x())||(d=a.ll().lC(),this.Xa("PPC",new wac_GT(d,a,!0),null)))},lmc:function(a){return this.$tb[a]},pKe:function(a){if(!a||
!a.Ca()||!a.Ca().aa)return null;a=a.Ca().aa;a=wac__Db(this,a.ha().toString(),0,0,!0);a=wac_bEb(a);a.sort(function(a,c){return a.gp.localeCompare(c.gp)-wac_Zf});return a}};function wac_bEb(a){if(!a||!a.length)return[];for(var b=[],c=new (wac_Ca.$$(String))(wac_qa()),d=0;d<a.length;d++){var e=a[d].Te;e.Nq&&c.Fb(e.Lf())||!e.Nq&&e.sn&&c.Fb(e.sn)||(b.push(e),c.U(e.Nq?e.Lf():e.sn))}return b}
function wac__Db(a,b,c,d,e){var f=[],g=a.lmc(b);if(!g)return f;for(var h=0;h<g.length;h++){for(var k=g[h],l=a.Bma[k],m=!1,n=l.length-1;0<=n;n--){var p=l[n];if(e){if(p.zaa&&p.ll().lC().Aa(wac_Yl(b))){m=!0;Array.add(f,p);break}}else if(wac_IT.isInstanceOfType(p)?p.ll().uS===c:p.ll().uS===d){m=!0;p.TYd(!0);Array.add(f,p);a.Bma[k]=l.splice(n,l.length);break}}!m&&0<l.length&&l[0].LWd()&&l[0].ll().lC().Aa(wac_Yl(b))&&Array.add(f,l[0])}return f}
function wac_9Db(a,b){var c=a.Bma[b];if(c&&0<c.length){var d=c[0].ll().lC(),e=a.OVa(c[0]);delete a.Bma[b];Array.remove(a.$tb[e],b);d.Aa(wac_x())||a.Xa("PPC",new wac_GT(d,c[0],!1),null)}}function wac_8Db(){return!!wac_q.Z&&wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(wac_q.Z,"ObjectPresenceIsEnabled")}function wac_IT(a,b){this.m9=b;this.Te=a}
wac_IT.prototype={m9:null,ll:function(){return this.m9},gFb:!1,LWd:function(){return this.gFb},TYd:function(a){return this.gFb=a},zaa:!1,qBb:function(a){return this.zaa=a},zia:!1,L8b:function(a){return this.zia=a},Te:null,YYd:function(a){return this.Te=a},$mc:function(){return new window.BPr.SerializablePresenceData(this.m9?this.m9.Vv():null,this.Te.Vv())},yeb:function(){return this.Te.Lf()+(this.m9?this.m9.lC().toString():wac_x().toString())},Aj:function(){var a=!!this.Te&&this.Te.Aj(),b=!this.m9||
this.m9.Aj();return a&&b},Ac:function(){var a=new wac_IT;a.Te=this.Te?this.Te.Ac():null;a.m9=this.m9?this.m9.Ac():null;a.zaa=this.zaa;a.gFb=this.gFb;a.zia=this.zia;return a}};function wac_cEb(a){this.Ka=a}wac_cEb.prototype={Ka:0,We:function(){return this.Ka},Aa:function(a){return a?this.Ka===a.Ka:!1},Ac:function(){return new wac_cEb(this.Ka)}};function wac_JT(a,b,c,d,e){a&&(this.pJ=wac_Yl(a));this.fH=new wac_cEb(b);this.uS=c;this.Qv=d;this.EO=e}
wac_JT.prototype={pJ:null,lC:function(){return this.pJ},fH:null,uS:0,WYd:function(a){return this.uS=a},Qv:0,EO:0,Aj:function(){return 0<=this.fH.We()&&!!this.pJ&&!this.pJ.Aa(wac_x())},Vv:function(){return new window.BPr.SerializablePresenceIpData(this.pJ.toString(),this.fH.We(),this.uS,this.Qv,this.EO)},Ac:function(){var a=new wac_JT;a.pJ=this.pJ;a.fH=this.fH?this.fH.Ac():null;a.uS=this.uS;a.Qv=this.Qv;a.EO=this.EO;return a}};
function wac_dEb(a,b,c,d,e,f,g){this.xCb=Function.createDelegate(this,this.Ftc);this.PG=Function.createDelegate(this,this.w7);wac_dEb.initializeBase(this,[a,b,c,d,e,f,g])}
wac_dEb.prototype={eNd:null,dla:function(a){this.Oi&&this.Oi.dla(a)},c1c:function(a){if(this._element&&this._element.parentNode){var b=wac_eEb(this,a);if(b){var c,d,e,f,g=Sys.UI.DomElement.getBounds(this._element.parentNode),h=this._element.parentNode,k=this.$e.Fa(),l=c={val:c},m=d={val:d},n=e={val:e},p=f={val:f};m.val=b.y;l.val=b.x;n.val=b.height;p.val=b.width;(1<Math.abs(g.width-h.offsetWidth)||1<Math.abs(g.height-h.offsetHeight))&&k&&(m.val=Math.round(m.val/k.Bg),l.val=Math.round(l.val/k.Bg),n.val=
Math.round(n.val/k.Bg),p.val=Math.round(p.val/k.Bg));c=c.val;d=d.val;e=e.val;f=f.val;this._element.style.top=d+"px";this._element.style.left=c+"px";this._element.style.height=e+"px";this._element.style.width=f+"px";b=wac_fEb(this,a);wac_wl(this._element,b);a=wac_gEb(this,a,this.al.ll().Qv);wac_hEb(this,b,f,this.HT(a));this.IIa()}}},Ft:function(a){a&&this._element&&a===this.eNd&&(wac_qd(this._element),this.Oi.dla(this.al.Te.Lf()),wac_6Db(this))},ngd:function(a,b,c){var d=new wac_iEb;if(!c||!b)return d;
b=wac_eEb(this,a);if(!b)return d;d.wwa=b.y;d.hva=b.x;d.Am=b.height;d.jn=b.width;a=this._element&&this._element.parentNode&&wac_jEb(wac_VAb(this._element.parentNode))?wac_jEb(wac_VAb(this._element)):wac_fEb(this,a);d.cQb=a;d.wjb=!0;return d},Xpd:function(a,b,c,d){wac_2Db();this.hJc=a;if(d){var e=wac_gEb(this,a,this.al.ll().Qv);if(!e)return;var f=!this._element;f&&this.fjc(b.ownerDocument);f||!this._element.parentNode?e.appendChild(this._element):this._element.parentNode!==e&&(this._element.parentNode.removeChild(this._element),
e.appendChild(this._element));this.Oi.$S(this.al.Te);this.eNd=b;this.Uyd=a.Bc();this._element.style.borderColor=this.al.Te.gO();this._element.id="ipId_"+this.al.yeb();c.wjb&&(this._element.style.height=c.Am+"px",this._element.style.top=c.wwa+"px",this._element.style.left=c.hva+"px",this._element.style.width=c.jn+"px",wac_wl(this._element,c.cQb),wac_wl(this.Oi.sb(),-1*c.cQb),wac_hEb(this,c.cQb,c.jn,this.HT(e)),this.IIa())}this.H$a=!d;wac_6Db(this)},iZd:function(a){this._element.style.borderColor=this.al.Te.gO();
this._element.id="ipId_"+this.al.yeb();this.c1c(a)},fjc:function(a){this._element=a.createElement("div");this._element.className="WACImgPresenceHighlight";this._element.dir=wac_fh?"rtl":"ltr";this.Oi=this.lPa.ejc(this.$j("div"),!0);this.Oi.$S(this.al.Te);this.Oi.Xd();this.Vi.Na("msospPointerOut",this.Oi.sb(),this.PG);this.Vi.Na("msospPointerDown",this.Oi.sb(),this.xCb);Sys.UI.DomElement.addCssClass(this.Oi.sb(),"WacPresence");this._element.appendChild(this.Oi.sb())},HT:function(a){return Sys.UI.DomElement.containsCssClass(a,
"Selected")},PW:function(a,b){var c=this.qKb(a,b);return c?c.Ig:(a=wac_kEb(a,b))?a.Ia():null},qKb:function(a,b){a=wac_RK(a.Ua(),5);for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e.Ig.Ha(Number,wac_mGa)===b)return e}return null},w7:function(){this.Oi&&(this.Oi.HIa(),this.GS=1);return!1},Ftc:function(a){this.Oi&&3===a.Ne&&(2!==this.GS?(wac_5Db(this),this.IIa()):this.Oi&&(this.Oi.HIa(),this.GS=1));return!1},IIa:function(){for(var a=this.Oi.p7b(),b=a.length,c=0;c<b;++c){var d=a[c];if(d.lk===this.al.Te.Lf()&&
!d.Aa(this.al.Te)){this.Oi.$S(this.al.Te);break}}if(this.al.zia||2===this.GS)this.Oi.iRb(),this.al.L8b(!1),this.al.qBb(!0),this.GS=2;this.al.zaa&&1!==this.GS||(this.Oi.HIa(),this.al.qBb(!0),this.GS=1)}};
function wac_eEb(a,b){var c=a.al.ll();if(!c||!c.Qv)return null;var d=a.PW(b,c.Qv);a=wac_gEb(a,b,c.Qv);if(!d||!a)return null;var e,f;b=e={val:e};c=f={val:f};b.val=wac_8e(wac_4M(d),0,!0);c.val=wac_8e(wac_5M(d),1,!0);e=e.val;f=f.val;c=b=1;d.Da(wac_Is)?(d=d.Ha(Array,wac_Is),b+=wac_8e(d[0],0,!0),c+=wac_8e(d[2],1,!0)):(b+=0<a.offsetWidth?(a.offsetWidth-e)/2:2,c+=0<a.offsetHeight?(a.offsetHeight-f)/2:2);return new Sys.UI.Bounds(Math.round(b),Math.round(c),Math.round(e),Math.round(f))}
function wac_fEb(a,b){a=a.PW(b,a.al.ll().Qv);return wac_UD.U0(a)}function wac_kEb(a,b){a=wac_P(a.Ua());for(var c=a.ab(6);c;){var d=c.Ia().Ha(Number,wac_mGa);if(wac_EC(c)&&d===b)return c;c=a.se(6)}return null}function wac_gEb(a,b,c){if(a=a.qKb(b,c))if(a=a.Pja(b.Wb))return a.sb();return(c=wac_kEb(b,c))?wac_pB(window.$$as(wac_8J,c),b.Bc()).Fc():null}
function wac_hEb(a,b,c,d){var e=wac_fh;a.Oi.sb().style.left="auto";a.Oi.sb().style.top="auto";a.Oi.sb().style.right="auto";a.Oi.sb().style.bottom="auto";d=d?Math.round(10)+6:0;0<=b&&90>b||360===b?(a.Oi.sb().style.top=-10-d+"px",e?a.Oi.sb().style.right=c-10+"px":a.Oi.sb().style.left=c-10+"px"):90<=b&&180>b?(a.Oi.sb().style.left=-10-d+"px",e?a.Oi.sb().style.bottom="-10px":a.Oi.sb().style.top="-10px"):180<=b&&270>b?(a.Oi.sb().style.bottom=-10-d+"px",e?a.Oi.sb().style.left=c-10+"px":a.Oi.sb().style.right=
c-10+"px"):(a.Oi.sb().style.right=-10-d+"px",e?a.Oi.sb().style.top="-10px":a.Oi.sb().style.bottom="-10px")}function wac_jEb(a){return a&&-1<a.indexOf("deg")&&(a=window.parseInt(a.substring(a.indexOf("(")+1,a.indexOf("deg"))),!window.isNaN(a))?a:0}function wac_iEb(){}wac_iEb.prototype={hva:0,wwa:0,jn:0,Am:0,cQb:0,wjb:!1};
function wac_lEb(a,b,c,d,e,f,g){this.xCb=Function.createDelegate(this,this.Ftc);this.PG=Function.createDelegate(this,this.w7);this.eaa=Function.createDelegate(this,this.EHa);wac_lEb.initializeBase(this,[a,b,c,d,e,f,g])}
wac_lEb.prototype={n5a:null,hoa:null,xwb:null,fjc:function(a){this._element=a.createElement("div");this._element.className="PresenceIpPaddingDiv";this._element.dir=wac_fh?"rtl":"ltr";this.Vi.Na("msospPointerOver",this._element,this.eaa);wac_FT()&&(this.Vi.Na("msospPointerOut",this._element,this.PG),this.Vi.Na("msospPointerDown",this._element,this.xCb));this.hoa=this.$j("div");this.hoa.className="presenceIp";wac_FT()||(this.xwb=this.$j("div"),this.xwb.className="PresenceSmallBox",this.hoa.appendChild(this.xwb));
this.Oi=this.lPa.ejc(this.$j("div"),wac_FT());this.Oi.$S(this.al.Te);this.Oi.Xd();Sys.UI.DomElement.addCssClass(this.Oi.sb(),wac_FT()?"WacPresence":"WacPawn");this.hoa.appendChild(this.Oi.sb());this._element.appendChild(this.hoa)},EHa:function(a){!this.Oi||wac_FT()&&!this.Oi.Ykc(a)||(wac_5Db(this),wac_mEb(this,a));this.iZd(this.hJc);return!1},w7:function(){this.Oi&&this.WW();return!1},Ftc:function(a){this.Oi&&3===a.Ne&&(2!==this.GS?(wac_5Db(this),wac_mEb(this,a)):this.WW());return!1},IIa:function(a){for(var b=
this.Oi.p7b(),c=b.length,d=0;d<c;++d){var e=b[d];if(e.lk===this.al.Te.Lf()&&!e.Aa(this.al.Te)){this.Oi.$S(this.al.Te);break}}b=!1;"0xcccccc"===this.al.Te.gO()?(c=this.nXc.mc(this.al.Te.Lf(),b={val:b}),b=b.val,c,b||(this.nXc.W(this.al.Te.Lf(),!0),wac_(17954772,302,50,'{ "ClientID" : "'+this.al.Te.Lf()+'" , "Event" : "RenderGrayPawn"}'))):(c=this.f0c.mc(this.al.Te.Lf(),b={val:b}),b=b.val,c,b||(this.f0c.W(this.al.Te.Lf(),!0),wac_(17954773,302,50,'{ "ClientID" : "'+this.al.Te.Lf()+'" , "Event" : "RenderColoredPawn"}')));
return a||this.al.zia||2===this.GS?(wac_4Db(this),this.Oi.iRb(),this.al.L8b(!1),this.al.qBb(!0),this.GS=2,2E3):this.al.zaa&&1!==this.GS?0:(wac_4Db(this),this.Oi.HIa(),this.al.qBb(!0),this.GS=1,7E3)},WW:function(){if(this.Oi&&this.GS){if(wac_oT.isInstanceOfType(this.Oi)){var a=window.$$as(wac_oT,this.Oi);wac_ET=a.maa;wac_mT(a,a.maa);this._element.style.zIndex=a.maa}this.Oi.Xd();this.GS=0}return!1},c1c:function(a){if(this._element&&this._element.parentNode){var b=wac_nEb(this,a);if(b){a=Sys.UI.DomElement.getBounds(this._element.parentNode);
var c,d,e,b=new Sys.UI.Bounds(b.x-a.x,b.y-a.y,2,b.height),f=this._element.parentNode,g=this.$e.Fa(),h=c={val:c},k=d={val:d},l=e={val:e};k.val=b.y;h.val=b.x;l.val=b.height;(1<Math.abs(a.width-f.offsetWidth)||1<Math.abs(a.height-f.offsetHeight))&&g&&(k.val=Math.round(k.val/g.Bg),h.val=Math.round(h.val/g.Bg),l.val=Math.round(l.val/g.Bg));c=c.val;d=d.val;e=e.val;this._element.style.height=10+e+"px";this._element.style.top=d-5+"px";this._element.style.left=c-5+"px";this.hoa.style.height=Math.max(10,e)+
"px";wac_mEb(this,null)}}},Ft:function(a){a&&this._element&&a===this._element.parentNode&&(wac_qd(this._element),wac_6Db(this))},ngd:function(a,b,c,d){var e=new wac_oEb;if(!c||!b)return e;a=wac_nEb(this,a);if(!a)return e;c=new Sys.UI.Bounds(a.x-b.x,a.y-b.y,2,a.height);b=c.y;a=c.x;c=c.height;var f=this.$e.Fa();d&&f&&(d=f.Bg,b=Math.round(b/d),a=Math.round(a/d),c=Math.round(c/d));e.wwa=b-5;e.hva=a-5;e.Am=10+c;e.Bkd=Math.max(10,c);e.wjb=!0;return e},Xpd:function(a,b,c,d){wac_2Db();this.hJc=a;if(d){var e=
!this._element;e&&this.fjc(b.ownerDocument);e||!this._element.parentNode?b.appendChild(this._element):this._element.parentNode!==b&&(this._element.parentNode.removeChild(this._element),b.appendChild(this._element));this.Uyd=a.Bc();a=this.al.Te.gO();this.hoa.style.borderColor=a;wac_FT()||(this.xwb.style.borderColor=a);this._element.id="ipId_"+this.al.yeb();c.wjb&&(this._element.style.height=c.Am+"px",this._element.style.top=c.wwa+"px",this._element.style.left=c.hva+"px",this.hoa.style.height=c.Bkd+
"px",wac_mEb(this,null))}this.H$a=!d;wac_6Db(this)},ka:function(){this._element&&(this.Ft(this._element.parentNode),this.Vi.yb("msospPointerOver",this._element,this.eaa),wac_FT()&&(this.Vi.yb("msospPointerOut",this._element,this.PG),this.Vi.yb("msospPointerDown",this._element,this.xCb)),wac_Zb(this.Oi),this._element=this.Oi=null)},iZd:function(a){var b=this.al.Te.gO();this.hoa.style.borderColor=b;wac_FT()||(this.xwb.style.borderColor=b);this._element.id="ipId_"+this.al.yeb();this.c1c(a)}};
function wac_nEb(a,b){a=a.al.ll();if(!a)return null;var c;try{var d=a.fH.We();c=wac_Jeb(d,b,0<d,!1,!1,!1)}catch(e){wac_(4301318,302,50,"Could not determine the bounds of IP: isYielding={0} message={1} stack={2}",wac_r().Dr(),e.message,e.stack),c=null}return c}function wac_pEb(a,b){a.n5a=new wac_th(2,1,b,function(){a.n5a=null;a.WW()},56,null,!1);wac_r().xc(a.n5a)}function wac_mEb(a,b){a.n5a&&(wac_r().ff(a.n5a),a.n5a=null);var c=a.IIa(!!b);wac_FT()&&b&&"msospPointerOver"===b.xn||wac_pEb(a,c)}
function wac_oEb(){}wac_oEb.prototype={Bkd:0,hva:0,wwa:0,Am:0,wjb:!1};
function wac_qEb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v,w,x,y,z,A,C){this.L3c=Function.createDelegate(this,this.JVe);this.faa=Function.createDelegate(this,this.IHa);this.D$b=Function.createDelegate(this,this.SXe);this.ake=Function.createDelegate(this,this.r0e);this.gJ=Function.createDelegate(this,this.xP);this.D5c=Function.createDelegate(this,this.y1e);this.dga=Array(5);this.hOd=new (wac_Ca.$$(String))(wac_qa());this.hub={};this.dispose=this.ka;this.Ap=a;this.sa=d;this.ND=e;this.lAa=f;this.Vtb=h;this.aGc=
k;this.dpa=l;this.Ss=c;this.oIc=m;this.wXb=n;this.xXb=p;this.Eud=g;this.wI=q;this.Wh=r;this.vb=t;this.$a=u;this.sxb=y;this.dOa=A;this.UOd=C;this.K1b=w;this.xa=x;this.Ltb=b;this.IB=v;wac_rEb=new (wac_La.$$(Boolean));for(a=0;a<this.Ltb.length;a++)b=this.Ltb[a],b.Ux.xb(this),b.Ux.U(this);this.lAa.fb("PPC",this.D5c);this.Ap.sga(this.gJ);z&&this.Vtb.T3(this.ake);wac_YDb(this.Ap,this)}function wac_sEb(a){return a?a?1===a?1:2===a?2:0:2:0}
wac_qEb.prototype={Ap:null,ND:null,sa:null,lAa:null,Ltb:null,Ss:null,Eud:null,dpa:null,aGc:0,OSc:!1,wXb:null,xXb:null,oIc:null,_started:!1,wI:null,Wh:null,vb:null,$a:null,sxb:!1,Vtb:null,$Vc:!1,dOa:null,K1b:null,vQc:null,xa:null,IB:null,lZb:!1,DRc:!1,UOd:!1,r0e:function(){if(!this.$Vc){var a=this,b=new wac_th(0,1,20,function(){var b=new (wac_e.$$(wac_H)),d=a.dpa.I_a,e;for(e in d){var f={key:e,value:d[e]},f=f.value;f.H$a&&b.U(f.al.ll().lC())}if(wac_tEb(a)){var d=a.dpa.H_a,g;for(g in d)f={key:g,value:d[g]},
e=f.value,e.H$a&&!b.Fb(e.al.ll().lC())&&b.U(e.al.ll().lC())}wac_uEb(a,b,!0);a.$Vc=!1},72,null,!1);this.$a.xc(b);this.$Vc=!0}},JVe:function(){this.OSc&&(this.Yib(),this.OSc=!1)},Yib:function(){if(this.sa.nb()){var a=this.sa.nb().pb();wac_vEb(this,a,!0)}},IHa:function(a,b){a=b.el.pb();wac_vEb(this,a,!1)},Whc:function(a){var b=a.Ca().ta,c=a.Ca().aa.ha();a=this.wXb(a.Ca().aa);return new wac_JT(c.toString(),b,a,0,0)},xP:function(a,b){a=Date.now();var c=b.HS,d;for(d in c){var e=c[d];wac_s(this.xa,"CashTelemetryIsEnabled")&&
this.Kdb(e,new Date,null);e.ll()?wac_wEb(this,e):this.Cib(e.Te.Lf())}d=b.N9a;for(c=0;c<d.length;++c){e=d[c];this.Cib(e);var f=this.dpa.I_a[e];f&&(f.fd("CR",this.D$b),f.ka());wac_tEb(this)&&(f=this.dpa,e=f.H_a[f.xxd[e]],e=!e||e.Oi&&e.Oi.p7b().length?null:e)&&(e.fd("CR",this.D$b),e.ka())}this.sxb||wac_xEb(this);wac_Ji(b,"PresenceManager",Date.now()-a)},Kdb:function(a,b,c){if(this.K1b)if(a&&a.Te&&a.Te.Lf()){var d=a.Te.Lf();if(!this.hOd.Fb(d))if(this.vQc)this.vQc.Kdb(d,b,null,wac_sEb(c||a.Te.WCa)),this.hOd.U(d);
else{var e=this;this.K1b.CW(function(){e.vQc=e.K1b.Nb();e.Kdb(a,b,c)})}}else wac_(42262876,302,15,"invalid presence")},Cib:function(a){wac_9Db(this.lAa,a)},DKb:function(a){if(12!==a.get_type())return new (wac_e.$$(wac_Mx));a=wac__Db(this.lAa,a.ha().toString(),this.wXb(a),this.xXb(a),!1);if(0>=a.length)a=new (wac_e.$$(wac_Mx));else{for(var b=new (wac_e.$$(wac_Mx)),c=0;c<a.length;c++)b.U(wac_yEb(this,a[c]));a=b}return a},SXe:function(a,b){if(b.pJ){a=b.pJ.toString();var c=b.cad;b=this.hub;var d=this.lZb,
e=this.DRc;c&&e||(c?this.dOa.Be("RendersSaved-OutOfView"):(this.dOa.Be("Renders"),e&&this.dOa.Be("RendersDueToScroll"),(c=a in b)&&delete b[a],d&&c&&this.dOa.Be("RendersSaved-ContentUpdate")))}else wac_c(8758481,302,!1,"null paraid")},ka:function(){this.gd();this.lAa.fd("PPC",this.D5c);this.Ap.SQa(this.gJ);wac_0Db(this.Ap,this);for(var a=0;a<this.Ltb.length;a++)this.Ltb[a].Ux.xb(this);wac_0ba([this.Eud,this.Ap]);var b=this.dpa,c=b.I_a,d;for(d in c)a={key:d,value:c[d]},a.value.dispose();d=b.H_a;for(var e in d)a=
{key:e,value:d[e]},a.value.dispose()},y1e:function(a,b){b.pJ&&(a=this.Ss.Ib(b.pJ))&&((wac_IT.isInstanceOfType(b.uC)?this.wXb(a):this.xXb(a))===b.uC.ll().uS?wac_zEb(this,b.pJ):this.dOa.Be("RendersSaved-VersionCheck"),wac_tEb(this)&&b.uC.ll().Qv&&!b.tEb&&(a=b.uC.ll().Qv.toString(),(a=this.dpa.H_a[a])&&a.dla(b.uC.Te.Lf())))},gd:function(){this._started&&(this._started=!1,wac_NF(this.sa,this.faa),this.oIc.z8b(this.L3c))},ae:function(){if(!this._started){this._started=!0;wac_VB(this.sa,this.faa);this.oIc.j6b(this.L3c);
var a=this.Ap.zja();delete a[this.wI.Lf()];this.xP(null,new wac_Ii(a,[],null));this.Yib()}}};function wac_zEb(a,b){b.toString()in a.hub&&a.dOa.Be("RendersSavedByAlreadyPending");a.hub[b.toString()]=null;a.sxb&&!a.lZb&&(b=new wac_th(0,1,200,function(){a.lZb=!1;wac_xEb(a)},70,null,!1),a.$a.xc(b),a.lZb=!0)}
function wac_uEb(a,b,c){if(b.ja()){var d=new (wac_e.$$(wac_9E));for(b=b.$$lge();b.$$mn();){var e=b.$$cu(),f=wac_AEb(a,e);f?d.U(f):wac_BEb(a,e)}if(d.ja()){b=a.vb.Uc(2,0);try{b.Set(a.Wh);for(var g=d.$$lge();g.$$mn();)f=g.$$cu(),d=a,e=f,e.gB(d.Vtb.Bc(),32,!0),e.gB(d.aGc,32,!0);c&&(a.DRc=!0)}finally{b&&b.dispose()}c&&(a.DRc=!1)}}}
function wac_BEb(a,b){b=wac__Db(a.lAa,b.toString(),-1,-1,!0);if(!wac_jn(b)){for(var c=[],d=b.length,e=0;e<d;++e){var f=a.dpa.I_a[b[e].Te.Lf()];f&&Array.add(c,f)}c.length&&a.IB.pa().h1(function(){for(var a=c.length,b=0;b<a;++b){var d=c[b];d._element&&d.Ft(d._element.parentNode)}})}}
function wac_AEb(a,b){b=a.Ss.Ib(b);if(!b)return a.dga[0]||(wac_(4281420,302,50,"Could not find the node in object space"),a.dga[0]=!0),null;if(!wac_U(b))return a.dga[1]||(wac_(4281421,302,50,"Not a paragraph node"),a.dga[1]=!0),null;if(!wac_pB(b,a.Vtb.Bc()))return a.dga[2]||(wac_(4281422,302,50,"No ViewElement found for this node"),a.dga[2]=!0),null;if(!b.wb)return a.dga[3]||(wac_(4281423,302,50,"node is not anchored"),a.dga[3]=!0),null;a.dga[4]||(wac_(4564931,302,50,"Valid paragraph node found for rendering ip"),
a.dga[4]=!0);return b}
function wac_yEb(a,b){var c,d,e=a.dpa,f=c={val:!1},g=!!e.xa&&wac_s(e.xa,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(e.xa,"ObjectPresenceIsEnabled");if(b.ll().Qv&&g){g=b.ll().Qv.toString();e.xxd[b.Te.Lf()]=g;var h=e.H_a[g];h?(h.al=b,f.val=!0,b=h):(f.val=!1,b=e.H_a[g]=new wac_dEb(b,e.lPa,e.Vi,e.Nh,e.qQ,e.In,e.xa))}else g=b.Te.Lf(),(h=e.I_a[g])&&h.al.Te.Aa(b.Te)?(h.al=b,f.val=!0,b=h):(f.val=!1,b=e.I_a[g]=new wac_lEb(b,e.lPa,e.Vi,e.Nh,e.qQ,e.In,e.xa));b=(d=b,c=c.val,d);c||b.fb("CR",a.D$b);return b}
function wac_wEb(a,b){var c=null;b&&b.Te&&(c=b.Te.WCa);b=b.Ac();b.YYd(wac_NAb(a.ND,b.Te.Lf())||b.Te);wac_s(a.xa,"CashTelemetryIsEnabled")&&a.Kdb(b,new Date,c);if(b.Aj()&&!b.Te.aX()){var c=b.Te.Lf(),d,e;e=wac_rEb.mc(c,d={val:!1});d=d.val;e;d||(wac_rEb.W(c,!0),wac_(17954774,302,50,'{ "ClientID" : "'+c+'" , "Event" : "CreateAnonymousGrayPawn"}'));wac_7qa(b.Te,CommonUIStrings.l_AnonymousUserName)}a.lAa.Zgc(b,!1)}
function wac_vEb(a,b,c){if(!a.UOd)if(wac_Pv(a.Ss.Kh)||c)if(b){a:{if(wac_tEb(a)&&wac_XD(b))c=b;else if(c=wac_bB(b,!0,!1,!0),!wac_IB(c)){c=null;break a}c=a.Whc(c)}c?wac_CEb(a.Ap,c):(wac_CEb(a.Ap,null),wac_(4281418,302,50,"Not supported selection context {0}",b.Ca().za))}else wac_CEb(a.Ap,null);else a.OSc=!0}function wac_xEb(a){var b=new (wac_e.$$(wac_H)),c=a.hub,d;for(d in c)b.U(wac_Yl(d));wac_uEb(a,b,!1);a.hub={}}
function wac_tEb(a){return!!a.xa&&wac_s(a.xa,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(a.xa,"ObjectPresenceIsEnabled")}function wac_CT(a,b,c,d,e,f,g,h,k,l,m,n,p){wac_CT.initializeBase(this,[a,b,c,d,f,g,h,k,l,m,n,0,null,0]);this.MA=e;this.N5=p}
wac_CT.prototype={MA:null,Vv:function(){return new window.Box4.Presence.SerializablePresenceUserData(this.lk,this.MA,this.zL,this.YV,this.tsa,this.ir.ir,this.sn,this.ot,this.gp,this.Nq,this.N5)},TVa:function(a){return(a=a.value)?a.Te:null},Ac:function(){return new wac_CT(this.lk,this.gp,this.xs,this.ir.Ac(),this.MA,this.zL,this.sn,this.WCa,this.YV,this.Nq,this.tsa,this.ot,this.N5)}};
function wac_DEb(a,b,c,d,e,f,g,h){this.fha=Function.createDelegate(this,this.Iva);this.I8a=Function.createDelegate(this,this.uOb);this.eha=Function.createDelegate(this,this.Pka);this.gJ=Function.createDelegate(this,this.xP);this.Fra=Function.createDelegate(this,this.uP);this.P2c=Function.createDelegate(this,this.KSe);this.ua=new wac_df;this.dispose=this.ka;this.wI=f;this.wI.lk=a.Lf();this.vg=a;this.dN=b;this.P2=d;this.jCd=e;this.$a=c;this.Yma=new (wac_h.$$(wac_lv))(null);this.a2=g;this.ur=h;if(this.dN){var k=
this;this.dN.CW(function(){wac_2a(k.dN)||wac_1a(k.dN)||wac_WQa(k.dN.Nb(),k.P2c)})}}
wac_DEb.prototype={Yma:null,jCd:null,P2:null,OJd:!1,$a:null,ILc:!1,wI:null,a2:null,IHd:!1,Rqb:!1,ur:null,dN:null,v5b:0,bWc:0,p6a:null,vg:null,VZ:function(){return this.vg.VZ()},sga:function(a){this.ua.fb("PU",a)},SQa:function(a){this.ua.fd("PU",a)},rga:function(a){this.ua.fb("CSC",a)},dBb:function(a){this.ua.fd("CSC",a)},Q6a:function(a){this.ua.fb("PSU",a)},B8b:function(a){this.ua.fd("PSU",a)},l6b:function(a){this.ua.fb("PSC",a)},A8b:function(a){this.ua.fd("PSC",a)},$qd:function(){return null},LPa:function(a){this.vg.LPa(a)},
Lf:function(){return this.vg.Lf()},U3:function(a){this.ua.fb("UN",a)},eBb:function(a){this.ua.fd("UN",a)},kb:function(){this.vg.rga(this.Fra);this.vg.sga(this.gJ);this.vg.Q6a(this.eha);this.vg.l6b(this.I8a);this.vg.U3(this.fha);wac_EEb(this);wac_FEb(this)},IIb:function(){this.ILc||this.vg.IIb()},eVa:function(){this.vg.eVa()},ahd:function(a){var b;a?(b=a.user,b=b.clientId?new wac_CT(b.clientId,b.userName,null,new wac_Cm(wac_yb(b.capabilities)?0:b.capabilities),b.localColbaltSessionId,b.SkypeChatThreadId,
b.email,null,b.chatThreadDiscoveryUri,b.isAnonymous,b.inChat,b.isReadOnly,b.presenceStatus):null,a.ip?(a=a.ip,a=!a.paragraphId||wac_i(a.cp)||wac_i(a.length)?null:new wac_JT(a.paragraphId,a.cp,a.length,0,a.dryDeletion)):a=null,b=new wac_IT(b,a)):b=null;return b},lxc:function(a,b){return(new wac_IT(a,b)).$mc()},uIa:function(a,b){return this.vg.uIa(a,b)},Eua:function(a){return this.vg.Eua(a)},leb:function(){return this.vg.leb()},BM:function(a,b,c){return this.vg.BM(a,b,c)},zja:function(){return wac_GEb(this,
this.vg.zja())},q7a:function(){return this.vg.q7a()},uP:function(a,b){2===b.OL&&this.Yma.Sd(function(a){a.ae();return!0});b.OL||wac_s(this.a2,"SendRTCMessagesWhileDisconnectedIsEnabled")&&!this.ILc||this.Yma.Sd(function(a){a.gd();return!0});this.ua.Xa("CSC",b,null)},xP:function(a,b){if(!this.P2()){a=wac_GEb(this,b.HS);b=wac_HEb(b.N9a);var c=new wac_Ii(a,b,this.ur),d=this;b=new wac_th(0,1,0,function(){d.ua.Xa("PU",c,null)},57,null,!1);this.$a.xc(b)}},Pka:function(a,b){if(!this.P2()){var c={};a=b.HS;
for(var d in a){var e={key:d,value:a[d]};c[e.key.toLowerCase()]=e.value}var f=this;d=new wac_th(0,1,0,function(){f.ua.Xa("PSU",new wac_Ki(b.fc,c),null)},80,null,!1);this.$a.xc(d)}},uOb:function(a,b){if(!this.P2()){a=wac_HEb(b.ORa);var c=new wac_Li(a),d=this;a=new wac_th(0,1,0,function(){d.ua.Xa("PSC",c,null)},81,null,!1);this.$a.xc(a)}},Iva:function(a,b){wac_Gh("Microsoft.Office.Web.SessionSettings.IWacWordUpdateNotificationTaskExperimentSettings");if(this.IHd)wac_IEb(this,b);else{var c=this;a=new wac_th(0,
1,0,function(){wac_IEb(c,b)},58,null,!1);this.$a.xc(a)}},ka:function(){this.Yma=new (wac_h.$$(wac_lv))(null);this.vg.dBb(this.Fra);this.vg.SQa(this.gJ);this.vg.B8b(this.eha);this.vg.A8b(this.I8a);this.vg.eBb(this.fha);if(this.dN){var a=this;this.dN.CW(function(){wac_2a(a.dN)||wac_1a(a.dN)||a.dN.Nb().ua.fd("AmIAloneChanged",a.P2c)})}this.vg.eVa();wac_(4564935,302,50,"Disposing of rtcProxyCompleted")},KSe:function(){wac_EEb(this)},qdb:function(){this.ILc=!0;this.eVa();wac_(4564938,302,50,"DisconnectForever")}};
function wac_EEb(a){var b=!1;a.dN?a.dN.CW(function(){wac_2a(a.dN)||wac_1a(a.dN)||(b=!a.dN.Nb().po);a.vg.VZ()||!b&&!a.jCd()?2!==a.vg.VZ()||b||(a.eVa(),wac_(4564937,302,50,"Disconnecting because there are no other users in the doc")):(a.IIb(),wac_(4564936,302,15,"Connecting because there are other authors in the doc"));!a.OJd&&b&&(wac_(4203466,302,50,"There are other real-time authors in this session"),a.OJd=!0)}):(a.IIb(),wac_(50931285,302,15,"Connecting to rtc on boot"))}
function wac_IEb(a,b){var c=Date.now();a.ua.Xa("UN",b,null);c=Date.now()-c;500<=c&&(a.v5b++,wac_(42563487,302,15,"Update Notification Heuristics: UpdateNotification Type {0} took {1} ms",b.wg,c),0>b.wg||13<=b.wg?wac_(42541602,302,15,"Update Notification Heuristics: UpdateNotification Type out of range {0}",b.wg):a.p6a[b.wg]++);a.bWc++}function wac_HEb(a){for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=a[c].toLowerCase();return b}
function wac_GEb(a,b){var c={},d;for(d in b){var e={key:d,value:b[d]},f=a.ahd(e.value);f&&f.Aj()?c[e.key.toLowerCase()]=f:wac_(4564932,302,50,"No Valid User {0}",wac_Ti(e.value))}return c}function wac_CEb(a,b){b&&b.Aj()&&!a.P2()?a.vg.$qd(a.lxc(wac_WDb(a.wI),b)):wac__a(Object,null)}function wac_0Db(a,b){for(var c=0;c<a.Yma.ia();c++)if(a.Yma.B(c)===b){wac_wb(a.Yma,c);break}}function wac_YDb(a,b){a.Yma.Fb(b,function(a,b){return a===b})||(a.Yma.U(b),2===a.VZ()&&b.ae())}
function wac_FEb(a){a.p6a=Array(12);for(var b=0;12>b;b++)a.p6a[b]=0;a.IHd=a.a2?wac_s(a.a2,"UpdateNotificationTaskExperimentIsEnabled"):!1;wac_Ah(function(){if(!a.Rqb){var b={};b.TC=a.bWc;b.HRC=a.v5b;a.p6a&&0<a.v5b&&(b.TBC=a.p6a);a.bWc=0;a.v5b=0;a.p6a=null;wac_(42541603,302,50,"UpdateNotificationHeuristics: {0}",b);a.Rqb=!0}})}function wac_VDb(a,b,c){this.Gqd=a;this.kkd=b;this.Cpc=c}wac_VDb.prototype={Gqd:0,kkd:null,Cpc:null};window.BPr.SerializablePresenceData.registerClass("BPr.SerializablePresenceData");
window.BPr.SerializablePresenceIpData.registerClass("BPr.SerializablePresenceIpData");wac_UDb.registerClass("BPr.ContentNotificationManager");wac_CT.registerClass("BPr.PresenceUser",wac_Bm,wac_Ec,wac_OHa,wac_Gc);wac_CT.prototype.toString=wac_Bm.prototype.toString;wac_BT.registerClass("BPr.MyPresenceUser",wac_CT,wac_TDb,wac_Gc);wac_BT.prototype.toString=wac_Bm.prototype.toString;wac_XDb.registerClass("BPr.PresenceAccessibilityManager",null,Sys.IDisposable,wac_lv);
wac_1Db.registerClass("BPr.PresenceControlRenderedEventArgs",Sys.EventArgs);wac_DT.registerClass("BPr.APresenceControl",wac_lT,wac_Mx,Sys.IDisposable);wac_7Db.registerClass("BPr.PresenceControlProvider");wac_GT.registerClass("BPr.ParagraphChangedEventArg",Sys.EventArgs);wac_HT.registerClass("BPr.PresenceDataManager",wac_df,wac_0Ka);wac_IT.registerClass("BPr.PresenceInfo",null,wac_hv,wac_7b.$$(wac_hv));wac_cEb.registerClass("BPr.PresenceCp",null,wac_iv,wac_7b.$$(wac_iv));
wac_JT.registerClass("BPr.PresenceIp",null,wac_jv,wac_7b.$$(wac_jv));wac_dEb.registerClass("BPr.PresenceImageControl",wac_DT);wac_iEb.registerClass("BPr.PresenceImageControl.PresenceImageControlStyle",null,wac_hMa);wac_lEb.registerClass("BPr.PresenceIpControl",wac_DT);wac_oEb.registerClass("BPr.PresenceIpControl.PresenceIpControlStyle",null,wac_hMa);wac_qEb.registerClass("BPr.PresenceManager",null,wac_iMa,Sys.IDisposable,wac_lv,wac_Fc,wac_yca);
wac_DEb.registerClass("BPr.RtcProxy",null,wac_NHa,Sys.IDisposable,wac_vc,wac_i6a);wac_VDb.registerClass("BPr.SuccessfulInboundReplicationCallbackData");var wac_3Db=!1,wac_ET=0,wac_$Db=10,wac_aEb=2,wac_rEb=null;Type.registerNamespace("Box4.Presence");wac_K=window.Box4||{};wac_K.Qva=wac_K.Qva||{};function wac_KT(a,b){wac_KT.initializeBase(this);this.KD=a;this.mb=b}
wac_KT.prototype={RLd:!1,mb:null,KD:null,xQc:!1,Zgc:function(a,b){this.mb.Bb(140)&&this.mb.Bb(118)&&wac_IT.isInstanceOfType(a)?this.RLd||(this.RLd=!0,wac_(7866380,302,15,"Presence packet received in old format")):(wac_IT.isInstanceOfType(a)&&(this.xQc=!0),wac_HT.prototype.Zgc.call(this,a,b))},OVa:function(a){return this.xQc?wac_HT.prototype.OVa.call(this,a):a.ll().gt().toString()},lmc:function(a){if(this.xQc)return wac_HT.prototype.lmc.call(this,a);a=this.KD.Ib(wac_Yl(a));if(!a)return null;a=a.oa(Number,
wac_8r,0);return this.$tb[a.toString()]}};Type.registerNamespace("WordEditor.Presence");wac_L=window.WordEditor||{};wac_L.Qva=wac_L.Qva||{};function wac_JEb(a,b,c,d,e,f,g,h,k){this.LocalCobaltSessionId=a;this.SkypeChatThreadId=b;this.ChatThreadDiscoveryUri=c;this.InChat=d;this.Capabilities=e;this.Email=f;this.UserName=g;this.IsAnonymous=h;this.PresenceStatus=k}function wac_KEb(){}wac_KEb.registerInterface("WordEditor.Presence.IWordPresenceIp");function wac_LEb(){}wac_LEb.registerInterface("WordEditor.Presence.IWordPresenceCp");
function wac_MEb(){}wac_MEb.registerInterface("WordEditor.Presence.IPacketIdGenerator");function wac_NEb(){}function wac_OEb(a,b,c){null!=a&&(this.TFA=a);null!=b&&(this.PN=b);null!=c&&(this.TN=c)}function wac_PEb(a,b){null!=a&&(this.PM=a);null!=b&&(this.TM=b)}function wac_QEb(a,b,c,d){null!=a&&(this.PA=a);null!=b&&(this.TA=b);null!=c&&(this.PB=c);null!=d&&(this.TBS=d)}function wac_REb(a,b){a&&(this.SF=a);null!=b&&(this.SL=b)}function wac_SEb(){}wac_SEb.registerInterface("WordEditor.Presence.ISequentialIdGenerator");
function wac_LT(){}wac_LT.registerInterface("WordEditor.Presence.IWordPresenceCpFactory");function wac_MT(a,b,c,d,e,f,g,h,k,l,m,n,p,q){this.p1=a;this.wcb=c;this.gca=d;this.nH=b.toLowerCase();this.yE=e;this.Lwa=p;f&&(this.PX=f);null!=g&&(this.WIa=g);wac_i(h)||(this.Text=h);k&&(this.hUa=k);l&&(this.bNb=l);m&&(this.OIa=m);n&&(this.$jb=n);this.G1=q}wac_MT.prototype={p1:0,Lwa:0,wcb:0,gca:0,nH:null,yE:null,PX:null,hUa:null,bNb:null,OIa:null,WIa:null,Text:null,$jb:null,G1:null};
function wac_TEb(a,b,c){null!=a&&(this.Syc=a);null!=b&&(this.juc=b);null!=c&&(this.JYa=c)}wac_TEb.prototype={Syc:null,juc:null,JYa:null};function wac_UEb(a,b){null!=a&&(this.bod=a);null!=b&&(this.IYa=b)}wac_UEb.prototype={bod:null,IYa:null};function wac_VEb(a,b,c,d){null!=a&&(this.huc=a);null!=b&&(this.Qyc=b);null!=c&&(this.iuc=c);null!=d&&(this.Ryc=d)}wac_VEb.prototype={huc:null,Qyc:null,iuc:null,Ryc:null};function wac_WEb(a,b){a&&(this.Hyc=a);null!=b&&(this.Iyc=b)}wac_WEb.prototype={Hyc:null,Iyc:null};
function wac_XEb(){}function wac_YEb(){}wac_YEb.prototype={V:0};function wac_ZEb(){this.qfa=0}wac_ZEb.prototype={qfa:0};function wac__Eb(a){a.qfa++;4294967295===a.qfa&&(a.qfa=1);return a.qfa}
function wac_0Eb(a,b){b.val="";if("number"!==typeof a.I)return b.val="Invalid PacketId Type",!1;if("number"!==typeof a.O)return b.val="Invalid Operation Type",!1;if("string"!==typeof a.A)return b.val="Invalid ClientId Type",!1;if("object"!==typeof a.AN)return b.val="Invalid Anchor Object Type",!1;if(!a.AN)return b.val="Null AnchorObject",!1;if(!wac_TAb(a.AN)){var c;try{c=wac_Ti(a.AN)}catch(d){c=String.format("Failed to JSON-serialize payload : {0}",d)}8E3<c.length&&(c=String.format("Payload exceeds maximum length: {0} > {1}, not logging",
c.length,8E3));b.val="Invalid AnchorObject: "+c+", Client: "+a.C;return!1}return!a.O&&a.AN.RK?(b.val="Invalid RangeKind:"+a.AN.RK+" for Caret",!1):2===a.O&&("number"!==typeof a.TF||"undefined"!==typeof a.TX&&"string"!==typeof a.TX||1!==a.AN.RK&&a.AN.RK)?(b.val="Invalid TypingData",!1):3!==a.O||"object"===typeof a.AP&&a.AP&&"number"===typeof a.AP.TFA&&"number"===typeof a.AP.PN&&"number"===typeof a.AP.TN&&2===a.AN.RK?6!==a.O||"object"===typeof a.MP&&a.MP&&"number"===typeof a.MP.PM&&"number"===typeof a.MP.TM&&
5===a.AN.RK?4!==a.O||"object"===typeof a.SP&&a.SP&&"number"===typeof a.SP.PA&&"number"===typeof a.SP.TA&&"number"===typeof a.SP.PB&&"number"===typeof a.SP.TBS&&3===a.AN.RK&&(a.AN.PS===a.SP.PA||a.AN.PS===a.SP.PB)?7!==a.O||"object"===typeof a.SPS&&a.SPS&&"string"===typeof a.SPS.SF&&"boolean"===typeof a.SPS.SL?null!=a.ISS&&"number"!==typeof a.ISS?(b.val="invalid StrictlySequentialId",!1):!0:(b.val="Invalid SymbolData",!1):(b.val="Invalid SplitParaData",!1):(b.val="Invalid RemoveParaData",!1):(b.val=
"Invalid AddParaData",!1)}function wac_1Eb(a){var b=a;if("number"===typeof b.V){if(1===b.V)return wac_2Eb(a);wac_(9188758,302,15,"Unsupported Version");return null}for(var c=0,d=null,e=0;e<a.length;e++){var b=a[e],f;a:{for(f=0;f<wac_XEb.Dsd.length;f++)if(b.V===wac_XEb.Dsd[f]){f=!0;break a}f=!1}f&&b.V>c&&(c=b.V,d=a[e])}return 1===c?wac_2Eb(d):null}
function wac_3Eb(a){if(a){var b=new wac_NEb;b.I=a.p1;b.V=1;b.A=a.nH;b.C=a.wcb;b.O=a.gca;b.AN=wac_CAb(a.yE);a.PX&&(b.WD=a.PX);null!=a.WIa&&(b.TF=a.WIa);!wac_i(a.Text)&&0<a.Text.length&&(b.TX=a.Text);a.hUa&&(b.AP=new wac_OEb(a.hUa.Syc,a.hUa.juc,a.hUa.JYa));a.bNb&&(b.MP=new wac_PEb(a.bNb.bod,a.bNb.IYa));a.OIa&&(b.SP=new wac_QEb(a.OIa.huc,a.OIa.Qyc,a.OIa.iuc,a.OIa.Ryc));a.$jb&&(b.SPS=new wac_REb(a.$jb.Hyc,a.$jb.Iyc));b.ISS=a.G1;a=b}else a=null;return a}
function wac_2Eb(a){var b,c,d;if(d=wac_0Eb(a,c={val:b}),b=c.val,!d)return wac_(9188759,302,15,"Failed to parse RTT packet, InvalidFieldInfo {0}",b),null;var e=d=c=b=null,f=null,g=null,h=null,k=null;a.WD&&(b=a.WD);null!=a.TF&&(c=a.TF);wac_i(a.TX)||(d=a.TX);a.AP&&(e=new wac_TEb(a.AP.TFA,a.AP.PN,a.AP.TN));a.MP&&(f=new wac_UEb(a.MP.PM,a.MP.TM));a.SP&&(g=new wac_VEb(a.SP.PA,a.SP.TA,a.SP.PB,a.SP.TBS));a.SPS&&(h=new wac_WEb(a.SPS.SF,a.SPS.SL));null!=a.ISS&&(k=a.ISS);return new wac_MT(a.I,a.A,a.C,a.O,wac_AAb(a.AN),
b,c,d,e,f,g,h,1,k)}function wac_4Eb(){this.Bwb=this.Awb=0}wac_4Eb.prototype={Bwb:0,Awb:0};function wac_5Eb(a,b,c,d,e,f,g,h){wac_5Eb.initializeBase(this,[a,b,c,d,e,f,g,h])}function wac_6Eb(){if(window.Box4.App.va()){var a=window.Box4.App.va().La;a&&(a.S3(wac_7Eb),(a=a.uc())&&(wac_8Eb=a.xe)&&window.Box4.App.r4().CW(wac_9Eb))}}function wac_9Eb(){(wac_$Eb=window.Box4.App.r4().Nb())&&wac_$Eb.Gk()&&(wac_aFb||(wac_aFb=wac_k().K(wac_kv))).xH().CW(wac_bFb)}
function wac_bFb(){if(wac_cFb=(wac_aFb||(wac_aFb=wac_k().K(wac_kv))).xH().Nb()){var a=wac_q.Z,b=wac_s(a,"Box4ThrottleInboundRequests"),a=wac_D(a,"Box4ThrottleInboundsAtUserCount",20),c=new wac_0o(11,1);wac_8Eb.upb=function(){return wac_cFb.q7a()};wac_dFb=wac_dFb||new wac_5Eb(wac_cFb,function(){return wac_8Eb},wac_$Eb,function(){return wac_q.Og},b,a,c,wac_2g(window.Box4.App.va()));wac_dFb.uu()}}function wac_7Eb(a){wac_dFb||(a.$7a(wac_7Eb),wac_6Eb())}
function wac_eFb(a,b,c){this.qfa=a;this.X_=c;this.Te=b}
function wac_fFb(a,b,c,d,e){if(!a||!wac_l(wac_k(),wac_ry).Bb(140)||!b)return null;if(a.gca)return wac_(7685324,302,15,"Presence packet is of unexpected operationType {0}",a.gca),null;var f;if(wac_i(a.PX)){var g=a.nH;f=g?new wac_CT(g,null,null,new wac_Cm(0),null,null,null,a.wcb,null,!1,!1,!1,null):null}else g=a.nH,f=a.PX.Capabilities,f=g?new wac_CT(g,a.PX.UserName,null,new wac_Cm(wac_yb(f)?0:f),a.PX.LocalCobaltSessionId,a.PX.SkypeChatThreadId,a.PX.Email,a.wcb,a.PX.ChatThreadDiscoveryUri,a.PX.IsAnonymous,
a.PX.InChat,!1,a.PX.PresenceStatus):null;g=a.p1;a=a.yE;if(b){var h=window.parseInt(a.Vka);b=new wac_NT(b,h,a.swa,a.xva,c,d,e,a.Ixc)}else b=null;return new wac_eFb(g,f,b)}
wac_eFb.prototype={qfa:0,msb:!1,X_:null,ll:function(){return this.X_},LWd:function(){return this.msb},TYd:function(a){(this.msb=a)&&this.X_.$sc();return a},zaa:!1,qBb:function(a){return this.zaa=a},zia:!1,L8b:function(a){return this.zia=a},Te:null,YYd:function(a){return this.Te=a},$mc:function(){var a;a=wac_gFb;4294967295===a.Awb&&(a.Awb=0);a.Awb++;a=a.Awb;return new wac_MT(this.qfa,this.Te.Lf(),1,0,this.X_?this.X_.Vv():null,new wac_JEb(this.Te.MA,this.Te.zL,this.Te.YV,this.Te.tsa,this.Te.ir.ir,this.Te.sn,
this.Te.gp,this.Te.Nq,this.Te.N5),null,null,null,null,null,null,0,a)},yeb:function(){return this.Te.Lf()+(this.X_?this.X_.lC().toString():wac_x().toString())},Aj:function(){var a=!!this.Te&&this.Te.Aj(),b=!this.X_||this.X_.Aj();return a&&b},Ac:function(){var a=new wac_eFb;a.qfa=this.qfa;a.msb=this.msb;a.Te=this.Te?this.Te.Ac():null;a.X_=this.X_?this.X_.Ac():null;a.zaa=this.zaa;a.zia=this.zia;return a}};function wac_hFb(a,b,c,d,e,f){this.zQc=a;this.Nd=c;this.$Q=d;this.Qs=e;this.Eh=f;this.tta=b}
wac_hFb.prototype={zQc:null,Ka:null,Nd:null,$Q:null,Qs:null,Eh:null,Ac:function(){return new wac_hFb(this.zQc,this.tta.Ac(),this.Nd,this.$Q,this.Qs,this.Eh)},tta:null,We:function(){if(null!=this.Ka)return this.Ka;var a=this.zQc.lC();if(a.Aa(wac_x()))return 0;var b=this.$Q();if(!b)return 0;a=b.Ib(a);if(!a)return wac_(7685326,302,15,"Paragraph Node is null so returning a CP with value 0"),0;b=wac_hT(wac_jT(a.Jb,a.ra),this.tta);if(this.Qs&&this.Eh&&wac_FD(a)){var c=wac_eB(a,b);c.Xb=wac_SVa(this.Eh,a,
b,this.tta.V4);b=wac_aB(0,c,!0)}return b},$sc:function(){null==this.Ka&&(this.Ka=this.We())},Aa:function(a){return a?this.tta.Yv(a.tta,!1):!1}};function wac_iFb(a,b){this.Qs=a;this.Eh=b}wac_iFb.prototype={Qs:null,Eh:null,Ga:function(a,b,c,d){return new wac_hFb(a,b,c,d,this.Qs,this.Eh)}};function wac_NT(a,b,c,d,e,f,g,h){this.St=a;this.$Q=f;this.Nd=e;this.r$=g;this.xf=b;this.Qv=h;this.uS=c;this.fH=g.Ga(this,d,e,f)}
wac_NT.prototype={$Q:null,St:null,g1b:null,Nd:null,r$:null,Ac:function(){return new wac_NT(this.St,this.xf,this.uS,this.fH.tta,this.Nd,this.$Q,this.r$,this.Qv)},xf:0,gt:function(){return this.xf},lC:function(){return this.g1b?this.g1b:wac_TR(this.St,this.xf)},Qv:0,$sc:function(){this.g1b||(this.g1b=this.lC(),this.fH.$sc())},fH:null,uS:0,WYd:function(a){return this.uS=a},Aj:function(){return 0<=this.fH.We()},Vv:function(){var a=this.fH.tta;return a?new wac_iT(0,this.xf,this.uS,a,null,null,null,0,this.Qv):
null}};function wac_OT(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v,w,x,y,z,A,C,B,D,E,F,H){wac_OT.initializeBase(this,[a,b,c,d,e,f,g,h,k,l,n,p,q,r,v,w,x,y,z,A,C,B,D,H]);wac_B(m,1177859183,1,wac_jFb,64);wac_B(m,3460066539,1,wac_kFb,64);wac_B(m,477883041,1,wac_lFb,96);wac_B(m,761503246,1,wac_mFb,64);this.St=t;this.Nd=u;this.r$=E;this.wI.zTa=F;this.wI.zTa.ua.fb("X",wac_nFb);wac_(4006600,302,50,"WordPresenceManager Initialized")}function wac_oFb(){return wac_pFb||(wac_pFb=wac_k().K(wac_kv))}
function wac_qFb(){wac_rFb||(wac_rFb=new (wac_$a.$$(wac_Fc)));wac_sFb&&(wac_(4256585,302,50,"WordPresenceManager Init"),wac_sFb=!1);if(window.Box4.App.va()){var a=window.Box4.App.va().La;a?(a.S3(wac_tFb),(wac_PT=a.ud)&&wac_PT.Yi()?(wac_uFb=a.uc().xe)?(wac_vFb=a.uc().ed())?wac_oFb().xH().CW(wac_wFb):wac_(4006599,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to content ObjectSpace of the app"):wac_(4252228,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to the GraphSpaceReplicator object"):
wac_(4006598,302,50,"PageView doesn't seem to have been initialized yet. Will try again once we know it's initialized")):wac_(4006597,302,15,"Can't initialize the WordPresenceManager because workspace is not initialized")}else wac_(4006596,302,15,"Can't initialize the WordPresenceManager because active AppFrame is not initialized")}
function wac_wFb(){if(wac_xFb=wac_oFb().xH().Nb()){var a=[];Array.add(a,wac_PT.Jec);Array.add(a,wac_PT.oe().WYc());var b=wac_Sy(),c=wac_k().K(wac_KT),d=new wac_XDb(c,b,wac_k().K(wac_Ab),wac_xFb),e=wac_Cb(wac_k(),wac_Yqb),f=wac_k().K(wac_jS),g=new wac_0o(8,5),h=wac_k().K(wac_tc);wac_QT=new wac_OT(wac_xFb,a,wac_vFb,b,h,c,d,wac_PT,wac_PT.oe().Bc(),wac_k().K(wac_7Db),wac_y(),wac_uFb,wac_T,wac_UAb,wac_k().K(wac_BT),e,f,window.Box4.App.Ki.Wl,new wac_bz,wac_r(),wac_5j(),wac_Eb(wac_oo,wac_m(wac_k(),wac_oo)),
wac_q.Z,wac_s(wac_q.Z,"Box4ThrottleAndBatchPresenceRendering"),wac_s(wac_q.Z,"Box4DoNotRenderPresenceOutOfView"),g,wac_k().K(wac_LT),wac_k().K(wac_zca),!window.Box4.App.us()&&!window.Box4.App.Om);wac_(23196878,302,50,"WordPresenceManager instance created");wac_rFb.Me(wac_QT);wac_RT.Me(wac_QT);wac_yFb.Me(wac_QT);a=wac_k();wac_n(wac_o(wac_p(wac_p(a.ma(wac_OT),wac_yca),wac_Fc)),function(){return wac_QT});a.K(wac_OT)}else wac_(4203468,302,15,"Can't initialize the WordPresenceManager because can't get a handle to RtcProxy")}
function wac_tFb(a){wac_QT||(wac_(4006601,302,50,"WordPresenceManager.OnAppIsInteractive: Trying to initialize again"),(a=window.$$as(wac_Nw,a))&&a.$7a(wac_tFb),wac_qFb())}function wac_nFb(){wac_QT.Yib()}function wac_jFb(a,b,c,d,e){c=e.split(",");if(!c||3!==c.length)return 8;a=c[0].trim();b=c[1].trim();c=Number.parseInvariant(c[2].trim());a=new wac_IT(new wac_CT(a),new wac_JT(b,c,-1,0,0));if(!wac_RT.yc.Xo())return 8;b=wac_RT.yc.Nb();wac_wEb(b,a);b.sxb||wac_xEb(b);return 32}
function wac_kFb(a,b,c,d,e){if(!wac_RT.yc.Xo())return 8;a=wac_RT.yc.Nb();a.Cib(e);a.sxb||wac_xEb(a);return 32}
function wac_mFb(a,b,c,d,e){if(!wac_RT.yc.Xo())return 8;a=wac_RT.yc.Nb();if(!a)return 8;if(e&&e.Aj()&&e.ll()){b=wac__Db(a.lAa,e.ll().lC().toString(),-1,-1,!1);c=!1;d=null;for(var f=0;f<b.length;f++)if(d=b[f],d.Te.Lf()===e.Te.Lf()){d.L8b(!0);c=!0;break}if(c)if(b=d.ll().lC(),e=wac_AEb(a,b)){b=a.vb.Uc(2,0);try{wac_Q(b,e),e.gB(a.Vtb.Bc(),32,!0),e.gB(a.aGc,32,!0)}finally{b&&b.dispose()}}else wac_BEb(a,b)}return 32}
function wac_lFb(a,b,c,d,e){if(1===c)return 32;if(!wac_oFb().xH().Xo())return 8;a=wac_oFb().xH().Nb();if(!a)return wac_(4301136,302,10,"rtcProxy is null when trying to display RTC connection status"),8;e.Value=2===a.VZ()?WordEditorIntl.WordEditorStrings.L_RtcConnected:1===a.VZ()?WordEditorIntl.WordEditorStrings.L_RtcConnecting:"";return 32}
wac_OT.prototype={Gg:function(){return wac_k().K(wac_ry)},r$:null,St:null,Nd:null,Qmc:function(a){if(!a||!a.wb)return null;for(a=a.wb.Ul;a;a=a.kr)if(wac_GM(a))return a.Vl.aa;return null},Whc:function(a){var b=null,b=wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(wac_q.Z,"ObjectPresenceIsEnabled");if(this.Gg().Bb(140)&&this.Gg().Bb(118)){var c=a.Ca().ta,d=a.Ca().aa;b&&wac_EC(d)&&(d=this.Qmc(d));if(!d)return wac_(51242309,302,15,"selectedNode is null"),null;var d=this.xXb(d),e=a.Ca().aa.oa(Number,
wac_8r,0);if(!this.St)return wac_(35997152,302,15,"paragraphWordIdMapping is null"),null;var f=wac_TR(this.St.pa(),e),g=wac_vFb.Ib(f);if(!g)return wac_(16791249,302,15,"Can't find pid "+f),null;c=wac_fT(wac_jT(g.Jb,g.ra),c);c.V4=-1===wac_lD(a.Ca())?0:wac_lD(a.Ca());f=0;b&&wac_XD(a)&&(f=wac_zFb(a));b=new wac_NT(this.St.pa(),e,d,c,this.Nd,function(){return wac_vFb},this.r$,f)}else b=wac_qEb.prototype.Whc.call(this,a);return b}};
function wac_zFb(a){var b=wac_YH(a.Ca());return b?b.Ig.oa(Number,wac_mGa,0):a.Ca().aa.Ia().oa(Number,wac_mGa,0)}function wac_AFb(){}function wac_BFb(){!wac_CFb&&window.Box4.App.va()&&window.Box4.App.va().qu&&(wac_CFb=window.WordEditor.App.Wj().qu.getElementsByClassName("OutlineContainerDisplayWrapper")[0]);return wac_CFb}function wac_DFb(){return wac_BFb()?wac_0k(wac_BFb()):null}
wac_AFb.prototype={ea:null,Af:!1,Rb:function(){return"WordEditor.Presence"},kb:function(){wac_(50995799,302,15,"PresencePackage Init");window.Box4.App.AAc&&(this.ea.K(wac_ST).xH(),wac_qFb(),this.ea.K(wac_EFb));window.Box4.App.Tic&&wac_6Eb();this.ea.K(wac_0p);this.ea.K(wac_tc)},ka:function(){if(!this.Af){this.Af=!0;wac_RT.yc.CW(function(){wac_Zb(wac_RT.yc.Nb())});var a=this.ea.K(wac_BT);a&&a.zTa&&a.zTa.ua.fd("X",wac_nFb)}},Sb:function(a){this.ea=a;wac_n(wac_o(wac_p(wac_p(wac_p(this.ea.ma(wac_BT),wac_TDb),
wac_Gc),wac_Ec)),function(){return new wac_BT});wac_n(wac_o(a.ma(wac_LT)),function(){return new wac_iFb(a.K(wac_8E),a.K(wac_dy))});wac_n(wac_o(a.ma(wac_EFb)),function(){return new wac_EFb(new (wac_d.$$(wac_uw))(function(){return window.Box4.App.hc}),wac_2A(),a.K(wac_ST).Leb(),a.K(wac_TDb))});wac_n(wac_p(wac_p(wac_o(a.ma(wac_ST)),wac_kv),wac_fo),function(){return new wac_ST(wac_q.Jr,wac_2g(window.Box4.App.va()),wac_r(),function(){return wac_q.Og},wac_k().K(wac_TDb),wac_l(wac_k(),wac_bG),wac_k().K(wac_jS),
function(){return wac_t()&&window.Box4.App.va().La&&window.Box4.App.va().La.uc()?window.Box4.App.va().La.uc().ed():null},wac_FFb,function(){return wac_l(wac_k(),wac_fR)},wac_m(wac_k(),wac_wc),wac_k().K(wac_LT),wac_q.Z)});wac_n(wac_o(a.ma(wac_7Db)),function(){var a;a=wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled");var c=new wac_YBb;c.U(String,0,wac_Qi(wac_Oi,"MoreUsersGlyph16"));c.U(String,5,wac_Pi);c.U(String,1,wac_Qi(wac_Oi,a?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph16"));c.U(String,
4,wac_Pi);c.U(Number,12,1);c.U(Boolean,8,wac_fh);c.U(Function,16,wac_DFb);a=a?new wac_tBb(c):new wac_VBb(c);return new wac_7Db(a,wac_Hg(),wac_m(wac_k(),wac_Dc),wac_k().K(wac_Zw),wac_Eb(wac_Bc,wac_m(wac_k(),wac_Bc)),wac_q.Z)});wac_n(wac_o(a.ma(wac_0p)),function(){return new wac_0p(wac_k().K(wac_Gc),wac_k().K(wac_ST).Leb(),wac_yFb.yc,wac_k().K(wac_Ec),wac_r(),wac_s(wac_q.Z,"AwayStatusOneMinuteTimeoutIsEnabled")?6E4:wac_D(wac_q.Z,"AwayCoauthorThresholdMs",9E5),wac_y().Vke,window.Box4.App.va().Iw,wac_s(wac_q.Z,
"PeoplesWellExtraButtonInfoIsEnabled"))});wac_n(wac_p(wac_o(a.ma(wac_GFb)),wac_zca),function(){return new wac_GFb(wac_Eb(wac_cc,wac_m(wac_k(),wac_cc)))});wac_n(wac_p(wac_o(a.ma(wac_sya)),wac_tc),function(){return new wac_sya(a.K(wac_ST).Leb(),window.Box4.App.r4().CWR(wac_eca,function(){return window.Box4.App.r4().Nb().UA}),a.K(wac_eb),a.K(wac_Ec),wac_Eb(wac_0p,wac_m(a,wac_0p)))});wac_n(wac_p(wac_o(a.ma(wac_KT)),wac_0Ka),function(){return new wac_KT(window.Box4.App.va().La.uc().ed(),wac_k().K(wac_ry))})}};
function wac_GFb(a){this.ua=new wac_df;this.lD=a;var b=this;this.lD.CWR(Function,function(){return b.lD.Nb().Chf(function(){b.ua.Xa("X",null,null)})})}wac_GFb.prototype={lD:null};function wac_EFb(a,b,c,d){this.gJ=Function.createDelegate(this,this.xP);this.Ahe=Function.createDelegate(this,this.LYe);this.jf=a;this.cA=b;this.Ar=c;c.CW(this.Ahe);this.OKd=d;this.OKd.gec=this.cA}
wac_EFb.prototype={cA:null,Ar:null,Wk:null,OKd:null,YMc:!1,mHc:!1,jf:null,dve:!1,LYe:function(){this.Ar.Xo()&&this.Ar.Nb()?(this.Wk=this.Ar.Nb(),this.Wk.sga(this.gJ),wac_(5604372,302,50,"Presence Update Monitor is ready.")):wac_(5604373,302,15,"RtcTask did not complete successfully. No monitoring")},xP:function(a,b){a=Date.now();var c=b.HS,d;for(d in c){var e=c[d];if(!this.mHc&&this.jf&&this.jf.pa()){var f=e.Te.WCa;f&&1===f||(this.dve=!0)}if(!this.YMc&&e.Te.MA&&e.Te.MA!==this.cA.MA){wac_(5604375,
302,15,"Presence received from different local cobalt session Mine:{0} Theirs:{1}",this.cA.MA,e.Te.MA);this.YMc=!0;break}}this.YMc&&this.Wk.SQa(this.gJ);this.mHc||(wac_(5604374,302,50,"First presence received"),this.mHc=!0);wac_Ji(b,"WordPresenceUpdateMonitor",Date.now()-a)}};function wac_HFb(a,b,c,d,e,f,g,h,k,l,m,n,p,q){wac_HFb.initializeBase(this,[a,b,c,d,e,f,p,q]);this.St=g;this.Nd=h;this.$Q=k;this.Otb=l;this.Pwb=m;this.r$=n}
wac_HFb.prototype={gz:null,St:null,Nd:null,$Q:null,Otb:null,Pwb:null,r$:null,qO:function(){return this.gz||(this.gz=this.Pwb())},uP:function(a,b){2===b.OL&&wac_(4315102,302,50,"RTC Connected");this.qO()&&this.qO().A7("RtcConnectionStatusLabel");wac_DEb.prototype.uP.call(this,a,b)},ahd:function(a){return wac_fFb(wac_1Eb(a),this.St,this.Nd,this.$Q,this.r$)},lxc:function(a,b){return wac_NT.isInstanceOfType(b)?(a=new wac_eFb(wac__Eb(this.Otb),a,b),wac_3Eb(a.$mc())):wac_DEb.prototype.lxc.call(this,a,b)}};
function wac_ST(a,b,c,d,e,f,g,h,k,l,m,n,p){this.Mh=new (wac_$a.$$(wac_NHa));this.NTb=a;this.gc=b;this.$a=c;this.P2=d;this.wI=e;this.St=f;this.yqa=g;this.$Q=h;this.Otb=k;this.Pwb=l;this.zOa=m;this.r$=n;this.xa=p}function wac_IFb(){return!1}wac_ST.prototype={NTb:null,gc:null,$a:null,P2:null,wI:null,St:null,yqa:null,$Q:null,Otb:null,Pwb:null,zOa:null,r$:null,xa:null,RRd:!0,xH:function(){wac_JFb(this);return this.Mh.yc},Leb:function(){return new wac_TT(this)}};
function wac_JFb(a){if(a.RRd)if(a.RRd=!1,window.Box4.App.opc()&&window.Box4.App.dpc()){var b=wac_q.ve;if(b){var b=wac_1Cb("{"+wac_q.Sf+"}",wac_q.Sf,wac_q.wqd,b,a.zOa,a.gc,a.xa.Pa.RtcEndpointUrl,wac_s(a.xa,"FindSessionOnBootIsEnabled")?wac_k().K(wac_$c):null),c=new wac_HFb(b,wac_s(a.xa,"StartRTCOnBootIsEnabled")?null:window.Box4.App.r4(),a.$a,a.P2,wac_IFb,a.wI,a.St,a.yqa,a.$Q,a.Otb,a.Pwb,a.r$,wac_q.Z,wac_md.$$(Number).yJ(22,1,new (wac_2o.$$(Number))(null),!0));window.Box4.App.P7e(c);c.kb();window.WordEditor.App.jla=
c;a.zOa.rb(function(a){a.P6a(function(){c.qdb()})});a.Mh.Me(c)}else wac_(8206365,302,15,"Can't initialize the RtcProxy because ClientRequestManager is null")}else wac_(8206362,302,10,"Can't initialize the RtcProxy because dependent scripts are not loaded")}function wac_TT(a){this.M4=Function.createDelegate(this,this.moveNext);this.dispose=this.ka;this.xj=a;wac_TT.initializeBase(this);this.Jm=this.VA;this.moveNext()}
wac_TT.prototype={xj:null,Tdd:null,It:null,Jm:null,_state:0,VA:function(){this.It=this.xj.xH().G();this.It.Xo()||(this._state=2,this.It.Jka(this.M4));return this.Kia},Kia:function(){this.Tdd=this.It.BJ();wac_9a(this,this.Tdd);this.ka();this._state=3;this.qr(!0)},ka:function(){}};wac_TT.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.Jm=this.Jm()}catch(a){this.ka(),wac_3a(this,a),this._state=3}};wac_TT.prototype.moveNext=wac_TT.prototype.moveNext;
wac_KT.registerClass("Box4.Presence.WordPresenceDataManager",wac_HT);wac_JEb.registerClass("WordEditor.Presence.SerializableWacData");wac_NEb.registerClass("WordEditor.Presence.SerializableRTTDataV1");wac_OEb.registerClass("WordEditor.Presence.SerializableAddParaDataV1");wac_PEb.registerClass("WordEditor.Presence.SerializableMergeRemoveParaDataV1");wac_QEb.registerClass("WordEditor.Presence.SerializableSplitParaDataV1");wac_REb.registerClass("WordEditor.Presence.SerializableSymbolDataV1");wac_MT.registerClass("WordEditor.Presence.RTTData");
wac_TEb.registerClass("WordEditor.Presence.AddParaData");wac_UEb.registerClass("WordEditor.Presence.MergeRemoveParaData");wac_VEb.registerClass("WordEditor.Presence.SplitParaData");wac_WEb.registerClass("WordEditor.Presence.SymbolData");wac_XEb.registerClass("WordEditor.Presence.RTTDataVersion");wac_YEb.registerClass("WordEditor.Presence.SerializableObjectWithVersion");(function(){}).registerClass("WordEditor.Presence.Program");wac_ZEb.registerClass("WordEditor.Presence.PacketIdGenerator",null,wac_MEb);
(function(){}).registerClass("WordEditor.Presence.RTTDataHelper");(function(){}).registerClass("WordEditor.Presence.RTTDataMethods");(function(){}).registerClass("WordEditor.Presence.SerializableRTTDataV1Methods");wac_4Eb.registerClass("WordEditor.Presence.StrictlySequentialIdGenerator",null,wac_SEb);wac_5Eb.registerClass("WordEditor.Presence.WordContentNotificationManager",wac_UDb);wac_eFb.registerClass("WordEditor.Presence.WordPresenceInfo",null,wac_hv,wac_7b.$$(wac_hv));
wac_hFb.registerClass("WordEditor.Presence.WordPresenceCp",null,wac_iv,wac_7b.$$(wac_iv),wac_LEb);wac_iFb.registerClass("WordEditor.Presence.WordPresenceCp.Factory",null,wac_LT);wac_NT.registerClass("WordEditor.Presence.WordPresenceIp",null,wac_jv,wac_7b.$$(wac_jv),wac_KEb);wac_OT.registerClass("WordEditor.Presence.WordPresenceManager",wac_qEb);wac_AFb.registerClass("WordEditor.Presence.WordPresencePackage",null,wac_I,wac_j);
wac_GFb.registerClass("WordEditor.Presence.WordPresenceStatusProvider",null,wac_zca);wac_EFb.registerClass("WordEditor.Presence.WordPresenceUpdateMonitor");wac_HFb.registerClass("WordEditor.Presence.WordRtcProxy",wac_DEb);wac_ST.registerClass("WordEditor.Presence.WordRtcProxyProvider",null,wac_kv,wac_fo);wac_TT.registerClass("WordEditor.Presence.WordRtcProxyProvider.$$sm_WordEditor$Presence$WordRtcProxyProvider$GetInstanceAsRealtimeChannelBasicAsync",wac_8a.$$(wac_vc),Sys.IDisposable);
wac_XEb.Dsd=[1];var wac_FFb=new wac_ZEb,wac_gFb=new wac_4Eb,wac_dFb=null,wac_aFb=null,wac_cFb=null,wac_8Eb=null,wac_$Eb=null,wac_QT=null,wac_sFb=!0,wac_rFb=new (wac_$a.$$(wac_Fc)),wac_RT=new (wac_$a.$$(wac_OT)),wac_yFb=new (wac_$a.$$(wac_yca)),wac_vFb=null,wac_PT=null,wac_uFb=null,wac_xFb=null,wac_pFb=null,wac_CFb=null;wac_J(wac_C(),new wac_AFb,0,!1);Type.registerNamespace("WERTT");function wac_UT(){}wac_UT.registerInterface("WERTT.IParagraphAnchoredOp");function wac_KFb(){}wac_KFb.registerInterface("WERTT.IRttDataStore");
function wac_LFb(){}wac_LFb.registerInterface("WERTT.IRttEditor");function wac_MFb(){}wac_MFb.prototype={unknown:0,replaceTextRangeOp:1,addParagraphOp:2,deleteParagraphOp:3,splitParagraphOp:4,mergeParagraphOp:5,replaceSymbolRangeOp:6};wac_MFb.registerEnum("WERTT.RttOpType",!1);function wac_VT(){}wac_VT.registerInterface("WERTT.IRttOp");function wac_WT(){}wac_WT.registerInterface("WERTT.IRttAppliedOp");function wac_NFb(){}wac_NFb.registerInterface("WERTT.IRttAppliedOpTracker");
function wac_OFb(){}wac_OFb.registerInterface("WERTT.IRttOpValidator");function wac_PFb(){}wac_PFb.registerInterface("WERTT.IRttSendDataStore");function wac_QFb(a,b){this.M3c=Function.createDelegate(this,this.KVe);this.K3c=Function.createDelegate(this,this.uhb);this.J3c=Function.createDelegate(this,this.Zrc);this.dispose=this.ka;this.Ek=a;if(this.Hm=b)a=wac_oC(this.Hm,12),wac_RM(a,this.J3c),wac_vC(a,this.K3c),wac_TM(a,this.M3c)}
wac_QFb.prototype={Ek:null,Hm:null,ka:function(){if(this.Hm){var a=wac_oC(this.Hm,12);wac_QM(a,this.J3c);wac_AC(a,this.K3c);wac_SM(a,this.M3c)}},Zrc:function(a,b){4===this.Ek.dE()?wac_c(9204866,355,12===b.aa.get_type()||11===b.aa.get_type(),"Unexpected graph modification detected during RTT edit"):wac_c(9204867,355,!1,"Unexpected graph modification detected during RTT edit")},uhb:function(){wac_c(9204868,355,!1,"Unexpected graph modification detected during RTT edit")},KVe:function(){wac_c(9204869,
355,!1,"Unexpected graph modification detected during RTT edit")}};function wac_XT(a,b){this.Dec=a;this.qx=b}wac_XT.prototype={Dec:0,dE:function(){return this.Dec},qx:null,YCb:null,DBa:function(){return this.YCb},bUa:null,UV:null,fnc:function(){return""},LH:function(){return null}};function wac_RFb(a,b){a.UV=b}function wac_SFb(){this.v8d=Function.createDelegate(this,this.XKe)}
wac_SFb.prototype={ea:null,Rb:function(){return"WordEditor.RealTimeTyping"},XKe:function(){return window.Box4.App.hc&&window.Box4.App.hc.Jk?window.Box4.App.hc.Jk:(wac_(7866377,304,15,"Unable to get the lock manager"),null)},Sb:function(a){var b=wac_Eb(wac_cx,wac_m(a,wac_cx)),c=wac_Eb(wac_ry,wac_m(a,wac_ry)),d=wac_Eb(wac_Nc,wac_m(a,wac_Nc)),e=wac_Eb(wac_jS,wac_m(a,wac_jS));this.ea=a;var f=new wac_bz,g=this;wac_Wa.WAA.call(null,b,c,d,e).CW(function(){wac_n(wac_o(a.ma(wac_LFb)),function(){return new wac_TFb(a.K(wac_ox),
a.K(wac_cx),f,a.K(wac_jS))});wac_n(wac_o(wac_p(a.ma(wac_UFb),wac_0rb)),function(){return new wac_UFb(a.K(wac_LFb),new wac_VFb(wac_E()),new (wac_d.$$(wac_JQa))(g.v8d),new (wac_d.$$(wac_jx))(function(){return window.Box4.App.QJ}),a.K(wac_ry),a.K(wac_bG),a.K(wac_kv).xH(),new (wac_d.$$(wac_xv))(function(){return window.Box4.App.va().La.uc().ed()}),wac_r(),function(){return Date.now()},a.K(wac_jS),wac_E(),wac_m(a,wac_Nc),wac_RT.yc,f,wac_s(wac_q.Z,"WordEditorThrottleAndBatchRTTRendering"),new wac_WFb,wac_m(a,
wac_LT))});wac_n(wac_o(a.ma(wac_XFb)),function(){return new wac_XFb(a.K(wac_kv).xH(),new wac_YFb,new (wac_d.$$(wac_uw))(function(){return window.Box4.App.hc}),window.Box4.App.va().La,a.K(wac_jS),a.K(wac_ry))});g.foc()})},foc:function(){this.ea.K(wac_UFb).kb();this.ea.K(wac_XFb).kb()},kb:function(){},ka:function(){}};function wac_ZFb(){this.ilb=new (wac_e.$$(wac_YT))}
wac_ZFb.prototype={ilb:null,U:function(a){this.ilb.U(a);return!0},CKb:function(a){for(var b=new (wac_e.$$(wac_YT)),c=this.ilb.$$lge();c.$$mn();){var d=c.$$cu();a(d)&&b.U(d)}return b},iwc:function(a){wac__Fb(a.YCb,wac_0Fb.toString(1));this.ilb.xb(a)},jwc:function(a){wac__Fb(a.YCb,wac_0Fb.toString(0));this.ilb.xb(a)}};function wac_YT(a,b,c,d,e,f,g,h){wac_YT.initializeBase(this,[2,h]);this.Nwa=a;this.Qsd=b;this.JYa=c;this.FSb=d;this.oNb=e;this.nNb=f;this.RE=g}
wac_YT.prototype={Nwa:0,Qsd:0,JYa:0,FSb:null,oNb:0,nNb:0,RE:0,LH:function(){return new wac_MT(this.qx.p1,this.qx.nH,1,3,new wac_iT(2,this.Nwa,this.Qsd,null,this.FSb,null,null,this.RE,0),null,null,null,new wac_TEb(this.JYa,this.oNb,this.nNb),null,null,null,0,this.qx.G1)}};function wac_1Fb(a,b){this.bqd=a;this.vM=b}wac_1Fb.prototype={dE:function(){return 1},w7a:function(){return this.bqd},bqd:null,vM:null};function wac_2Fb(a,b){this.aqd=a;this.vM=b}
wac_2Fb.prototype={dE:function(){return 6},w7a:function(){return this.aqd},aqd:null,vM:null};function wac_ZT(a,b,c){this.oyc=a;this.Ljb=b;this.WUa=c}wac_ZT.prototype={dE:function(){return 4},w7a:function(){return this.oyc},oyc:null,Ljb:null,WUa:null};function wac_3Fb(a,b){this.cHb=a;this.vM=b}wac_3Fb.prototype={dE:function(){return 2},w7a:function(){return this.cHb},cHb:null,vM:null};function wac_WFb(){this.lma=new (wac_La.$$(wac_e.$$(wac_WT)))}
wac_WFb.prototype={lma:null,uhb:function(a){var b=a.toString();if(!this.lma.gb(b))return new (wac_e.$$(wac_WT));a=this.lma.B(b);this.lma.xb(b);for(b=a.$$lge();b.$$mn();){var c=b.$$cu();c.w7a()&&wac_RFb(c.w7a(),null)}return a}};function wac_4Fb(a,b){for(a=a.lma.Zk().$$ge();a.$$mn();){var c=a.$$cu();if(c.ja()&&2===c.B(0).dE()&&(c=c.B(0),c.cHb.oNb===b))return c}return null}function wac_5Fb(a,b){return a.uhb(b)}
function wac_6Fb(a,b){switch(b.dE()){case 1:var c=window.$$as(wac_1Fb,b);wac_7Fb(a,c.vM,b);break;case 6:c=window.$$as(wac_2Fb,b);wac_7Fb(a,c.vM,b);break;case 4:c=window.$$as(wac_ZT,b);wac_7Fb(a,c.Ljb,b);wac_7Fb(a,c.WUa,b);break;case 2:c=window.$$as(wac_3Fb,b),wac_7Fb(a,c.vM,b)}}function wac_7Fb(a,b,c){b=b.toString();a.lma.gb(b)||a.lma.W(b,new (wac_e.$$(wac_WT)));a.lma.B(b).U(c)}function wac_VFb(a){this._changes=new (wac_Ea.$$(wac_Ea.$$(wac_UT)));this.Eb=a}
wac_VFb.prototype={_changes:null,Eb:null,CKb:function(a){for(var b=new (wac_e.$$(wac_UT)),c=this._changes.Yg().$$ge();c.$$mn();)for(var d=c.$$cu(),d=this._changes.B(d),e=d.Yg().$$ge();e.$$mn();){var f=e.$$cu(),f=d.B(f);a(f)&&b.U(f)}return b},iwc:function(a){wac_8Fb(this,a,1)},jwc:function(a){wac_8Fb(this,a,0)}};
function wac_8Fb(a,b,c){var d=null,e,f;(f=a._changes.mc(b.gt(),e={val:d}),d=e.val,f)?(wac__Fb(b.DBa(),wac_0Fb.toString(c)),d.xb(b.JG()),d.ja()||a._changes.xb(b.gt())):wac_(50938848,355,15,"Cannot remove an op that not exist in _changes. WordId: {0}; Reason: {1}",b.gt(),c)}function wac_9Fb(a,b,c){if(!a._changes.gb(b))return null;a=a._changes.B(b);return a.gb(c)?a.B(c):null}function wac_0Fb(){}wac_0Fb.prototype={expired:0,dried:1};wac_0Fb.registerEnum("WERTT.RttDataStore.RemoveChangeReason",!1);
function wac_$Fb(a,b,c,d){wac_$Fb.initializeBase(this,[3,d]);this.xf=a;this.$L=b;this.RE=c}wac_$Fb.prototype={xf:0,gt:function(){return this.xf},$L:0,JG:function(){return this.$L},J7a:function(){return 0},RE:0,LH:function(){return new wac_MT(this.qx.p1,this.qx.nH,1,5,new wac_iT(4,this.xf,this.$L,null,null,null,null,this.RE,0),null,null,null,null,null,null,null,0,this.qx.G1)}};function wac_TFb(a,b,c,d){this.nQ=a;this.AOc=b;this.Fna=c;this.D4b=d}
wac_TFb.prototype={nQ:null,AOc:null,Fna:null,D4b:null,mMb:function(a){var b=new wac_R;b.ac(a);wac_0A(b,11);return wac_VC(b)?(wac_(16868566,355,50,"Blocked RTT para operation: in a list"),!0):!1}};
function wac_aGb(a){var b=a.aa.ra,c=a.ta;a=a.Oa;for(var d=0;d<b.ia();d++){var e=b.B(d);if(e.Ka>=a)break;if(e.Ka>=c){if(e.Fe)return wac_(8242647,355,15,"Rejected unsafe wet change: range contains comment"),!1;if(e.ad)return wac_(8242648,355,15,"Rejected unsafe wet change: range contains blob"),!1;if(e.Of||e.am&32||e.am&64)return wac_(8242649,355,15,"Rejected unsafe wet change: range contains field"),!1}}return!0}
function wac_bGb(a,b,c,d){for(var e=c.ja()-1;0<=e;e--){var f=c.B(e);switch(f.dE()){case 4:f=window.$$as(wac_ZT,f);if(!b.ha().Aa(f.Ljb)){wac_c(9204885,355,b.ha().Aa(f.WUa),null);continue}f=d.Ib(f.WUa);if(!f)break;if(!f||!wac_U(f)){wac_c(9204886,355,!1,null);break}if(!f.wb)continue;var g,h,k,f=(k=wac_cGb(f,h={val:g}),g=h.val,k);wac_c(9204887,355,f,null);f&&wac_dGb(a,g);break;case 2:if(f=window.$$as(wac_3Fb,f),!b.ha().Aa(f.vM))wac_c(16820001,355,!1,null);else if(b.wb){var l,m,f=(m=wac_cGb(b,l={val:g}),
g=l.val,m);wac_c(16820002,355,f,null);f&&wac_dGb(a,g)}}}}function wac_eGb(a,b){if(b.wb){var c,d,e;if(e=wac_cGb(b,d={val:c}),c=d.val,e)wac_dGb(a,c);else{c=wac_3z(b).Kh;a=a.Fna.Uc(3,0);try{wac_Q(a,b),b.si(c.Ib(b.ha())),wac_LC(b.wb,4)}finally{a&&a.dispose()}}}}function wac_dGb(a,b){var c=new wac_R;c.ac(b);wac_W(c);a=a.Fna.Uc(3,0);try{wac_Q(a,c.ga()),wac_fA(b)}finally{a&&a.dispose()}}function wac_cGb(a,b){b.val=wac_P(a);wac_S(b.val,23);wac_W(b.val);return 89===b.val.Xj()}
function wac_fGb(a,b,c){return b===c?wac_eB(a,b):wac_V(a,b,c)}function wac_gGb(a,b,c,d){var e=wac_TR(c,b.Nwa);if(e.Aa(wac_x()))return null;e=d.Ib(e);if(!e||!wac_U(e)||!e.wb)return null;var f=wac_P(e);if(!wac_S(f,23))return null;if(b.FSb){b=wac_TR(c,b.FSb);if(b.Aa(wac_x()))return null;d=d.Ib(b);if(!d||!wac_U(d)||!d.wb)return null;d=wac_P(d);if(!wac_S(d,23))return null;wac_0A(d,11);wac_ZI(d);wac_1z(d);if(d.ga()!==e)return null}return a.mMb(f)?null:f}
function wac_UFb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v){this.fha=Function.createDelegate(this,this.Iva);this.L$b=Function.createDelegate(this,this.jtc);this.U6d=Function.createDelegate(this,this.tIe);this.DAa=a;this.Pxa=b;this.V2a=c;this.zoa=d;this.mb=e;this.St=f;this.Ar=g;this.Bf=h;this.$a=k;this.rw=l;this.D4b=m;this.Eb=n;this.epa=q;this.vb=r;this.$Uc=t;this.axa=u;this.tyb=v;this.b4a=new (wac_Ca.$$(String))(wac_qa());this.pZa=new wac_ZFb;p.rb(wac_hGb)}
function wac_hGb(a){for(var b=[3959281607,1157520733],c=b.length,d=0;d<c;++d){var e=b[d];a.DM(e,"WetChangeCount",wac_Ej);a.DM(e,"NoChangesToApply",wac_Ej);a.DM(e,"NodeNotConnected",wac_Ej);a.DM(e,"CouldNotGetLock",wac_Ej);a.DM(e,"WetChangeBlocked",wac_Ej);a.DM(e,"ParagraphAlreadyDirty",wac_Ej);a.DM(e,"UnsafeWetChange",wac_Ej)}a.DM(1839802051,"FailedToFindInitialParaID",wac_XAb);a.DM(1839802051,"FailedToFindInitialTextID",wac_XAb);a.DM(1839802051,"MsecUntilApplied",wac_WAb);a.DM(1839802051,"RemovedBecause",
wac_Ej);a.DM(1839802051,"PacketVersions",wac_Ej);a.DM(1839802051,"OperationType",wac_Ej)}
wac_UFb.prototype={DAa:null,Pxa:null,pZa:null,V2a:null,zoa:null,mb:null,St:null,Ar:null,vg:null,Bf:null,rw:null,$a:null,wVd:!1,D4b:null,Eb:null,epa:null,vb:null,axa:null,tyb:null,b4a:null,kLc:!1,$Uc:!1,kb:function(){return this.Ar?this.Ar.CW(this.L$b):wac__a(Boolean,!1)},jtc:function(){wac_(7685328,355,50,"All prerequisite ready for RttManager");this.vg=this.Ar.Nb();wac_(7685330,355,50,"Subscribing to presence updates");this.vg.U3(this.fha)},Iva:function(a,b){if(3===b.wg&&wac_iGb(this))if(this.zoa.pa()&&
this.zoa.pa().Gd&4)wac_(8454939,355,15,"RTT channel did not get disconnected on lock release");else if(b.mqa){if(this.KQd||(wac_(8704354,355,50,"Received a wet change"),this.KQd=!0),(a=wac_jGb(this,b.mqa))&&1!==a.qx.Xfd)switch(this.IQd||(wac_(8185606,355,50,"Received a wet change that we could deserialize"),this.IQd=!0),this.wVd||(b=new wac_th(3,2,6E4,this.U6d,0,null,!1),this.$a.xc(b),this.wVd=!0),a.dE()){case 1:case 6:case 4:var c,d,e;if(e=wac_kGb(this,a,d={val:c}),c=d.val,!e)break;this.$Uc?wac_lGb(this,
c):wac_mGb(this,c);break;case 2:this.pZa.U(a),wac_nGb(this,a),this.$Uc?wac_lGb(this,wac_x()):wac_oGb(this,a)}}else wac_(7685331,355,15,"RTT packet was empty")},tIe:function(){var a=this.Bf.pa();if(a){var b=this.rw()-18E4,c=this.Pxa.CKb(function(a){return a.qx.Zyc<b});0<c.ja()&&!this.RSc&&!this.JQd&&(wac_(8185608,355,15,"Failed to apply any wet changes so far"),this.JQd=!0);for(var d=new wac_Na,e=c.$$lge();e.$$mn();)if(c=e.$$cu(),this.Pxa.jwc(c),c.UV)switch(c.UV.dE()){case 1:d.U(c.UV.vM.toString());
break;case 6:d.U(c.UV.vM.toString());break;case 4:d.U(c.UV.Ljb.toString()),d.U(c.UV.WUa.toString())}for(e=this.pZa.CKb(function(a){return a.qx.Zyc<b}).$$lge();e.$$mn();)c=e.$$cu(),this.pZa.jwc(c),c.UV&&d.U(c.UV.vM.toString());for(d=d.GetEnumerator();d.$$mn();)c=d.$$cu(),(c=a.Ib(wac_Yl(c)))?c.cI?(wac_eGb(this.DAa,c),c.cI||(wac_KAb(this.V2a.pa(),c),c.oa(Number,wac_cv,0))):wac_(8765829,355,15,"Expiring wet change from paragraph with no applied changes"):wac_(8765828,355,15,"Expiring wet change with invalid object ID")}else!this.Bf.A6a&&
wac_(7685332,355,10,"Failed to find the IObjectSpace! Wet changes will never expire")},Led:function(a,b){wac_pGb(this,a,b)},QPb:function(a){if(wac_iGb(this)&&a.Da(wac_8r)&&a.Da(wac_tt)){var b=a.Ha(Number,wac_8r),c=a.oa(Number,wac_tt,0),d=this.Eb.Cj(1157520733,-1),e=wac_5Fb(this.axa,a.ha());0<e.ja()&&(wac_bGb(this.DAa,a,e,this.Bf.pa()),wac_qGb(this,a,e,c));var f=wac_4Fb(this.axa,b);if(f&&!a.ha().Aa(f.vM)){var g=this.Bf.pa(),h=this;wac_rGb(this,function(){var a=h.axa.uhb(f.vM),b=g.Ib(f.vM);wac_c(16820032,
355,!!b,"Could not find added graph node");b&&(wac_bGb(h.DAa,b,a,g),h.pZa.iwc(f.cHb))})}wac_9Fb(this.Pxa,b,c)||wac_KAb(this.V2a.pa(),a);this.Led(a,d);d.wd()}},Qsc:function(a){var b=this.axa.uhb(a.ha());0<b.ja()&&(2===b.B(0).dE()&&b.Od(0),wac_bGb(this.DAa,a,b,this.Bf.pa()))},sYa:function(a){for(var b=a.ha(),c,d,e,b=((e=this.axa.lma.mc(b.toString(),d={val:c}),c=d.val,e)?c:new (wac_e.$$(wac_WT))).$$lge();b.$$mn();)if(c=b.$$cu(),4===c.dE()&&(c=window.$$as(wac_ZT,c),a.ha().Aa(wac__T(c.oyc)?c.WUa:c.Ljb)))return!0;
return!1},KQd:!1,IQd:!1,MQd:!1,RSc:!1,JQd:!1};function wac_sGb(a){a.RSc||(wac_(8185607,355,50,"Successfully applied a wet change"),a.RSc=!0)}function wac_tGb(a){a.MQd||(wac_(17147533,355,50,"Received a usable wet change"),a.MQd=!0)}
function wac_qGb(a,b,c,d){for(var e=!1,f=c.ja()-1;0<=f;f--){var g=c.B(f);switch(g.dE()){case 1:case 6:case 4:g=window.$$as(wac_UT,g.w7a());break;default:continue}if(g.J7a()===d){var e=!0,h;if(h=g.bUa){h=g.bUa;var k=b,l=h.lb===k.ha();l&&(l=h.u8c.replace("\u00a0"," "),h=k.Jb.substr(h.ta,h.$o-h.ta).replace("\u00a0"," "),l=l===h);h=!l}h&&wac_(8765831,355,15,"Validating wet change location failed. Type {0} OffsetInfo {1} NodeId {2} ValidatorNodeId {3} ValidatorNodeCpBegin {4} ValidatorNodeCpEnd {5}",g.dE(),
g.fnc(),b.ha(),g.bUa.ha(),g.bUa.ta,g.bUa.$o)}e&&a.Pxa.iwc(g)}e&&wac_sGb(a)}
function wac_pGb(a,b,c){if(!b)return null;if(!b.wb)return c&&c.Ia().W("NodeNotConnected","1"),null;if(!b.Da(wac_8r))return wac_(7619922,355,15,"Paragraph is missing the WordId property"),null;if(!b.Da(wac_tt))return wac_(8197722,355,15,"Paragraph is missing the TextId property"),null;if(b.Da(wac_tEa)&&b.Ha(Boolean,wac_tEa))return wac_(16815506,355,50,"RTT edit disabled in paragraph"),null;var d=b.Ha(Number,wac_8r),e=wac_LAb(b);c&&(c.Ia().W("NodeTextId",e.toString()),c.Ia().W("NodeWordId",d.toString()));
e=wac_9Fb(a.Pxa,d,e);if(!e)return c&&c.Ia().W("NoChangesToApply","1"),null;if(!wac_uGb(a,b,e))return c&&c.Ia().W("CouldNotGetLock","1"),null;for(var f=0,g=null;e;){var h;a:{var k=a.DAa,l=e,m=b,n=a.axa,p=c;if(m.ZZ())p&&p.Ia().W("ParagraphAlreadyDirty","1"),h=!1;else{var q=new wac_QFb(l,m.Ii());try{if(1===l.dE()||6===l.dE()){var r=window.$$as(wac_0T,l),t,u=r,v=m,w=wac_jT(v.Jb,v.ra),x=wac_hT(w,u.Lsa),y=wac_hT(w,u.pTa);t=x===y?wac_eB(v,x):wac_V(v,x,y);var z,A=t.aa.Jb,C=10<=t.ta?t.ta-10:0,B=t.Oa+10<=A.length?
t.Oa+10:A.length,D=A.substr(C,t.ta-C),E=A.substr(t.Oa,B-t.Oa),B=B+r.Dia.length-(t.Oa-t.ta),F=D+r.Dia+E;z=new wac_vGb(t.aa.ha(),C,B,F);var H=6===r.Dec,G="";H&&(G=r.lsa);var I;var u=t,K=r.Dia,v=H,M=u.aa;if(u.ta===u.Oa||wac_aGb(u)){var N=k.Fna.Uc(3,0);try{wac_Q(N,M);var L=wac_uI(M);try{M.cI=!0,wac_MAb(k.nQ,u,K,v,G)}finally{L&&L.dispose()}N.uV=-1}finally{N&&N.dispose()}I=!0}else p&&p.Ia().W("UnsafeWetChange","1"),I=!1;if(!I){h=!1;break a}p=void 0;p=1===l.dE()?new wac_1Fb(r,m.ha()):new wac_2Fb(r,m.ha());
m.h0a=l.J7a();r.bUa=z;wac_RFb(l,p);wac_6Fb(n,p)}else{var J;if(4===l.dE()){var p=k,Q=window.$$as(wac_1T,l),O=wac_hT(wac_jT(m.Jb,m.ra),Q.Pw);if(wac_aGb(wac_V(m,0,wac_T(m)))){var P=wac_P(m);wac_S(P,10);if(p.mMb(P))J=!1;else{var k=void 0,R=p.Fna.Uc(3,0);try{wac_Q(R,m);var W=wac_uI(m);try{var T=wac_P(m);wac_S(T,10);wac_0A(T,11);var V=T.ga();wac__T(Q)&&(T.Zv(-1)?V=null:(wac_ZI(T),V=T.ga()));wac_W(T);var X=p.AOc.SUa();T.Fx(X,V,89);T.hg(X);var k=m.Ac(),Y=wac_uI(k);try{k.la(wac_8r,wac__T(Q)?Q.GSb:Q.Vkb);k.la(wac_tt,
wac__T(Q)?Q.ekb:Q.fkb);k.iy(!1);T.Vd(k,2);T.hg(k);u=m;v=k;v.d7=!0;wac_cH(v,u.Jb);v.h0a=wac_LAb(u);v.ra.Ae();for(G=0;G<u.ra.ia();G++){var Z=wac_2I(u.ra.B(G),v,null);v.ra.U(Z)}v.nk();if(v.vd.ia())for(G=0;G<v.ra.ia();G++){var U=v.ra.B(G).eb;if(U&&-1!==U.$l)for(;v.vd.ia()<=U.$l;)wac_WG(v.vd,v.vd.ia()-1,256,1)}else wac_(9204881,355,15,"Cannot update WordRunProperties after splitting paragraph");v.d7=!1;var ea=wac__T(Q)?k:m,ka=wac__T(Q)?m:k;ea.cI=!0;ka.cI=!0;wac_MAb(p.nQ,wac_fGb(ea,O,wac_T(ea)),"",!1,"");
wac_MAb(p.nQ,wac_fGb(ka,0,O),"",!1,"");m.h0a=Q.aba;k.h0a=wac__T(Q)?Q.ekb:Q.fkb}finally{Y&&Y.dispose()}}finally{W&&W.dispose()}R.uV=-1}finally{R&&R.dispose()}var ha=new wac_ZT(Q,m.ha(),k.ha());wac_RFb(l,ha);wac_6Fb(n,ha);J=!0}}else J=!1}else J=!1;h=J;break a}}finally{q&&q.dispose()}h=!0}}if(!h){c&&c.Ia().W("WetChangeBlocked","1");break}f++;g=e.DBa();q=a.rw();g.$C&&(g.$C.Ia().gb("MsecUntilApplied")||g.$C.Ia().W("MsecUntilApplied",(q-g.$C.WR()).toString()));g=e;e=wac_LAb(b);e=wac_9Fb(a.Pxa,d,e)}0<f&&
wac_sGb(a);c&&c.Ia().U("WetChangeCount",f.toString());return g}function wac_uGb(a,b,c){if(!a.V2a.pa())return wac_c(7866378,355,!!a.V2a.pa(),"Unable to apply wet changes as LockManager unavailable"),!1;var d;a=a.V2a.pa();c=wac_JAb(a,b,c.qx.nH);var e=b.oa(Number,wac_cv,0);e&&a.ua.Xa("WLA",new wac_dvb(e),a);c&&c.LockId!==e&&wac_SQa(c,b);return(d=!!c,d)?!0:(wac_(7866379,355,15,"Unable to apply a wet change lock"),!1)}
function wac_wGb(a,b){var c=b.LH();if(2!==c.gca||c.yE.kca&&c.yE.Vka!==c.yE.kca)return null;var d=b.Lsa.Ac();0<b.Dia.length&&(wac_Lrb(d),d.Vf+=b.Dia.length);c.gca=0;c.Text=null;c.yE.rib=0;c.yE.xva=d;c.yE.swa=c.WIa;c.yE.kca=null;c.yE.gkb=null;c.yE.hXa=null;c.WIa=null;return wac_fFb(c,a.St,a.D4b,function(){return a.Bf.pa()},a.tyb.Fa())}function wac_xGb(a,b){a.epa.CW(function(){if(1===b.dE()){var c=wac_wGb(a,b);c&&(wac_wEb(a.epa.Nb(),c),c=a.epa.Nb(),wac_xEb(c))}})}
function wac_oGb(a,b){var c=wac_gGb(a.DAa,b,a.St,a.Bf.pa());if(c){wac_tGb(a);var d=a.DAa,e=a.axa,f=wac_k().K(wac_vx),g=c.ga(),h=d.Fna.Uc(3,0);try{wac_Q(h,g);wac_0A(c,11);var k=c.ga();wac_W(c);var l=d.AOc.SUa();c.Fx(l,k,89);c.hg(l);var m=wac_mv.Uf.ho(393230),n=wac_uI(m);try{m.la(wac_Eq,""),m.d7=!0,f.$Xa(m),d=[0],m.la(wac_7r,d),m.la(wac_Ns,d),m.d7=!1,m.la(wac_8r,b.oNb),m.la(wac_tt,b.nNb),m.iy(!1),c.Vd(m,2),m.cI=!0,m.h0a=b.nNb}finally{n&&n.dispose()}h.uV=-1;b.UV=new wac_3Fb(b,m.ha());wac_6Fb(e,b.UV)}finally{h&&
h.dispose()}c=b.UV.vM;c=a.Bf.pa().Ib(c);wac_uGb(a,c,b)}}function wac_mGb(a,b){b=a.Bf.pa().Ib(b);var c,d=a.vb.Uc(3,0);try{wac_Q(d,b);c=a.Eb.Cj(3959281607,-1);var e=wac_pGb(a,b,c);c.wd();e&&wac_xGb(a,e)}finally{d&&d.dispose()}}
function wac_yGb(a){for(var b=a.pZa.CKb(function(a){return!a.UV}).$$lge();b.$$mn();){var c=b.$$cu();wac_oGb(a,c)}if(a.b4a.ja()){b=null;for(c=a.b4a.GetEnumerator();c.$$mn();){var d=c.$$cu(),b=wac_Yl(d),b=a.Bf.pa().Ib(b);break}c=a.vb.Uc(3,0);try{wac_Q(c,b);for(var e=a.b4a.GetEnumerator();e.$$mn();)d=e.$$cu(),wac_mGb(a,wac_Yl(d))}finally{c&&c.dispose()}a.b4a.Ae()}}
function wac_nGb(a,b){(a=a.Eb)?(a=a.Cj(1839802051,48E4),a=new wac_zGb(a)):a=null;b.YCb=a;a=b.DBa();a.$C&&a.$C.Ia().W("PacketVersions",b.qx.$nd.toString());a=b.DBa();b=wac_MFb.toString(b.dE());a.$C&&a.$C.Ia().W("OperationType",b)}function wac_rGb(a,b){b=new wac_th(0,1,0,b,71,null,!1);a.$a.xc(b)}function wac_lGb(a,b){b.Aa(wac_x())||a.b4a.U(b.toString());a.kLc||(b=new wac_th(0,1,200,function(){wac_yGb(a);a.kLc=!1},71,null,!1),a.$a.xc(b),a.kLc=!0)}
function wac_kGb(a,b,c){c.val=wac_x();var d;d=a.Pxa;if(b){var e=b.gt(),f=b.JG();d._changes.gb(e)||d._changes.U(e,new (wac_Ea.$$(wac_UT)));d._changes.B(e).W(f,b);var g;b:{if(d._changes.gb(e)&&(g=d._changes.B(e),g.gb(f)))for(var h=g.B(f);h;){h=h.J7a();if(h===f){g=!0;break b}if(!g.gb(h))break;h=g.B(h)}g=!1}g?(wac_(7619921,355,15,"Detected an infinite loop in paragraph {0}, dropping the last packet!",e),d._changes.B(e).xb(f),d=!1):d=!0}else wac_(7685333,355,15,"Cannot add a null change to RTTStore"),
d=!1;if(!d)return!1;wac_nGb(a,b);if(!a.St)return!1;d=wac_TR(a.St,b.gt());if(d.Aa(wac_x())||!a.Bf.pa().Ib(d))return wac_AGb(b.DBa()),!1;wac_tGb(a);c.val=d;return!0}
function wac_jGb(a,b){b=wac_1Eb(b);if(!b)return null;switch(b.gca){case 2:var c,d,e,f,g,h,k,l,m;(m=wac_BGb(b,g={val:c},h={val:d},k={val:e},l={val:f}),c=g.val,d=h.val,e=k.val,f=l.val,m)?(a="",b.Text&&(a=b.Text),g=wac_CGb(b),b=new wac_DGb(e,f,c,d,b.WIa,a,b.yE.RE,g)):b=null;return b;case 7:return wac_EGb(b);case 4:return wac_FGb(a)?(c=b.yE,d=b.OIa,b=new wac_1T(c.Vka,c.swa,c.xva,c.RE,d.huc,d.Qyc,d.iuc,d.Ryc,wac_CGb(b))):b=null,b;case 3:return wac_FGb(a)?(c=b.yE,d=b.hUa,e=null,null!=b.yE.kca&&(e=b.yE.kca),
b=new wac_YT(c.Vka,c.swa,d.Syc,e,d.juc,d.JYa,c.RE,wac_CGb(b))):b=null,b;default:return wac_(8459668,355,50,"RTT packet is of unexpected operationType {0}",b.gca),null}}function wac_FGb(a){return wac_iGb(a)&&a.mb.Bb(105)}function wac_iGb(a){return a.mb.Bb(140)&&a.mb.Bb(109)}function wac_GGb(a,b,c,d,e,f,g,h){wac_GGb.initializeBase(this,[5,h]);this.ESb=a;this.Pyc=b;this.oud=c;this.Rsd=d;this.RE=e;this.BAc=f;this.IYa=g}
wac_GGb.prototype={ESb:0,Pyc:0,oud:0,Rsd:0,RE:0,BAc:0,IYa:0,gt:function(){return this.ESb},JG:function(){return this.Pyc},J7a:function(){return this.ESb===this.BAc?this.IYa:0},LH:function(){return new wac_MT(this.qx.p1,this.qx.nH,1,6,new wac_iT(5,this.ESb,this.Pyc,null,this.oud,this.Rsd,null,this.RE,0),null,null,null,null,new wac_UEb(this.BAc,this.IYa),null,null,0,this.qx.G1)}};function wac_zGb(a){this.$C=a}wac_zGb.prototype={$C:null};
function wac__Fb(a,b){a.$C&&(a.$C.Ia().W("RemovedBecause",b),a.$C.wd())}function wac_AGb(a){a.$C&&a.$C.Ia().W("FailedToFindInitialParaID","1")}function wac_vGb(a,b,c,d){this.lb=a;this.ta=b;this.$o=c;this.u8c=d}wac_vGb.prototype={lb:null,ha:function(){return this.lb},ta:0,$o:0,u8c:null};function wac_HGb(a,b,c,d,e,f){this.p1=a;this.nH=b;this.Xfd=c;this.Zyc=d;this.$nd=e;this.G1=f}function wac_CGb(a){var b=null;null!=a.G1&&(b=a.G1);return new wac_HGb(a.p1,a.nH,a.wcb,Date.now(),a.Lwa,b)}
wac_HGb.prototype={p1:0,nH:null,Xfd:0,Zyc:0,$nd:0,G1:null};function wac_DGb(a,b,c,d,e,f,g,h){wac_DGb.initializeBase(this,[a,b,c,d,e,f,g,h,1])}wac_DGb.prototype={fnc:function(){return"OffsetStart: "+this.Lsa+"OffsetEnd: "+this.pTa+"TextAddedLength: "+this.Dia.length},LH:function(){var a=wac_IGb(this);return new wac_MT(this.qx.p1,this.qx.nH,1,2,a,null,this.aba,this.Dia,null,null,null,null,0,this.qx.G1)}};
function wac_JGb(a,b,c,d,e,f,g,h,k,l,m){wac_JGb.initializeBase(this,[d,e,f,g,h,k,l,m,6]);this.lsa=a;this.Gve=b;this.owe=c}
function wac_EGb(a){var b,c,d,e,f,g,h,k,l;if(l=wac_BGb(a,f={val:b},g={val:c},h={val:d},k={val:e}),b=f.val,c=g.val,d=h.val,e=k.val,!l)return null;if(1===a.Text.length)f=!1,g="\ufffc";else if(2===a.Text.length)if(f=a.Text,55296<=f.charCodeAt(0)&&56319>=f.charCodeAt(0)&&wac_eg(a.Text,1))f=!0,g=a.Text;else return wac_(8914772,355,15,"RTT symbol packet has text length 2 but is not a valid surrogate pair",a.gca),null;else return wac_(8914773,355,15,"RTT symbol packet text is of unsupported length (length must be 1 or 2)",
a.gca),null;h=a.$jb;k=wac_CGb(a);return new wac_JGb(h.Hyc,h.Iyc,f,d,e,b,c,a.WIa,g,a.yE.RE,k)}wac_JGb.prototype={lsa:null,Gve:!1,owe:!1,fnc:function(){return"OffsetStart: "+this.Lsa+"OffsetEnd: "+this.pTa},LH:function(){var a=wac_IGb(this);return new wac_MT(this.qx.p1,this.qx.nH,1,7,a,null,this.aba,this.Dia,null,null,null,null,0,this.qx.G1)}};function wac_0T(a,b,c,d,e,f,g,h,k){wac_0T.initializeBase(this,[k,h]);this.xf=a;this.$L=b;this.Lsa=c;this.pTa=d;this.aba=e;this.Dia=f;this.g5=g}
function wac_BGb(a,b,c,d,e){a=a.yE;if(1===a.rib&&(a.Vka!==a.kca||a.swa!==a.gkb))return wac_(8914769,355,15,"We received a ReplaceRange operation spanning multiple paragraphs"),b.val=c.val=null,d.val=e.val=-1,!1;if(a.RE)return b.val=c.val=null,d.val=e.val=-1,!1;b.val=a.xva;c.val=b.val;1===a.rib&&(c.val=a.hXa);d.val=a.Vka;e.val=a.swa;return!0}wac_0T.prototype={xf:0,gt:function(){return this.xf},$L:0,JG:function(){return this.$L},Lsa:null,pTa:null,aba:0,J7a:function(){return this.aba},Dia:null,g5:0};
function wac_IGb(a){return a.Lsa.Yv(a.pTa,!0)?new wac_iT(0,a.xf,a.$L,a.Lsa,null,null,null,a.g5,0):new wac_iT(1,a.xf,a.$L,a.Lsa,a.xf,a.$L,a.pTa,a.g5,0)}function wac_YFb(){this.N4a=new (wac_2T.$$(wac_fMa))}wac_YFb.prototype={N4a:null};function wac_KGb(a){return a.N4a.Xm()?null:a.N4a.bVa()}function wac_XFb(a,b,c,d,e,f){this.x4c=Function.createDelegate(this,this.MXe);this.L$b=Function.createDelegate(this,this.jtc);this.Ar=a;this.tSc=b;this.zN=c;this.Wo=d;this.yqa=e;this.mb=f}
wac_XFb.prototype={Ar:null,Wk:null,tSc:null,zN:null,Wo:null,yqa:null,mb:null,dwb:null,sLc:!1,dUd:0,vVc:0,RUd:!1,c4b:!1,sSc:0,wga:function(){return this.zN.pa()},kb:function(){return this.Ar?this.Ar.CW(this.L$b):wac__a(Boolean,!1)},jtc:function(){wac_(8245954,355,50,"All prerequisites ready for RttSendManager");this.Wk=this.Ar.Nb();wac_YDb(this.Wk,this)},ae:function(){this.sLc||(wac_LGb(this)&&this.Wo.uc().ys.ua.fb("PTC",this.x4c),this.sLc=!0)},gd:function(){this.sLc=!1;wac_LGb(this)&&this.Wo.uc().ys.ua.fd("PTC",
this.x4c)},MXe:function(a,b){if(this.Wk&&2===this.Wk.VZ()&&(a=b.ys,a.length))if(b.d8c)100>this.vVc&&(this.vVc++,wac_(8270467,355,50,"Blocking send. Reason: {0} OverallSends: {1} OverallBlocked: {2}",b.e8c,this.dUd,this.vVc));else{for(b=0;b<a.length;b++){var c=a[b],d=c;if(!d||-1===d.g5||d.Re()&&(!wac_LGb(this)||!this.mb.Bb(106)||3!==d.Re()&&1!==d.Re()))return}for(b=0;b<a.length;b++){var c=a[b],e=!c.Re()&&!b,d=this.tSc;d.N4a.Xed()&&e&&d.N4a.Xed().ZEa(c)||d.N4a.xba(c)}this.dwb||wac_MGb(this,this.dwb,
this.Wk)}}};
function wac_NGb(a,b){if(!b)return null;if(!a.wga())return wac_(8245957,355,15,"GetParagraphAnchoredOpFromGraphTransactionOperation: CoAuth manager is null"),null;var c=wac__Eb(wac_FFb);a=a.wga().aH;var d=wac_gFb;4294967295===d.Bwb&&(d.Bwb=0);d.Bwb++;c=new wac_HGb(c,a,1,0,0,d.Bwb);a=null;switch(b.Re()){case 0:b.Re()?a=null:(a=wac_jT(b.pE.vs(),b.pE.Kbc),a=new wac_DGb(b.pE.gt(),b.pE.JG(),wac_fT(a,b.ta),wac_fT(a,b.$o),b.ML.JG(),b.a0,b.g5,c));break;case 4:a=4!==b.Re()?null:new wac_$Fb(b.jDa.gt(),b.jDa.JG(),
b.g5,c);break;case 3:a=3!==b.Re()?null:new wac_YT(b.b0.gt(),b.b0.JG(),b.Fad.JG(),b.lia?b.lia.gt():null,b.ML.gt(),b.ML.JG(),b.g5,c);break;case 2:a=2!==b.Re()?null:new wac_GGb(b.b0.gt(),b.b0.JG(),b.lia.gt(),b.lia.JG(),b.g5,b.U$a.gt(),b.U$a.JG(),c);break;case 1:a=1!==b.Re()?null:new wac_1T(b.pE.gt(),b.pE.JG(),wac_fT(wac_jT(b.pE.vs(),b.pE.Kbc),b.Sfc),b.g5,b.kha.gt(),b.kha.JG(),b.RCa.gt(),b.RCa.JG(),c)}return a}
function wac_MGb(a,b,c){wac_OGb(a);b&&(wac_1a(b)||wac_2a(b))&&wac_(8245956,355,15,"Task is faulted or cancelled with exception {0}",b.ik);(b=wac_NGb(a,wac_KGb(a.tSc)))?(a.dUd++,a.dwb=c.BM(3,wac_3Eb(b.LH()),!1),wac_PGb(a),a.dwb.CW(function(b){wac_MGb(a,b,c)})):a.dwb=null}function wac_PGb(a){!a.c4b&&5>=a.sSc&&(wac_(8270469,355,50,"Sent Rtt Message"),a.c4b=!0)}function wac_OGb(a){a.c4b||(a.RUd||(wac_(8270468,355,50,"Preparing to send RTT change"),a.RUd=!0),!a.c4b&&5>=a.sSc&&a.sSc++)}
function wac_LGb(a){return a.mb.Bb(140)&&a.mb.Bb(117)}function wac_1T(a,b,c,d,e,f,g,h,k){wac_1T.initializeBase(this,[4,k]);this.xf=a;this.$L=b;this.Pw=c;this.RE=d;this.GSb=e;this.ekb=f;this.Vkb=g;this.fkb=h;this.GSb===this.xf?this.aba=this.ekb:this.Vkb===this.xf?this.aba=this.fkb:(wac_(8397766,355,10,"Bad data passed to RttSplitParagraphOp"),this.aba=0)}
wac_1T.prototype={xf:0,gt:function(){return this.xf},$L:0,JG:function(){return this.$L},aba:0,J7a:function(){return this.aba},Pw:null,RE:0,GSb:0,ekb:0,Vkb:0,fkb:0,LH:function(){return new wac_MT(this.qx.p1,this.qx.nH,1,4,new wac_iT(3,this.xf,this.$L,this.Pw,null,null,null,this.RE,0),null,null,null,null,null,new wac_VEb(this.GSb,this.ekb,this.Vkb,this.fkb),null,0,this.qx.G1)}};function wac__T(a){return a.xf===a.Vkb}wac_QFb.registerClass("WERTT.GraphChangeValidator",null,Sys.IDisposable);
wac_XT.registerClass("WERTT.RttOp",null,wac_VT);wac_SFb.registerClass("WERTT.WordEditorRealTimeTypingPackage",null,wac_I,wac_j);wac_ZFb.registerClass("WERTT.RttAddParagraphDataStore");wac_YT.registerClass("WERTT.RttAddParagraphOp",wac_XT);wac_1Fb.registerClass("WERTT.RttAppliedReplaceTextRangeOp",null,wac_WT);wac_2Fb.registerClass("WERTT.RttAppliedReplaceSymbolRangeOp",null,wac_WT);wac_ZT.registerClass("WERTT.RttAppliedSplitParagraphOp",null,wac_WT);
wac_3Fb.registerClass("WERTT.RttAppliedAddParagraphOp",null,wac_WT);wac_WFb.registerClass("WERTT.RttAppliedOpTracker",null,wac_NFb);wac_VFb.registerClass("WERTT.RttDataStore",null,wac_KFb);wac_$Fb.registerClass("WERTT.RttDeleteParagraphOp",wac_XT,wac_UT,wac_VT);wac_TFb.registerClass("WERTT.RttEditor",null,wac_LFb);wac_UFb.registerClass("WERTT.RttManager",null,wac_0rb);wac_GGb.registerClass("WERTT.RttMergeParagraphOp",wac_XT,wac_UT,wac_VT);wac_zGb.registerClass("WERTT.RttOpActivity");
wac_vGb.registerClass("WERTT.RttOpValidator",null,wac_OFb);(function(){}).registerClass("WERTT.RttOpValidatorFactory");wac_HGb.registerClass("WERTT.RttOpMetadata");wac_0T.registerClass("WERTT.RttReplaceRangeOp",wac_XT);wac_DGb.registerClass("WERTT.RttReplaceTextRangeOp",wac_0T,wac_UT,wac_VT);wac_JGb.registerClass("WERTT.RttReplaceSymbolRangeOp",wac_0T,wac_UT,wac_VT);wac_YFb.registerClass("WERTT.RttSendDataStore",null,wac_PFb);wac_XFb.registerClass("WERTT.RttSendManager",null,wac_lv);
wac_1T.registerClass("WERTT.RttSplitParagraphOp",wac_XT,wac_UT,wac_VT);wac_J(wac_C(),new wac_SFb,0,!1);Type.registerNamespace("RealtimePresenceUI");function wac_QGb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){wac_QGb.initializeBase(this,[a,f,r,b]);this.Zwd=c;this.fQd=d;this.XOd=e;this.sa=g;wac_RGb=h;this.St=k;this.Nd=l;this.$Q=m;this.tyb=n;this.qQ=q}
function wac_SGb(a,b,c,d,e){var f=wac_m(wac_3T,wac_LT),g=wac_3T.K(wac_1c).ag,h=wac_3T.K(wac_fb),k=window.Box4.App.va().La,l=wac_y(),m=wac_Sy(),n=wac_k().K(wac_Zw);return new wac_QGb(a,b,function(a,b){return k.ud.Yi()?k.ud.WHb(a,b,!0):!1},function(a,b){k.ud.Yi()&&k.ud.kQb(a,b,!0,!0)},function(a){wac_t()&&wac_t().hb.pd()?wac_Qy().eJa():(g.$u(a),wac_upb())},l,m,k,c,d,e,f,0,n,h)}
function wac_TGb(a){var b=wac_RGb.uc().ed().Ib(a.ll().lC());if(wac_i(b))return wac_(20764576,325,15,"The node could not be obtained"),null;if(!wac_U(b))return wac_(20764577,325,15,"The obtained node is not a paragraph node"),null;a=wac_eB(b,a.ll().fH.We());return new wac_QC([a],!0,null)}wac_QGb.prototype={Zwd:null,fQd:null,XOd:null,sa:null,St:null,Nd:null,$Q:null,tyb:null,qQ:null,Zzc:function(a){this.qQ.DMb(a.CommandValueId);return wac__Bb.prototype.Zzc.call(this,a)},ka:function(){wac_RDb.prototype.ka.call(this)}};
function wac_$Bb(a,b,c){c.val=wac_aCb(a,b);return!!c.val}function wac_aCb(a,b){return b?(a=wac_fFb(wac_1Eb(b),a.St,a.Nd,a.$Q,a.tyb.Fa()))&&a.Aj()&&a.ll()?a:null:null}
function wac_4Bb(a,b){var c,d,e;if(e=wac_$Bb(a,b,d={val:c}),c=d.val,e)a.fQd(c.ll().lC(),c.ll().fH.We()),wac_s(wac_q.Z,"WordEditorMoveIpToUserLocationIsEnabled")&&(b=wac_TGb(c),wac_i(b)?wac_(20764575,325,50,"IP will not be moved since the selection is either null or undefined"):(wac_(20764574,325,50,"Attempting to move IP to the editing location of the selected user"),a.sa.oc(b,null,!1,!1,0),wac_ui()&&wac_Rk(wac_z(),"document"))),b=new wac_th(2,1,0,function(){a.fa.jc(761503246,2,c,null)},0,null,!1),
wac_r().xc(b)}Type.registerNamespace("WordEditor.PeoplesWellControl");wac_L=window.WordEditor||{};wac_L.O0e=wac_L.O0e||{};function wac_UGb(){this.M$b=Function.createDelegate(this,this.ktc);this.it=Function.createDelegate(this,this.Bt)}
wac_UGb.prototype={Rb:function(){return"WordEditor.PeoplesWellControl"},Sb:function(a){wac_3T=a},kb:function(){wac_ni(wac_q.Z,this.it)},Bt:function(){wac_q.xuc?(wac_VGb||(wac_VGb=wac_k().K(wac_kv))).xH().CW(this.M$b):wac_(23196872,325,50,"PeoplesWell control is explicitly disabled. Skipping initialization attempt")},ktc:function(){if(wac_WGb=(wac_VGb||(wac_VGb=wac_k().K(wac_kv))).xH().Nb()){var a=function(){var a=window.Box4.App.va().La;return a?a.uc()?a.uc().ed():(wac_(23196876,325,15,"ActivePage is null"),
null):(wac_(23196875,325,15,"Workspace is null"),null)};window.Box4.App.r4().CW(function(){var b=window.Box4.App.r4().Nb().aH,c=wac_WGb.vg,d=wac_WGb.vg,e=wac_cCb(wac_XGb("we_SingleCollabUserGlyph16","we_SingleCollabUserGlyph32","we_MoreUsersGlyph16",wac_Pi,"we_CommentComment_24x24x32"),b,c.d9d||(c.d9d=Function.createDelegate(c,c.QLe)),d.f9d||(d.f9d=Function.createDelegate(d,d.ljd)));wac_n(wac_o(wac_p(wac_k().ma(wac_QGb),wac_uc)),function(){return wac_SGb(e,wac_Eb(wac_tc,wac_m(wac_3T,wac_tc)),wac_l(wac_3T,
wac_bG),wac_l(wac_3T,wac_jS),a)});wac_6Bb=wac_k().K(wac_uc);wac_5Bb();wac_(23196877,325,50,"PeoplesWellControl is fully initialized")})}else wac_(23196873,325,15,"Can't initialize the PeoplesWell control because can't get a handle to RtcProxy")},ka:function(){wac_6Bb&&(wac_6Bb.dispose(),wac_6Bb=null)}};wac_QGb.registerClass("RealtimePresenceUI.WordEditorPeoplesWell",wac_RDb);wac_UGb.registerClass("WordEditor.PeoplesWellControl.WordEditorPeoplesWellControlPackage",null,wac_I,wac_j);(function(){}).registerClass("WordEditor.PeoplesWellControl.Program");
var wac_RGb=null,wac_6Bb=null,wac_3T=null,wac_WGb=null,wac_VGb=null;wac_J(wac_C(),new wac_UGb,0,!1);
